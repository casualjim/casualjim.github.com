
<!DOCTYPE html>
<!--[if lt IE 7 ]><html class="ie ie6" lang="en"> <![endif]-->
<!--[if IE 7 ]><html class="ie ie7" lang="en"> <![endif]-->
<!--[if IE 8 ]><html class="ie ie8" lang="en"> <![endif]-->
<!--[if (gte IE 9)|!(IE)]><!--><html lang="en"> <!--<![endif]-->
<head>

  <meta charset="utf-8">
  <title>Ivan Porto Carrero</title>
  <meta name="author" content="Ivan Porto Carrero">

  
  <meta name="description" content="Backchat.IO is hiring! BackChat.io is easiest to describe as grep for real-time data. We’re busy developing a platform that makes sense of the data &hellip;">
  

  <!--[if lt IE 9]>
    <script src="http://html5shim.googlecode.com/svn/trunk/html5.js"></script>
  <![endif]-->

  <!-- http://t.co/dKP3o1e -->
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
  
  <link rel="canonical" href="http://flanders.co.nz">
  <link href="/favicon.png" rel="icon">
  <link href="/css/base.css" rel="stylesheet" type="text/css">
  <link href="/css/skeleton.css" rel="stylesheet" type="text/css">
  <link href="/css/syntax.css" rel="stylesheet" type="text/css">
  <link href="/css/style.css" rel="stylesheet" type="text/css">
  <link href="/css/skins/blue.css" rel="stylesheet" type="text/css">

  <link rel="shortcut icon" href="/images/favicon.ico">
  <link rel="apple-touch-icon" href="/images/apple-touch-icon.png">
  <link rel="apple-touch-icon" sizes="72x72" href="/images/apple-touch-icon-72x72.png">
  <link rel="apple-touch-icon" sizes="114x114" href="/images/apple-touch-icon-114x114.png">

  <script src="/js/jquery-1.7.1.min.js" type="text/javascript"></script>  
  <script src="/js/modernizr.js" type="text/javascript"></script>
  <script src="/js/jquery.easing.1.3.js" type="text/javascript"></script>
  <script type="text/javascript" src="/js/jquery.illuminate.0.7.min.js"></script>
  <!-- tweet
  <script type="text/javascript" src="/js/tweet/twitter.js"></script>
  <script type="text/javascript" src="/js/tweet/setting.js"></script> -->
  
  <script type="text/javascript" src="/js/custom.js"></script>
  <link href="/atom.xml" rel="alternate" title="Ivan Porto Carrero" type="application/atom+xml">
  <!--Fonts from Google"s Web font directory at http://google.com/webfonts -->
<link href="http://fonts.googleapis.com/css?family=PT+Serif:regular,italic,bold,bolditalic" rel="stylesheet" type="text/css">
<link href="http://fonts.googleapis.com/css?family=PT+Sans:regular,italic,bold,bolditalic" rel="stylesheet" type="text/css">

  
  <script type="text/javascript">
    var _gaq = _gaq || [];
    _gaq.push(['_setAccount', 'UA-240612-3']);
    _gaq.push(['_trackPageview']);

    (function() {
      var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
      ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
      var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
    })();
  </script>


</head>

<body >
  <div id="wrapper">
    <header role="banner"> <div class="container">
    <div class="row clearfix">
      <hdgroup>
        <div class="four columns">
          <div class="logo">
            <img src="/images/logo.png" alt="" />
            <h2>Rants &amp; ramblings</h2>
          </div>  
        </div>
      </hdgroup>
      <nav role="navigation"><!-- <ul class="subscription" data-subscription="rss">
  <li><a href="/atom.xml" rel="subscribe-rss" title="subscribe via RSS">RSS</a></li>
  
</ul>
  
<form action="http://google.com/search" method="get">
  <fieldset role="search">
    <input type="hidden" name="q" value="site:flanders.co.nz" />
    <input class="search" type="text" name="q" results="0" placeholder="Search"/>
  </fieldset>
</form>
   -->
<ul>
  <li>
    <a href="/">Home
      <span>Homepage</span>
    </a>    
  </li>
  <li>
    <a href="/archives">Archives
      <span>Articles</span>
    </a>    
  </li>
  <li>
    <a href="/projects">Projects
      <span>Open-Source</span>
    </a>    
  </li>
  <li>
    <a href="/about">About me
      <span>Introduction</span>
    </a>    
  </li>
</ul>
</nav>

    </div>
  </div>  
<!-- <hgroup>
  <h1><a href="/">Ivan Porto Carrero</a></h1>
  
    <h2>IO(thoughts) foreach (_.propagandize)</h2>
  
</hgroup>
 -->
</header>
    <div class="container bodycontent">
      <div class="row clearfix">
        <div class="sixteen columns headline">
          <h2>Ivan Porto Carrero</h2>
          <p class="italic">IO(thoughts) foreach (_.propagandize)</p>
        </div>
      </div>  

      <div class="sixteen columns">
        <div class="divider row"></div>
      </div>  
      
      <!-- start of row -->
      <div class="row clearfix">
        <div class="sixteen columns">
          <!-- twitter feed -->
          <div class="twitter_feed">
            <ul class="tweet_list"></ul>
          </div>
        </div>
      </div>  
      <div class="sixteen columns">
        <div class="divider row"></div>
      </div>  
      
      <div id="maincontent" class="clearfix">
        <div class="five columns">  
  <aside class="left-sidebar">
    
        
<div class="widget row">
  <h5>Search form</h5>  
  <div id="search-form">
    <form action="http://google.com/search" method="get">
      <fieldset role="search">
        <input type="hidden" name="q" value="site:flanders.co.nz" />
        <input id="search-box" type="text" name="q" results="0" placeholder="Search"/>
        <input type="submit" value="Search" id="search-button" />
        <div class="clear"></div>
      </fieldset>
    </form>
  </div>
</div>
   <section>
  <div class="widget row">
    <h5>Recent Posts</h5>  
    <ul id="recent_posts">
      
        <li class="post">
          <a href="/2011/08/01/backchat-developers/">work for backchat</a>
        </li>
      
        <li class="post">
          <a href="/2010/09/30/radical-language-and-platform-shift/">Radical language and platform shift</a>
        </li>
      
        <li class="post">
          <a href="/2010/03/12/video-of-fosdem-ironruby-presentation/">Video of FOSDEM IronRuby presentation</a>
        </li>
      
        <li class="post">
          <a href="/2009/12/01/adding-a-console-to-your-ironruby-application/">Adding a console to your IronRuby application</a>
        </li>
      
        <li class="post">
          <a href="/2009/11/08/a-good-url-regular-expression-repost/">A good url regular expression? (repost)</a>
        </li>
      
    </ul>
  </div>
</section>

<section>
  <div class="widget row">
    <h5>GitHub Repos</h5>
    <ul id="gh_repos">
      <li class="loading">Status updating&#8230;</li>
    </ul>
    
    <a href="https://github.com/casualjim">@casualjim</a> on GitHub
    
  </div>
  <script type="text/javascript">
    $(document).ready(function(){
        if (!window.jXHR){
            var jxhr = document.createElement('script');
            jxhr.type = 'text/javascript';
            jxhr.src = 'javascripts/libs/jXHR.js';
            var s = document.getElementsByTagName('script')[0];
            s.parentNode.insertBefore(jxhr, s);
        }

        github.showRepos({
            user: 'casualjim',
            count: 0,
            skip_forks: true,
            target: '#gh_repos'
        });
    });
  </script>
  <script src="/javascripts/github.js" type="text/javascript"></script>
</section>


<section>
  <div class="widget row">
    <h5>Latest Tweets</h5>
    <ul id="tweets">
      <li class="loading">Status updating&#8230;</li>
    </ul>
    <script type="text/javascript">
      $(document).ready(function(){
        // getTwitterFeed("casualjim", 4, false);
      });
    </script>
    
      <a href="http://twitter.com/casualjim" class="twitter-follow-button" data-show-count="false">Follow @casualjim</a>
    
  </div>
</section>


<section>
  <div class="widget row">
    <h5>On Delicious</h5>
    <div id="delicious"></div>
    <script type="text/javascript" src="http://feeds.delicious.com/v2/json/casualjim?count=3&amp;sort=date&amp;callback=renderDeliciousLinks"></script>
    <p><a href="http://delicious.com/casualjim">My Delicious Bookmarks &raquo;</a></p>
  </div>
</section>


<section class="googleplus">
  <div class="widget row">
    <h5>
      <a href="https://plus.google.com/106536131996809745163?rel=author">
        <img src="http://www.google.com/images/icons/ui/gprofile_button-32.png" width="32" height="32">
        Google+
      </a>
    </h5>
  </div>
</section>



    
  </aside>
</div>
<div class="eleven columns">
<div class="blog-index">
  
  
  
    <article class="blogpost row">
      
  <div class="post-heading"> 
    



    <p class="date">01</p>  
    <div class="month-year"><p><span>Aug</span><br />2011</p></div>



    
      <div class="post-title">
        <h5>
          <a href="/2011/08/01/backchat-developers/" title="">Work for Backchat</a>
        </h5>
      </div> 
    
    <div class="clear"></div>
  </div>
  <!-- end of post heading -->
  
  <!-- start of post meta -->
  <div class="post-meta">
    <p>
       
  

<span class="byline author vcard">Posted by <span class="fn">Ivan Porto Carrero</span></span>

       
     </p>  
  </div>
  <!-- end of post meta -->
  


  <div class="entry-content"><h1>Backchat.IO is hiring!</h1>

<p>BackChat.io is easiest to describe as <em>grep for real-time data</em>. We’re busy developing a platform that makes sense of the data you send it (in real-time).</p>

<p>For the social web that means that you can start following certain users on a network or define a search term and you get those in a unified activity streams format.</p>

<p>But for something more arcane, like say, log data, that means you can send it lines of text and have it extract out fields on which you can define filters. All of this happens in real-time and changes are reflected virtually immediately in open connections.</p>

</div>
  
  
    <a rel="full-article" class="readmore" href="/2011/08/01/backchat-developers/">Read on &rarr;</a>
  


    </article>
    <!-- divider for blog post -->
    <div class="divider"></div>
  
  
    <article class="blogpost row">
      
  <div class="post-heading"> 
    



    <p class="date">30</p>  
    <div class="month-year"><p><span>Sep</span><br />2010</p></div>



    
      <div class="post-title">
        <h5>
          <a href="/2010/09/30/radical-language-and-platform-shift/" title="">Radical Language and Platform Shift</a>
        </h5>
      </div> 
    
    <div class="clear"></div>
  </div>
  <!-- end of post heading -->
  
  <!-- start of post meta -->
  <div class="post-meta">
    <p>
       
  

<span class="byline author vcard">Posted by <span class="fn">Ivan Porto Carrero</span></span>

       
     </p>  
  </div>
  <!-- end of post meta -->
  


  <div class="entry-content"><p>I realize it&#8217;s been a really long time since I put something on this blog. And for those of you expecting more (iron)ruby posts I&#8217;m going to have to dissapoint you. This is mostly a braindump of what I&#8217;ve been working out the last months.</p>

<p>A few months ago Adam Burmister, who I met at  <a href="http://www.xero.com">Xero</a>, and I got incubated by <a href="http://o2.co.uk">O2</a> to do a project that allowed me to push the boundaries and it required me to look outside what I already knew.  I had to go look for a new way of approaching problems, it isn&#8217;t said that the problems couldn&#8217;t be solved with a language like C# or Ruby. The solution would have been pretty much sub-par. In this quest for the best way to approach that problem it turned out that <a href="http://scala-lang.org">Scala</a> was the language that hit a sweet spot for me.</p>

<p>We needed something that resembled Erlang; and while I did my best to really get into <a href="http://www.erlang.org/">Erlang</a> I never could (this could possibly be because of the eye bleeds because the language is just so friggin&#8217; ugly). So it turns out there is a design pattern called <a href="http://en.wikipedia.org/wiki/Active_object">ActiveObject</a> which is at the core the same as an erlang node (it&#8217;s not I know a node has many other properties).   We also needed to be able to process humongous volumes of data (Terrabytes worth) at this point Ruby is out of the picture. I&#8217;m sure I will upset many fanboys but face it ruby is slooooooooooooooow and advances slow, by the time you can properly program distributed systems in ruby the way I had in mind I&#8217;ll be a great grand dad and have a long and pointy grey beard. .Net is lacking libraries and the ruby libraries often are good enough, but <a href="http://www.startuplessonslearned.com/2010/09/good-enough-never-is-or-is-it.html">good enough never is</a>. And since I got tired of patching every single bloody library I touched I vowed to steer clear of ruby. We still use ruby but we use it for what it&#8217;s great at: system automation scripts and sometimes quick prototyping.</p>

<p>We basically needed hadoop, hadoop is a java project (I&#8217;ll return to why not java and C# a little bit later). So once I entered the Java domain a new world opened up for me (old for most other people I realise that). Java has what can only be described as a SHITLOAD of great quality libraries. It&#8217;s just a pithy that Java like C# suffers from what I call programmer masturbation. I&#8217;ve certainly been guilty of that and during my time at Xero they suffered the grunt of it (sorry guys). So lets return to those problems.</p>

<p>You read a book, nicknamed Gang of Four which then becomes &#8220;the bible&#8221;, it has this thing called design patterns and they need to be applied where ever you can.  I&#8217;ll let you in on a little secret: They do next to nothing to make your code more maintainable (quite the opposite in fact) and definitely don&#8217;t make it more understandable unless the next guy also knows &#8220;the bible&#8221;. If he doesn&#8217;t he&#8217;s a fucking retard, everybody knows those design patterns.  The thing that doesn&#8217;t jive is: how is writing more code making your code more maintainable as you have to maintain more code (did I mention more code in this sentence?)The one thing ubiquitous use of design patterns from &#8220;the bible&#8221; does do is give you some job security. Pythonista&#8217;s <a href="http://us.pycon.org/2009/conference/schedule/event/51/">shun design patterns</a> and if not you should apparently.  Having programmed in many languages I tend to agree with the conclusion that having to use crutches like design patterns (I should really make this into a factory or manager of some sort) actually means your language is flawed.</p>

<p>I still need to meet the person that can actually prove to me that your code is more maintainable than code that follows the following simple rules:
* Don&#8217;t Repeat Yourself
* Don&#8217;t write what you don&#8217;t need right now
* write a couple of tests
*  Generalize as if there was no tomorrow.
* Write as little and as simple code as humanly possible (this kills double dispatch and the visitor pattern)
* Remember that you (as do I) have a bird brain, you will have forgotten what you did 2 weeks ago, let alone 6 months from now, so it needs to be understandable by the biggest idiot on the planet, namely the author of the code (in my case me).</p>

<p>I don&#8217;t want to write a post on why I left .NET but it&#8217;s inevitable to mention it. I used to think .NET was the greatest thing since sliced bread and I still think it&#8217;s a really cool piece of technology. However there is only a small minority of .NET programmers I actually get along with so some of the remarks I&#8217;m going to make are not directed at those people. I have felt unhappy about the way .NET was evolving around the same time microsoft introduced the class designer tool. Don&#8217;t even get me started on people advocating UML because that belongs in the same classification, a vertical one. Once Oslo got introduced or is it M I wanted to get out as quickly as possible. I happen to like writing code, if I wanted to drag and drop boxes and connect them with fancy lines I would have gone for a designer career.</p>

<p>.NET also suffers from another problem, whatever the all-knowing company produces is innovation created by them (never mind if some of those things have been around for more than 20 years). And most developers on .NET suffer from that phenomenon that can only be called Stockholm Syndrome. It is mind boggling to me that you want to use tools you know suck, they don&#8217;t make you do a better job faster in fact once you move past the hello world example they fall apart really quickly, not to mention having to debug a problem and submitting a bug (which will then be bounced back as by design).</p>

<p>Enough slamming on .NET let&#8217;s return to Java. Stephen Colebourne goes the next <a href="http://www.jroller.com/scolebourne/entry/the_next_big_jvm_language1">big JVM language is Java</a>, but this time done right??? One of his arguments is 10.000.000 programmers world wide can&#8217;t be wrong. I happen to think that 9,9 million of those programmers mostly likes to get paid, it has little or nothing to do with the fact that it&#8217;s a great or not great language.  It&#8217;s certainly easier than C and definitely C++, ask <a href="http://artlung.com/smorgasborg/Invention_of_Cplusplus.shtml">Bjarne</a>. Most of the java code I read makes me sick to my stomach the boilerplate needed   (the next example is in C# the java one would most def be longer:  <a href="http://code.google.com/p/fizzbuzz/source/browse/#svn/trunk/trunk">fizzbuzz enterprise edition</a>) is atrocious. Java date arithmetic (I know about joda-time) is an absolute nightmare. The fact that you need to write at least 6 (not counting import statements and the main definition) lines of code to be able to read input from the keyboard and  print it out just amplify my point.</p>

<p>So no ruby, no .NET no java what&#8217;s next. There is this cool thing people keep talking about: node.js it&#8217;s crazy fast (if you compare it with languages like ruby and run the correct hello world benchmarks). however the libraries are subpar at best and generally feel like they&#8217;ve been written by very young programmers (with the odd exception of course) who have little or no clue about what&#8217;s going on outside of their blog or what their &#8220;gods&#8221; are saying. I&#8217;m sure it has a place and I&#8217;ve given it more than an honest chance but at the end of the day it would have required a big investment to write all kinds of things that just aren&#8217;t there (yet).</p>

<p>But you know it&#8217;s event driven and asynchronous and that&#8217;s why it&#8217;s fast and only non-blocking IO is the right way to go because using blocking IO is slow. Ok now you got me, you&#8217;re right but also wrong. It depends on your use case and how you work with blocking IO. We&#8217;ve come to go by this simple rule: if you need many short-lived connections (like in say HTTP) then non blocking io is indeed better, however long lasting connections may benefit from blocking IO, because the throughput is a lot higher (although it&#8217;s not quite as black and white as that).</p>

<p>So back to we want erlang but without the bleeding eyes: enter scala + <a href="http://www.akkasource.org">akka</a>. Boy was I happy camper when I started reading their docs. An open-source project, written in this language called scala that solves the same problems as Erlang only this language is beautiful, yes I&#8217;ll repeat that beauuuutifuuuulll. Scala gives me what ruby was never able to give me, a fast, pretty language that supports multiple paradigms with a strong nudge towards functional programming. it can be run on .NET as well as on the JVM meaning we didn&#8217;t have to forego the much needed libraries. And the libraries that are available are in a totally different league than those dinky toys node.js and ruby have to offer. It&#8217;s like comparing the majors to the minors I guess.</p>

<p>The downside is that we do need core i7 machines to get any decent compile times out of the thing and IDE support (while it gets better steadily) is still behind on other languages. If you&#8217;re wondering about LOC count vs ruby I think they&#8217;re about even once you know what you&#8217;re doing. Scala is not an easy language but it&#8217;s heaps of fun to work with and I&#8217;m glad I get to use it the next couple of years.  if you&#8217;re looking for an acceptable alternative on .NET that is supported by the all-knowing hugely innovative company you should look at F#.</p>

<p>As an aside the next time somebody mentions enterprise ready as baked in to me; they will get a rope, chair and nail it&#8217;s quicker and less painful.</p>

<p>There the rant is over, I feel a lot better now. I already know I&#8217;m an idiot so tell me something new.</p>
</div>
  
  


    </article>
    <!-- divider for blog post -->
    <div class="divider"></div>
  
  
    <article class="blogpost row">
      
  <div class="post-heading"> 
    



    <p class="date">12</p>  
    <div class="month-year"><p><span>Mar</span><br />2010</p></div>



    
      <div class="post-title">
        <h5>
          <a href="/2010/03/12/video-of-fosdem-ironruby-presentation/" title="">Video of FOSDEM IronRuby Presentation</a>
        </h5>
      </div> 
    
    <div class="clear"></div>
  </div>
  <!-- end of post heading -->
  
  <!-- start of post meta -->
  <div class="post-meta">
    <p>
       
  

<span class="byline author vcard">Posted by <span class="fn">Ivan Porto Carrero</span></span>

       
     </p>  
  </div>
  <!-- end of post meta -->
  


  <div class="entry-content"><p>At FOSDEM 2010 I got the chance to talk in the mono dev room about ironruby.</p>

<p>In this talk I extended the banshee application to work with IronRuby based plugins.</p>

<p>So without further ado here&#8217;s the link:
<a href="http://andrius.six.lt/~bentkus/videos/mono-fosdem2010/mono-2010-02-07-1000-1100-(Ivan%20Porto%20Carrero">IronRuby: The .NET and Ruby love child</a>-(The%20Ruby%20and%20the%20.NET%20lovechild).mp4)</p>
</div>
  
  


    </article>
    <!-- divider for blog post -->
    <div class="divider"></div>
  
  
    <article class="blogpost row">
      
  <div class="post-heading"> 
    



    <p class="date">01</p>  
    <div class="month-year"><p><span>Dec</span><br />2009</p></div>



    
      <div class="post-title">
        <h5>
          <a href="/2009/12/01/adding-a-console-to-your-ironruby-application/" title="">Adding a Console to Your IronRuby Application</a>
        </h5>
      </div> 
    
    <div class="clear"></div>
  </div>
  <!-- end of post heading -->
  
  <!-- start of post meta -->
  <div class="post-meta">
    <p>
       
  

<span class="byline author vcard">Posted by <span class="fn">Ivan Porto Carrero</span></span>

       
     </p>  
  </div>
  <!-- end of post meta -->
  


  <div class="entry-content"><p>When building an application it might be very handy to have a REPL console that knows about the libraries of your application, but you don’t necessarily want to start your application to interact with it. In Rails they have a script/console command. Here’s how you create one that knows about ironruby. The example I’m going to use is taken from an IronRubyMVC application.</p>

<p>I started out by creating a folder script.</p>

<p>Then I created a file called console (on a unix system I would chmod +x this file). I also like to have completion in my console so I’ve added the irb/completion library. Then I’ll require the routes.rb file so that the libraries of my application get loaded.</p>

<figure class='code'><figcaption><span>console script</span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
</pre></td><td class='code'><pre><code class='sh'><span class='line'><span class="c">#!/usr/bin/env ir</span>
</span><span class='line'><span class="c"># File: script/console</span>
</span><span class='line'><span class="nv">irb</span> <span class="o">=</span> ENV<span class="o">[</span><span class="s1">&#39;OS&#39;</span><span class="o">]</span> <span class="o">=</span>~ /^Windows/iu ? <span class="s1">&#39;CALL iirb.bat&#39;</span> : <span class="s1">&#39;iirb&#39;</span>
</span><span class='line'>
</span><span class='line'><span class="nv">libs</span> <span class="o">=</span>  <span class="s2">&quot; -r irb/completion&quot;</span>
</span><span class='line'><span class="c"># Perhaps use a console_lib to store any extra methods I may want available in the console</span>
</span><span class='line'>libs &lt;&lt;  <span class="s2">&quot; -r #{File.dirname(__FILE__) + &#39;/../routes&#39;}&quot;</span>
</span><span class='line'>puts <span class="s2">&quot;Loading Poll chat&quot;</span>
</span><span class='line'><span class="nb">exec</span> <span class="s2">&quot;#{irb} #{libs} --simple-prompt&quot;</span>
</span></code></pre></td></tr></table></div></figure>


<p>The 3rd line has CALL iirb.bat as a command on a windows system. The CALL command is needed for the next step because we’re going to execute a batch file from another batch file on windows. Otherwise it wouldn’t work for me. CALL is very similar to exec in ruby and gives control to another executable until its task is done.</p>

<p>For windows to be able to use script/console (script\console) instead of ir script/console you also need to create a batch file called console.bat in the script folder.</p>

<figure class='code'><figcaption><span>console script</span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
</pre></td><td class='code'><pre><code class='bat'><span class='line'><span class="p">@</span><span class="k">ECHO</span> <span class="k">OFF</span>
</span><span class='line'><span class="k">IF</span> NOT <span class="s2">&quot;%~f0&quot;</span> <span class="o">==</span> <span class="s2">&quot;~f0&quot;</span> <span class="k">GOTO</span> <span class="nl">:WinNT</span>
</span><span class='line'><span class="p">@</span><span class="s2">&quot;ir.exe&quot;</span> <span class="s2">&quot;script/console&quot;</span> <span class="nv">%1</span> <span class="nv">%2</span> <span class="nv">%3</span> <span class="nv">%4</span> <span class="nv">%5</span> <span class="nv">%6</span> <span class="nv">%7</span> <span class="nv">%8</span> <span class="nv">%9</span>
</span><span class='line'><span class="k">GOTO</span> <span class="nl">:EOF</span>
</span><span class='line'><span class="nl">:WinNT</span>
</span><span class='line'><span class="p">@</span><span class="s2">&quot;ir.exe&quot;</span> <span class="s2">&quot;%~dpn0&quot;</span> %*
</span></code></pre></td></tr></table></div></figure>


<p>This is all there is to it to get rails like scripting abilities.</p>

<p>IronRuby has another really cool feature built into IronRuby is the ability to provide REPL’s for your application at run-time. All you need to do is use Repl.new and give it an output and input stream.</p>
</div>
  
  


    </article>
    <!-- divider for blog post -->
    <div class="divider"></div>
  
  
    <article class="blogpost row">
      
  <div class="post-heading"> 
    



    <p class="date">08</p>  
    <div class="month-year"><p><span>Nov</span><br />2009</p></div>



    
      <div class="post-title">
        <h5>
          <a href="/2009/11/08/a-good-url-regular-expression-repost/" title="">A Good Url Regular Expression? (Repost)</a>
        </h5>
      </div> 
    
    <div class="clear"></div>
  </div>
  <!-- end of post heading -->
  
  <!-- start of post meta -->
  <div class="post-meta">
    <p>
       
  

<span class="byline author vcard">Posted by <span class="fn">Ivan Porto Carrero</span></span>

       
     </p>  
  </div>
  <!-- end of post meta -->
  


  <div class="entry-content"><p>I&#8217;m moving this post from <a href="http://geekswithblogs.net/casualjim/archive/2005/12/01/61722.aspx">http://geekswithblogs.net/casualjim/archive/2005/12/01/61722.aspx</a></p>

<p>I started out blogging on geeks with blogs but I can&#8217;t allow comments there anymore or I get too much spam, so I&#8217;m moving the post from there to this place.  Various people have contributed through the comments in the other blog post. So here I have better control over the spam and can open the comments again.</p>

<p>I have been looking for a good first layer of validating an url to see if it is valid.</p>

<p>For checking the format of the url it seems to me to be the most logical approach to use regular expressions. Up until now I always discarded them as being to “geeky”, meaning i don&#8217;t consider it my life&#8217;s biggest goal to be typing (/?[]\w) all day long (so why did i become a programmer, aaaah yes to make life easier for other people)</p>

<p>Anyway.. to find a good regular expression to that validates urls not url domains. One that doesn&#8217;t allow spaces in the domainname and where the domain can be suffixed with the port number.  Also I need support for the ~/ paths</p>

<p>This is what I came up with.. if somebody as a better idea&#8230; or finds a mistake please let me know.. Always happy to learn something new.</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class='csharp'><span class='line'><span class="p">^(((</span><span class="n">ht</span><span class="p">|</span><span class="n">f</span><span class="p">)</span><span class="n">tps</span><span class="p">?</span><span class="err">\</span><span class="p">:</span><span class="err">\</span><span class="p">/</span><span class="err">\</span><span class="p">/)|~/|/)?([</span><span class="n">a</span><span class="p">-</span><span class="n">zA</span><span class="p">-</span><span class="n">Z</span><span class="p">]{</span><span class="m">1</span><span class="p">}([</span><span class="err">\</span><span class="n">w</span><span class="err">\</span><span class="p">-]+</span><span class="err">\</span><span class="p">.)+([</span><span class="err">\</span><span class="n">w</span><span class="p">]{</span><span class="m">2</span><span class="p">,</span><span class="m">5</span><span class="p">})(:[</span><span class="err">\</span><span class="n">d</span><span class="p">]{</span><span class="m">1</span><span class="p">,</span><span class="m">5</span><span class="p">})?)/?(</span><span class="err">\</span><span class="n">w</span><span class="p">+</span><span class="err">\</span><span class="p">.[</span><span class="err">\</span><span class="n">w</span><span class="p">]{</span><span class="m">3</span><span class="p">,</span><span class="m">4</span><span class="p">})?((</span><span class="err">\</span><span class="p">?</span><span class="err">\</span><span class="n">w</span><span class="p">+=</span><span class="err">\</span><span class="n">w</span><span class="p">+)?(&amp;</span><span class="err">\</span><span class="n">w</span><span class="p">+=</span><span class="err">\</span><span class="n">w</span><span class="p">+)*)?</span>
</span></code></pre></td></tr></table></div></figure>


<p>I was a bit quickly in using this regex. Simeon pilgrim indicated that the ftp urls won&#8217;t validate when you add a username and a password.</p>

<p>I don&#8217;t really need to validate ftp so I should have removed the ftp protocol from the list of choices.  I need this just to validate urls for weblinks and the link element in an rss feed.  When I need them for ftp I will post the ftp version.. but for now I don&#8217;t have time to spend on elaborating the regex.</p>

<p>Anyway here is the right one :</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class='csharp'><span class='line'><span class="p">^(</span><span class="n">http</span><span class="p">(</span><span class="n">s</span><span class="p">?)</span><span class="err">\</span><span class="p">:</span><span class="err">\</span><span class="p">/</span><span class="err">\</span><span class="p">/|~/|/)?([</span><span class="n">a</span><span class="p">-</span><span class="n">zA</span><span class="p">-</span><span class="n">Z</span><span class="p">]{</span><span class="m">1</span><span class="p">}([</span><span class="err">\</span><span class="n">w</span><span class="err">\</span><span class="p">-]+</span><span class="err">\</span><span class="p">.)+([</span><span class="err">\</span><span class="n">w</span><span class="p">]{</span><span class="m">2</span><span class="p">,</span><span class="m">5</span><span class="p">}))(:[</span><span class="err">\</span><span class="n">d</span><span class="p">]{</span><span class="m">1</span><span class="p">,</span><span class="m">5</span><span class="p">})?/?(</span><span class="err">\</span><span class="n">w</span><span class="p">+</span><span class="err">\</span><span class="p">.[</span><span class="err">\</span><span class="n">w</span><span class="p">]{</span><span class="m">3</span><span class="p">,</span><span class="m">4</span><span class="p">})?((</span><span class="err">\</span><span class="p">?</span><span class="err">\</span><span class="n">w</span><span class="p">+=</span><span class="err">\</span><span class="n">w</span><span class="p">+)?(&amp;</span><span class="err">\</span><span class="n">w</span><span class="p">+=</span><span class="err">\</span><span class="n">w</span><span class="p">+)*)?</span>
</span></code></pre></td></tr></table></div></figure>


<p>A full url validation would include resolving names through dns or making a webrequest to the provided url to see if we get a 200 response. The only way to be sure is to test if it is there in my opinion.</p>

<p>Thanks Simeon.</p>

<p>And for those who really want the ftp validation :</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class='csharp'><span class='line'><span class="p">^((</span><span class="n">ht</span><span class="p">|</span><span class="n">f</span><span class="p">)</span><span class="n">tp</span><span class="p">(</span><span class="n">s</span><span class="p">?)</span><span class="err">\</span><span class="p">:</span><span class="err">\</span><span class="p">/</span><span class="err">\</span><span class="p">/|~/|/)?([</span><span class="err">\</span><span class="n">w</span><span class="p">]+:</span><span class="err">\</span><span class="n">w</span><span class="p">+</span><span class="err">@</span><span class="p">)?([</span><span class="n">a</span><span class="p">-</span><span class="n">zA</span><span class="p">-</span><span class="n">Z</span><span class="p">]{</span><span class="m">1</span><span class="p">}([</span><span class="err">\</span><span class="n">w</span><span class="err">\</span><span class="p">-]+</span><span class="err">\</span><span class="p">.)+([</span><span class="err">\</span><span class="n">w</span><span class="p">]{</span><span class="m">2</span><span class="p">,</span><span class="m">5</span><span class="p">}))(:[</span><span class="err">\</span><span class="n">d</span><span class="p">]{</span><span class="m">1</span><span class="p">,</span><span class="m">5</span><span class="p">})?/?(</span><span class="err">\</span><span class="n">w</span><span class="p">+</span><span class="err">\</span><span class="p">.[</span><span class="err">\</span><span class="n">w</span><span class="p">]{</span><span class="m">3</span><span class="p">,</span><span class="m">4</span><span class="p">})?((</span><span class="err">\</span><span class="p">?</span><span class="err">\</span><span class="n">w</span><span class="p">+=</span><span class="err">\</span><span class="n">w</span><span class="p">+)?(&amp;</span><span class="err">\</span><span class="n">w</span><span class="p">+=</span><span class="err">\</span><span class="n">w</span><span class="p">+)*)?</span>
</span></code></pre></td></tr></table></div></figure>


<p>I am not sure about numbers in the username but I believe you can have a username of numbers alone.</p>

<p>Comments don&#8217;t seem to work on this blog engine.. so just send me a mail through the contact form. thanks</p>

<p>Two days later &#8230;</p>

<p>I discovered there is still a problem with my regular expressions&#8230; folders don&#8217;t get parsed.</p>

<p>I&#8217;ve solved the path issue, so now it should be finding all url&#8217;s</p>

<p>Expression:</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class='csharp'><span class='line'><span class="p">^((</span><span class="n">ht</span><span class="p">|</span><span class="n">f</span><span class="p">)</span><span class="n">tp</span><span class="p">(</span><span class="n">s</span><span class="p">?)</span><span class="err">\</span><span class="p">:</span><span class="err">\</span><span class="p">/</span><span class="err">\</span><span class="p">/|~/|/)?([</span><span class="err">\</span><span class="n">w</span><span class="p">]+:</span><span class="err">\</span><span class="n">w</span><span class="p">+</span><span class="err">@</span><span class="p">)?([</span><span class="n">a</span><span class="p">-</span><span class="n">zA</span><span class="p">-</span><span class="n">Z</span><span class="p">]{</span><span class="m">1</span><span class="p">}([</span><span class="err">\</span><span class="n">w</span><span class="err">\</span><span class="p">-]+</span><span class="err">\</span><span class="p">.)+([</span><span class="err">\</span><span class="n">w</span><span class="p">]{</span><span class="m">2</span><span class="p">,</span><span class="m">5</span><span class="p">}))(:[</span><span class="err">\</span><span class="n">d</span><span class="p">]{</span><span class="m">1</span><span class="p">,</span><span class="m">5</span><span class="p">})?((/?</span><span class="err">\</span><span class="n">w</span><span class="p">+/)+|/?)(</span><span class="err">\</span><span class="n">w</span><span class="p">+</span><span class="err">\</span><span class="p">.[</span><span class="err">\</span><span class="n">w</span><span class="p">]{</span><span class="m">3</span><span class="p">,</span><span class="m">4</span><span class="p">})?((</span><span class="err">\</span><span class="p">?</span><span class="err">\</span><span class="n">w</span><span class="p">+=</span><span class="err">\</span><span class="n">w</span><span class="p">+)?(&amp;</span><span class="err">\</span><span class="n">w</span><span class="p">+=</span><span class="err">\</span><span class="n">w</span><span class="p">+)*)?</span>
</span></code></pre></td></tr></table></div></figure>


<p>Should parse the url below</p>

<p><a href="http://hh-1hallo.msn.blabla.com:80800/test/test/test.aspx?dd=dd&amp;id=dki">http://hh-1hallo.msn.blabla.com:80800/test/test/test.aspx?dd=dd&amp;id=dki</a></p>

<p>But not :</p>

<p><a href="http://hh-1hallo">http://hh-1hallo</a>. msn.blablabla.com:80800/test/test.aspx?dd=dd&amp;id=dki</p>

<p>Update 29/11/2008:</p>

<p>Joe posted what seems to be a great regular expression in the comments</p>

<p>he tested it with the following urls:</p>

<p>http://www.google.com/search?q=good+url+regex&amp;rls=com.microsoft:*&amp;ie=UTF-8&amp;oe=UTF-8&amp;startIndex=&amp;startPage=1</p>

<p>ftp://joe:password@ftp.filetransferprotocal.com</p>

<p>google.ru</p>

<p>https://some-url.com?query=&amp;name=joe?filter=<em>.</em>#some_anchor</p>

<p>Expression:</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class='csharp'><span class='line'><span class="p">^(?</span><span class="err">#</span><span class="n">Protocol</span><span class="p">)(?:(?:</span><span class="n">ht</span><span class="p">|</span><span class="n">f</span><span class="p">)</span><span class="n">tp</span><span class="p">(?:</span><span class="n">s</span><span class="p">?)</span><span class="err">\</span><span class="p">:</span><span class="err">\</span><span class="p">/</span><span class="err">\</span><span class="p">/|~/|/)?(?</span><span class="err">#</span><span class="n">Username</span><span class="p">:</span><span class="n">Password</span><span class="p">)(?:</span><span class="err">\</span><span class="n">w</span><span class="p">+:</span><span class="err">\</span><span class="n">w</span><span class="p">+</span><span class="err">@</span><span class="p">)?(?</span><span class="err">#</span><span class="n">Subdomains</span><span class="p">)(?:(?:[-</span><span class="err">\</span><span class="n">w</span><span class="p">]+</span><span class="err">\</span><span class="p">.)+(?</span><span class="err">#</span><span class="n">TopLevel</span> <span class="n">Domains</span><span class="p">)(?:</span><span class="n">com</span><span class="p">|</span><span class="n">org</span><span class="p">|</span><span class="n">net</span><span class="p">|</span><span class="n">gov</span><span class="p">|</span><span class="n">mil</span><span class="p">|</span><span class="n">biz</span><span class="p">|</span><span class="n">info</span><span class="p">|</span><span class="n">mobi</span><span class="p">|</span><span class="n">name</span><span class="p">|</span><span class="n">aero</span><span class="p">|</span><span class="n">jobs</span><span class="p">|</span><span class="n">museum</span><span class="p">|</span><span class="n">travel</span><span class="p">|[</span><span class="n">a</span><span class="p">-</span><span class="n">z</span><span class="p">]{</span><span class="m">2</span><span class="p">}))(?</span><span class="err">#</span><span class="n">Port</span><span class="p">)(?::[</span><span class="err">\</span><span class="n">d</span><span class="p">]{</span><span class="m">1</span><span class="p">,</span><span class="m">5</span><span class="p">})?(?</span><span class="err">#</span><span class="n">Directories</span><span class="p">)(?:(?:(?:/(?:[-</span><span class="err">\</span><span class="n">w</span><span class="p">~!</span><span class="err">$</span><span class="p">+|.,=]|%[</span><span class="n">a</span><span class="p">-</span><span class="n">f</span><span class="err">\</span><span class="n">d</span><span class="p">]{</span><span class="m">2</span><span class="p">})+)+|/)+|</span><span class="err">\</span><span class="p">?|</span><span class="err">#</span><span class="p">)?(?</span><span class="err">#</span><span class="n">Query</span><span class="p">)(?:(?:</span><span class="err">\</span><span class="p">?(?:[-</span><span class="err">\</span><span class="n">w</span><span class="p">~!</span><span class="err">$</span><span class="p">+|.,*:]|%[</span><span class="n">a</span><span class="p">-</span><span class="n">f</span><span class="err">\</span><span class="n">d</span><span class="p">{</span><span class="m">2</span><span class="p">}])+=(?:[-</span><span class="err">\</span><span class="n">w</span><span class="p">~!</span><span class="err">$</span><span class="p">+|.,*:=]|%[</span><span class="n">a</span><span class="p">-</span><span class="n">f</span><span class="err">\</span><span class="n">d</span><span class="p">]{</span><span class="m">2</span><span class="p">})*)(?:&amp;(?:[-</span><span class="err">\</span><span class="n">w</span><span class="p">~!</span><span class="err">$</span><span class="p">+|.,*:]|%[</span><span class="n">a</span><span class="p">-</span><span class="n">f</span><span class="err">\</span><span class="n">d</span><span class="p">{</span><span class="m">2</span><span class="p">}])+=(?:[-</span><span class="err">\</span><span class="n">w</span><span class="p">~!</span><span class="err">$</span><span class="p">+|.,*:=]|%[</span><span class="n">a</span><span class="p">-</span><span class="n">f</span><span class="err">\</span><span class="n">d</span><span class="p">]{</span><span class="m">2</span><span class="p">})*)*)*(?</span><span class="err">#</span><span class="n">Anchor</span><span class="p">)(?:</span><span class="err">#</span><span class="p">(?:[-</span><span class="err">\</span><span class="n">w</span><span class="p">~!</span><span class="err">$</span><span class="p">+|.,*:=]|%[</span><span class="n">a</span><span class="p">-</span><span class="n">f</span><span class="err">\</span><span class="n">d</span><span class="p">]{</span><span class="m">2</span><span class="p">})*)?</span><span class="err">$</span>
</span></code></pre></td></tr></table></div></figure>


<p>Update 8/11/2009:</p>

<p>Expression:</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class='csharp'><span class='line'><span class="p">^(?</span><span class="err">#</span><span class="n">Protocol</span><span class="p">)(?:(?:</span><span class="n">ht</span><span class="p">|</span><span class="n">f</span><span class="p">)</span><span class="n">tp</span><span class="p">(?:</span><span class="n">s</span><span class="p">?)</span><span class="err">\</span><span class="p">:</span><span class="err">\</span><span class="p">/</span><span class="err">\</span><span class="p">/|~</span><span class="err">\</span><span class="p">/|</span><span class="err">\</span><span class="p">/)?(?</span><span class="err">#</span><span class="n">Username</span><span class="p">:</span><span class="n">Password</span><span class="p">)(?:</span><span class="err">\</span><span class="n">w</span><span class="p">+:</span><span class="err">\</span><span class="n">w</span><span class="p">+</span><span class="err">@</span><span class="p">)?(?</span><span class="err">#</span><span class="n">Subdomains</span><span class="p">)(?:(?:[-</span><span class="err">\</span><span class="n">w</span><span class="p">]+</span><span class="err">\</span><span class="p">.)+(?</span><span class="err">#</span><span class="n">TopLevel</span> <span class="n">Domains</span><span class="p">)(?:</span><span class="n">com</span><span class="p">|</span><span class="n">org</span><span class="p">|</span><span class="n">net</span><span class="p">|</span><span class="n">gov</span><span class="p">|</span><span class="n">mil</span><span class="p">|</span><span class="n">biz</span><span class="p">|</span><span class="n">info</span><span class="p">|</span><span class="n">mobi</span><span class="p">|</span><span class="n">name</span><span class="p">|</span><span class="n">aero</span><span class="p">|</span><span class="n">jobs</span><span class="p">|</span><span class="n">museum</span><span class="p">|</span><span class="n">travel</span><span class="p">|[</span><span class="n">a</span><span class="p">-</span><span class="n">z</span><span class="p">]{</span><span class="m">2</span><span class="p">}))(?</span><span class="err">#</span><span class="n">Port</span><span class="p">)(?::[</span><span class="err">\</span><span class="n">d</span><span class="p">]{</span><span class="m">1</span><span class="p">,</span><span class="m">5</span><span class="p">})?(?</span><span class="err">#</span><span class="n">Directories</span><span class="p">)(?:(?:(?:</span><span class="err">\</span><span class="p">/(?:[-</span><span class="err">\</span><span class="n">w</span><span class="p">~!</span><span class="err">$</span><span class="p">+|.,=]|%[</span><span class="n">a</span><span class="p">-</span><span class="n">f</span><span class="err">\</span><span class="n">d</span><span class="p">]{</span><span class="m">2</span><span class="p">})+)+|</span><span class="err">\</span><span class="p">/)+|</span><span class="err">\</span><span class="p">?|</span><span class="err">#</span><span class="p">)?(?</span><span class="err">#</span><span class="n">Query</span><span class="p">)(?:(?:</span><span class="err">\</span><span class="p">?(?:[-</span><span class="err">\</span><span class="n">w</span><span class="p">~!</span><span class="err">$</span><span class="p">+|.,*:]|%[</span><span class="n">a</span><span class="p">-</span><span class="n">f</span><span class="err">\</span><span class="n">d</span><span class="p">{</span><span class="m">2</span><span class="p">}])+=?(?:[-</span><span class="err">\</span><span class="n">w</span><span class="p">~!</span><span class="err">$</span><span class="p">+|.,*:=]|%[</span><span class="n">a</span><span class="p">-</span><span class="n">f</span><span class="err">\</span><span class="n">d</span><span class="p">]{</span><span class="m">2</span><span class="p">})*)(?:&amp;(?:[-</span><span class="err">\</span><span class="n">w</span><span class="p">~!</span><span class="err">$</span><span class="p">+|.,*:]|%[</span><span class="n">a</span><span class="p">-</span><span class="n">f</span><span class="err">\</span><span class="n">d</span><span class="p">{</span><span class="m">2</span><span class="p">}])+=?(?:[-</span><span class="err">\</span><span class="n">w</span><span class="p">~!</span><span class="err">$</span><span class="p">+|.,*:=]|%[</span><span class="n">a</span><span class="p">-</span><span class="n">f</span><span class="err">\</span><span class="n">d</span><span class="p">]{</span><span class="m">2</span><span class="p">})*)*)*(?</span><span class="err">#</span><span class="n">Anchor</span><span class="p">)(?:</span><span class="err">#</span><span class="p">(?:[-</span><span class="err">\</span><span class="n">w</span><span class="p">~!</span><span class="err">$</span><span class="p">+|.,*:=]|%[</span><span class="n">a</span><span class="p">-</span><span class="n">f</span><span class="err">\</span><span class="n">d</span><span class="p">]{</span><span class="m">2</span><span class="p">})*)?</span><span class="err">$</span>
</span></code></pre></td></tr></table></div></figure>


<p>There is a wave for this regex:</p>

<p><a href="https://wave.google.com/wave/?pli=1#restored:wave:googlewave.com!w%252BsFbGJUukA">https://wave.google.com/wave/?pli=1#restored:wave:googlewave.com!w%252BsFbGJUukA</a></p>

<p>Update 29/09/2010</p>

<p>So people if you don&#8217;t like it don&#8217;t use it.
Now this regex is troubled it has a bunch of issues but it works most of the time.  If you want a more liberal regular expression to just capture urls from text, there is a really good one on the blog of John Gruber.
<a href="http://daringfireball.net/2010/07/improved_regex_for_matching_urls">Improved regex for matching urls @ daring fireball</a></p>
</div>
  
  


    </article>
    <!-- divider for blog post -->
    <div class="divider"></div>
  
  
    <article class="blogpost row">
      
  <div class="post-heading"> 
    



    <p class="date">26</p>  
    <div class="month-year"><p><span>Oct</span><br />2009</p></div>



    
      <div class="post-title">
        <h5>
          <a href="/2009/10/26/creating-launcher-scripts-for-ironruby/" title="">Creating Launcher Scripts for IronRuby</a>
        </h5>
      </div> 
    
    <div class="clear"></div>
  </div>
  <!-- end of post heading -->
  
  <!-- start of post meta -->
  <div class="post-meta">
    <p>
       
  

<span class="byline author vcard">Posted by <span class="fn">Ivan Porto Carrero</span></span>

       
     </p>  
  </div>
  <!-- end of post meta -->
  


  <div class="entry-content"><p>It’s been a while since I blogged, I’ve been terribly busy going through some changes and prepping the book.</p>

<p>Anyway lately a lot of blog posts have been written on how to ironruby with cucumber to test your .NET code. While I think it’s great people are using ironruby and cucumber, the guide you can find on aslak’s github wiki isn’t the most ideal solution as it will only work for windows and it requires MRI to be installed on your system. So I thought I’d write up how I’ve been creating launchers that work both on windows .NET and mono systems.</p>

<p>Another problem the approach of setting the GEM_PATH to the MRI gem location is that if your gem requires a C-extension (which could easily be a C# extension in IronRuby) ruby will get confused about which one it’s going to need.</p>

<p>I’m going to use cucumber as an example but this counts for most ruby libraries. I’ve been using this for a few months already so it really doesn’t matter which version of IronRuby you’ve got installed. I’ve compiled a fresh version from github and deployed that to C:\ironruby on windows and added C:\ironruby\bin to my PATH environment variable. I installed my ironruby version on my *nix boxes in /usr/local/ironruby and added /usr/local/ironruby/bin, /usr/local/ironruby/silverlight/bin and /usr/local/ironruby/silverlight/scripts to my PATH environment variable.</p>

<h5>1. install the gem: igem install rspec cucumber &#8211;no-rdoc &#8211;no-ri</h5>

<p>this will install the rspec and cucumber gems with their dependencies. And the gems process will actually install the launcher scripts in C:\ironruby\lib\ironruby\gems\1.8\bin and we’re going to use those scripts to create our launcher script</p>

<h5>2. Get the launcher scripts into the bin dir</h5>

<p>On windows you can now go:</p>

<pre><code>copy C:\ironruby\lib\ironruby\gems\1.8\bin\cucumber C:\ironruby\bin\icucumber
copy C:\ironruby\lib\ironruby\gems\1.8\bin\cucumber.bat C:\ironruby\bin\icucumber.bat
</code></pre>

<p>NTFS supports symlinks so you could also use the junction tool from the sysinternals toolkit to create those instead of copying the files. <a href="http://technet.microsoft.com/en-us/sysinternals/bb896768.aspx">http://technet.microsoft.com/en-us/sysinternals/bb896768.aspx</a></p>

<p>On *nix based systems there is one more step to go through.</p>

<pre><code>cp /usr/local/ironruby/lib/IronRuby/gems/1.8/bin/cucumber /usr/local/ironruby/bin/icucumber
chmod +x /usr/local/ironruby/bin/icucumber
</code></pre>

<p>And this is the easier way to properly use installed gems from the ironruby distribution, it will also make it a lot easier to upgrade your gems in 2 different ruby installations at different times etc.</p>
</div>
  
  


    </article>
    <!-- divider for blog post -->
    <div class="divider"></div>
  
  
    <article class="blogpost row">
      
  <div class="post-heading"> 
    



    <p class="date">02</p>  
    <div class="month-year"><p><span>Jul</span><br />2009</p></div>



    
      <div class="post-title">
        <h5>
          <a href="/2009/07/02/a-rant-on-a-talk-falling-to-pieces/" title="">A Rant on a Talk Falling to Pieces</a>
        </h5>
      </div> 
    
    <div class="clear"></div>
  </div>
  <!-- end of post heading -->
  
  <!-- start of post meta -->
  <div class="post-meta">
    <p>
       
  

<span class="byline author vcard">Posted by <span class="fn">Ivan Porto Carrero</span></span>

       
     </p>  
  </div>
  <!-- end of post meta -->
  


  <div class="entry-content"><p>Earlier this week I had the pleasure of doing a talk for the Belgian .NET user group. During this talk I ran in to all kinds of problems. I&#8217;ve done presentations where I was royally underprepared and to avoid that this time I actually started prepping for this talk on time. I was done on time, was prepared had 5 backups of my presentation and samples. What did I learn from this, if you&#8217;re prepared other things will go wrong.    <br/>
I&#8217;ll share the story of stuff that can go wrong.</p>

<p>Before starting the rant I have some links to share.</p>

<ul>
<li><p><a href="http://www.slideshare.net/casualjim/ruby-loves-dot-net">Slides</a></p></li>
<li><p>IronRubyMvc sample – <a href="http://irtodo.koolkraft.net/">live demo</a> – <a href="http://github.com/casualjim/ironrubymvc-sample/tree/master">source</a></p></li>
<li><p>Silverlight sample – <a href="http://samples.koolkraft.net/picture_view/">live demo</a> – <a href="http://samples.koolkraft.net/picture_view.zip">source</a></p></li>
<li><p>IronRubyMVC specs – <a href="http://github.com/casualjim/ironrubymvc/tree">source</a></p></li>
<li><p>Sinatra – <a href="http://samples.koolkraft.net/sinatra.zip">source</a></p></li>
<li><p>Metaprogramming - <a href="http://samples.koolkraft.net/metaprogramming.zip">source</a></p></li>
</ul>


<p>I have a device that I call internet on a stick, which is a vodafone usb 3G modem that I plug in to my system and it gets me on the internet (mistake 1). Since I assumed that that thing would continue to work I made most of my demos internet enabled (mistake 2). For example I have a demo where I go download pics from flickr and then show them with some animations with silverlight.    <br/>
Before my presentation I changed the fonts, opened all the files I was going to talk about ran all the demos again to make sure they would work and everything went fine.     <br/>
I unplug the USB device and go into the room to hook up the projector etc. The presentation starts and for the first hour everything went really well (from my perspective at least don&#8217;t know about the people attending).     <br/>
We have a break and I plug the USB device in, at this point the vodafone program hangs (first time ever I swear). What&#8217;s more I can&#8217;t make it go away at all so I reboot my pc (this is still during the break).</p>

<p>Now I&#8217;m getting a little desperate because it still doesn&#8217;t work. With rebooting I also lost all my carefully opened files earlier (I&#8217;m showing code in about 3 different environments and 2 different OS&#8217;es).    <br/>
So during the presentation I apologise and try to reboot once more while taking questions from the audience and hoping somebody will try to start a discussion with me. After rebooting I got a message saying my date was set to 2001 which I thought was peculiar but clicked it away. I boot vmware fusion with windows 7 (this took fairly long and is a little bit funky as the screen resolution changes a lot during this process).     <br/>
Ok so far so good, by now I&#8217;ve already skipped the silverlight demo promising that it will be available as a download on my blog and will be moving on to the ironrubymvc sample. To prove I do actually use visual studio at times I wanted to open my demo project in visual studio. I open visual studio only for it to tell me that my trial has expired and I can either upgrade or close the application. Oooooookay this is completely weird because i get my software through my msdn subscription and I had been using it earlier that day.</p>

<p>Moral of the story: Either go vastly underprepared and wing it. Or don&#8217;t rely on the internet and always take at least 2 laptops that have identical configurations but I&#8217;m pretty sure those would or explode in my face or something will fall from the ceiling, building collapses or other mishaps.</p>

<p>Instead of having one demo go bad on me now I&#8217;m probably facing a reinstall of my mac because it lost a bunch of settings, for which I&#8217;m holding the vodafone responsible. At this moment I&#8217;m fairly certain that I should go less prepared and just wing it just out of fear for bigger disasters, people may die.</p>
</div>
  
  


    </article>
    <!-- divider for blog post -->
    <div class="divider"></div>
  
  
    <article class="blogpost row">
      
  <div class="post-heading"> 
    



    <p class="date">09</p>  
    <div class="month-year"><p><span>Jun</span><br />2009</p></div>



    
      <div class="post-title">
        <h5>
          <a href="/2009/06/09/very-simple-ironruby-mvc-sample-application/" title="">Very Simple IronRuby MVC Sample Application</a>
        </h5>
      </div> 
    
    <div class="clear"></div>
  </div>
  <!-- end of post heading -->
  
  <!-- start of post meta -->
  <div class="post-meta">
    <p>
       
  

<span class="byline author vcard">Posted by <span class="fn">Ivan Porto Carrero</span></span>

       
     </p>  
  </div>
  <!-- end of post meta -->
  


  <div class="entry-content"><p>Over the weekend I wrote a very simple task list application with IronRuby MVC and LightSpeed as an OR/M. And I’ve just put a demo live. This demo is running on a windows 2008 vps with IIS 7 as webserver. The source of this sample is also available.</p>

<p>At this moment I’m working on the <a href="http://github.com/jschementi/ironrubymvc/">Ironruby mvc</a> sample for my book. And while I was playing around to get some samples together I tried building the simplest application possible that has some degree relations in the db and does some crud. And I came up with the original idea of creating a task list application.</p>

<p>As an OR/M I choose to use <a href="http://www.mindscape.co.nz/products/LightSpeed/">LightSpeed</a> and it runs on a sqlite database so it should be immediately usable after checking out. There is one caveat though. If you’re using a 32-bit OS you’ll need to replace the sqlite dll that is included in the dependencies tree with a 32-bit version of the dll and rebuild the solution.</p>

<p>The links:</p>

<p>Demo:    <br/>
<a href="http://irtodo.koolkraft.net/">http://irtodo.koolkraft.net/</a></p>

<p>Source of sample:   <br/>
<a href="http://github.com/casualjim/ironrubymvc-sample">http://github.com/casualjim/ironrubymvc-sample</a></p>

<p>IronRubyMVC source:</p>

<p><a href="http://github.com/jschementi/ironrubymvc">http://github.com/jschementi/ironrubymvc</a></p>

<p>LightSpeed:   <br/>
<a href="http://www.mindscape.co.nz/products/LightSpeed/">http://www.mindscape.co.nz/products/LightSpeed/</a></p>

<p>Technorati Tags: <a href="http://technorati.com/tags/IronRuby+MVC">IronRuby MVC</a>,<a href="http://technorati.com/tags/IronRuby">IronRuby</a>,<a href="http://technorati.com/tags/ASP.NET+MVC">ASP.NET MVC</a></p>
</div>
  
  


    </article>
    <!-- divider for blog post -->
    <div class="divider"></div>
  
  
    <article class="blogpost row">
      
  <div class="post-heading"> 
    



    <p class="date">21</p>  
    <div class="month-year"><p><span>May</span><br />2009</p></div>



    
      <div class="post-title">
        <h5>
          <a href="/2009/05/21/getting-started-with-caricature-and-ironruby/" title="">Getting Started With Caricature and IronRuby</a>
        </h5>
      </div> 
    
    <div class="clear"></div>
  </div>
  <!-- end of post heading -->
  
  <!-- start of post meta -->
  <div class="post-meta">
    <p>
       
  

<span class="byline author vcard">Posted by <span class="fn">Ivan Porto Carrero</span></span>

       
     </p>  
  </div>
  <!-- end of post meta -->
  


  <div class="entry-content"><p>IronRuby 0.5 was released yesterday. You can download it on <a href="http://ironruby.codeplex.com/Release/ProjectReleases.aspx?ReleaseId=25902#DownloadId=68919">codeplex</a>. This post will explain how you setup your ironruby environment to use it for testing existing CLR based assemblies. We’ll touch installing gems using rake and most importantly writing a test for a CLR based class where we’ll mock out the dependencies.</p>

<p>The first thing you need to do is download <a href="http://ironruby.codeplex.com/Release/ProjectReleases.aspx?ReleaseId=25902#DownloadId=68919">IronRuby</a>. After downloading you can extract it to a location on your hard drive. I extracted mine to C:\ironruby</p>

<p>Now we need to add the path to ir.exe to our PATH variable so we can use it from the command-line. And that is all there is to it to install ironruby on your machine. Now we need to get the necessary gems onto our system. We’ll need bacon and caricature.</p>

<p>Open a console and type the following:</p>

<p>igem list will show you a list of the gems you have installed on your system.</p>

<p>igem install will fetch and install a gem on your system. To install the gems we’re going to need we need to execute the command</p>

<p>igem install bacon caricature</p>

<p>That will result in the following output:</p>

<pre><code>+ C:\tools
» cmd
Microsoft Windows [Version 6.1.7100]
Copyright (c) 2009 Microsoft Corporation.  All rights reserved.

C:\tools&gt;where ir
C:\ironruby\bin\ir.exe

C:\tools&gt;exit
+ C:\tools
» igem list

*** LOCAL GEMS ***


+ C:\tools
» igem install bacon caricature
Successfully installed bacon-1.1.0
Successfully installed caricature-0.6.0
3 gems installed
Installing ri documentation for bacon-1.1.0...
Installing ri documentation for caricature-0.6.0...
Installing RDoc documentation for bacon-1.1.0...
Installing RDoc documentation for caricature-0.6.0...
</code></pre>

<p>If you would try to execute ibacon at this point that would work. We’ll need to create 2 small files to get ibacon to work. In the bin directory of ironruby I created 2 files one called ibacon and the other one is ibacon.bat</p>

<figure class='code'><figcaption><span>ibacon</span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
</pre></td><td class='code'><pre><code class='ruby'><span class='line'><span class="c1">#!C:/ironruby/bin/ir.exe</span>
</span><span class='line'><span class="c1">#</span>
</span><span class='line'><span class="c1"># This file was generated by RubyGems.</span>
</span><span class='line'><span class="c1">#</span>
</span><span class='line'><span class="c1"># The application &#39;bacon&#39; is installed as part of a gem, and</span>
</span><span class='line'><span class="c1"># this file is here to facilitate running it.</span>
</span><span class='line'><span class="c1">#</span>
</span><span class='line'>
</span><span class='line'><span class="nb">require</span> <span class="s1">&#39;rubygems&#39;</span>
</span><span class='line'>
</span><span class='line'><span class="n">version</span> <span class="o">=</span> <span class="s2">&quot;&gt;= 0&quot;</span>
</span><span class='line'>
</span><span class='line'><span class="k">if</span> <span class="no">ARGV</span><span class="o">.</span><span class="n">first</span> <span class="o">=~</span> <span class="sr">/^_(.*)_$/</span> <span class="ow">and</span> <span class="no">Gem</span><span class="o">::</span><span class="no">Version</span><span class="o">.</span><span class="n">correct?</span> <span class="vg">$1</span> <span class="k">then</span>
</span><span class='line'>  <span class="n">version</span> <span class="o">=</span> <span class="vg">$1</span>
</span><span class='line'>  <span class="no">ARGV</span><span class="o">.</span><span class="n">shift</span>
</span><span class='line'><span class="k">end</span>
</span><span class='line'>
</span><span class='line'><span class="n">gem</span> <span class="s1">&#39;bacon&#39;</span><span class="p">,</span> <span class="n">version</span>
</span><span class='line'><span class="nb">load</span> <span class="s1">&#39;bacon&#39;</span>
</span></code></pre></td></tr></table></div></figure>




<figure class='code'><figcaption><span>ibacon.bat</span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
</pre></td><td class='code'><pre><code class='bat'><span class='line'><span class="p">@</span><span class="k">ECHO</span> <span class="k">OFF</span>
</span><span class='line'>
</span><span class='line'><span class="p">@</span><span class="s2">&quot;ir.exe&quot;</span> <span class="s2">&quot;%~dpn0&quot;</span> %*
</span></code></pre></td></tr></table></div></figure>


<p></p>

<p>At this point you’re ready to start writing specs with bacon and caricature. Let’s look at an example I wrote for the controller factory for ironruby mvc.</p>

<p>We’re going to test the following C# code.</p>

<figure class='code'><figcaption><span>Models.cs    </span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
<span class='line-number'>24</span>
<span class='line-number'>25</span>
</pre></td><td class='code'><pre><code class='csharp'><span class='line'><span class="k">public</span> <span class="k">interface</span> <span class="n">IWeapon</span><span class="p">{</span>
</span><span class='line'>    <span class="kt">int</span> <span class="nf">Attack</span><span class="p">(</span><span class="n">IWarrior</span> <span class="n">warrior</span><span class="p">);</span>
</span><span class='line'>    <span class="kt">int</span> <span class="nf">Damage</span><span class="p">();</span>
</span><span class='line'><span class="p">}</span>
</span><span class='line'>
</span><span class='line'><span class="k">public</span> <span class="k">interface</span> <span class="n">IWarrior</span>
</span><span class='line'><span class="p">{</span>
</span><span class='line'>    <span class="kt">int</span> <span class="n">Id</span> <span class="p">{</span> <span class="k">get</span><span class="p">;</span> <span class="p">}</span>
</span><span class='line'>    <span class="kt">string</span> <span class="n">Name</span> <span class="p">{</span> <span class="k">get</span><span class="p">;</span> <span class="k">set</span><span class="p">;</span> <span class="p">}</span>
</span><span class='line'>    <span class="kt">bool</span> <span class="nf">IsKilledBy</span><span class="p">(</span><span class="n">IWeapon</span> <span class="n">weapon</span><span class="p">);</span>
</span><span class='line'>    <span class="kt">int</span> <span class="nf">Attack</span><span class="p">(</span><span class="n">IWarrior</span> <span class="n">target</span><span class="p">,</span> <span class="n">IWeapon</span> <span class="n">weapon</span><span class="p">);</span>
</span><span class='line'>    <span class="kt">int</span> <span class="nf">SurviveAttackWith</span><span class="p">(</span><span class="n">IWeapon</span> <span class="n">weapon</span><span class="p">);</span>
</span><span class='line'><span class="p">}</span>
</span><span class='line'>
</span><span class='line'><span class="k">public</span> <span class="k">class</span> <span class="nc">Sword</span> <span class="p">:</span> <span class="n">IWeapon</span>
</span><span class='line'><span class="p">{</span>
</span><span class='line'>
</span><span class='line'>    <span class="k">public</span> <span class="kt">int</span> <span class="nf">Attack</span><span class="p">(</span><span class="n">IWarrior</span> <span class="n">warrior</span><span class="p">){</span>
</span><span class='line'>        <span class="k">return</span> <span class="n">warrior</span><span class="p">.</span><span class="n">SurviveAttackWith</span><span class="p">(</span><span class="k">this</span><span class="p">);</span>
</span><span class='line'>    <span class="p">}</span>
</span><span class='line'>
</span><span class='line'>    <span class="k">public</span> <span class="kt">int</span> <span class="nf">Damage</span><span class="p">(){</span>
</span><span class='line'>        <span class="k">return</span> <span class="m">4</span><span class="p">;</span>
</span><span class='line'>    <span class="p">}</span>
</span><span class='line'><span class="p">}</span>
</span></code></pre></td></tr></table></div></figure>


<p>I generally create a bacon_helper.rb file where I group my requires and helper functions etc. In the case of this test I have the following in the bacon_helper.rb:</p>

<figure class='code'><figcaption><span>bacon_helper.rb</span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
</pre></td><td class='code'><pre><code class='ruby'><span class='line'><span class="c1"># add some search paths to ironruby</span>
</span><span class='line'><span class="c1"># this first one adds the path with the assemblies</span>
</span><span class='line'><span class="c1"># this enables us not to have to specify a path to the assemblies everywhere.</span>
</span><span class='line'><span class="vg">$:</span> <span class="o">&lt;&lt;</span> <span class="no">File</span><span class="o">.</span><span class="n">dirname</span><span class="p">(</span><span class="bp">__FILE__</span><span class="p">)</span> <span class="o">+</span> <span class="s2">&quot;/bin&quot;</span>
</span><span class='line'><span class="c1"># adds the path to the caricature library.</span>
</span><span class='line'><span class="vg">$:</span> <span class="o">&lt;&lt;</span> <span class="no">File</span><span class="o">.</span><span class="n">dirname</span><span class="p">(</span><span class="bp">__FILE__</span><span class="p">)</span> <span class="o">+</span> <span class="s2">&quot;/../lib&quot;</span>
</span><span class='line'>
</span><span class='line'><span class="c1"># load the caricature library</span>
</span><span class='line'><span class="nb">require</span> <span class="s2">&quot;caricature&quot;</span>
</span><span class='line'><span class="nb">require</span> <span class="s1">&#39;caricature/clr&#39;</span>
</span><span class='line'>
</span><span class='line'><span class="c1"># load the bacon library</span>
</span><span class='line'><span class="nb">require</span> <span class="s1">&#39;bacon&#39;</span>
</span><span class='line'>
</span><span class='line'><span class="c1"># Add the .NET framework</span>
</span><span class='line'><span class="nb">require</span> <span class="s1">&#39;mscorlib&#39;</span>
</span><span class='line'>
</span><span class='line'><span class="c1"># load the assembly with the C# code</span>
</span><span class='line'><span class="n">load_assembly</span> <span class="s1">&#39;ClrModels&#39;</span>
</span></code></pre></td></tr></table></div></figure>


<p></p>

<p>At this point we’re ready to start writing the test. create a file called sword_spec.rb and we’ll add the following content to the file.</p>

<figure class='code'><figcaption><span>swordspec.rb    </span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
<span class='line-number'>24</span>
<span class='line-number'>25</span>
<span class='line-number'>26</span>
<span class='line-number'>27</span>
<span class='line-number'>28</span>
<span class='line-number'>29</span>
<span class='line-number'>30</span>
<span class='line-number'>31</span>
</pre></td><td class='code'><pre><code class='ruby'><span class='line'><span class="nb">require</span> <span class="no">File</span><span class="o">.</span><span class="n">dirname</span><span class="p">(</span><span class="bp">__FILE__</span><span class="p">)</span> <span class="o">+</span> <span class="s2">&quot;/bacon_helper.rb&quot;</span>
</span><span class='line'>
</span><span class='line'><span class="n">describe</span> <span class="s2">&quot;ClrModels::Sword&quot;</span> <span class="k">do</span>
</span><span class='line'>
</span><span class='line'>  <span class="n">before</span> <span class="k">do</span>
</span><span class='line'>    <span class="vi">@warrior</span> <span class="o">=</span> <span class="no">Caricature</span><span class="o">::</span><span class="no">Isolation</span><span class="o">.</span><span class="n">for</span> <span class="no">ClrModels</span><span class="o">::</span><span class="no">IWarrior</span>
</span><span class='line'>  <span class="k">end</span>
</span><span class='line'>
</span><span class='line'>  <span class="n">it</span> <span class="s2">&quot;should call survive_attack on the mock&quot;</span> <span class="k">do</span>
</span><span class='line'>    <span class="vi">@warrior</span><span class="o">.</span><span class="n">when_receiving</span><span class="p">(</span><span class="ss">:survive_attack_with</span><span class="p">)</span><span class="o">.</span><span class="n">return</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span>
</span><span class='line'>
</span><span class='line'>    <span class="n">sword</span> <span class="o">=</span> <span class="no">ClrModels</span><span class="o">::</span><span class="no">Sword</span><span class="o">.</span><span class="n">new</span>
</span><span class='line'>    <span class="n">sword</span><span class="o">.</span><span class="n">attack</span><span class="p">(</span><span class="vi">@warrior</span><span class="p">)</span><span class="o">.</span><span class="n">should</span><span class="o">.</span><span class="n">equal</span> <span class="mi">5</span>
</span><span class='line'>
</span><span class='line'>    <span class="vi">@warrior</span><span class="o">.</span><span class="n">did_receive?</span><span class="p">(</span><span class="ss">:survive_attack_with</span><span class="p">)</span><span class="o">.</span><span class="n">should</span><span class="o">.</span><span class="n">be</span><span class="o">.</span><span class="n">successful</span>
</span><span class='line'>  <span class="k">end</span>
</span><span class='line'>
</span><span class='line'>  <span class="n">it</span> <span class="s2">&quot;should return different results when expectation is defined with arguments&quot;</span> <span class="k">do</span>
</span><span class='line'>    <span class="n">sword1</span> <span class="o">=</span> <span class="no">ClrModels</span><span class="o">::</span><span class="no">Sword</span><span class="o">.</span><span class="n">new</span>
</span><span class='line'>    <span class="n">sword2</span> <span class="o">=</span> <span class="no">ClrModels</span><span class="o">::</span><span class="no">Sword</span><span class="o">.</span><span class="n">new</span>
</span><span class='line'>
</span><span class='line'>    <span class="vi">@warrior</span><span class="o">.</span><span class="n">when_receiving</span><span class="p">(</span><span class="ss">:survive_attack_with</span><span class="p">)</span><span class="o">.</span><span class="n">return</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span>
</span><span class='line'>    <span class="vi">@warrior</span><span class="o">.</span><span class="n">when_receiving</span><span class="p">(</span><span class="ss">:survive_attack_with</span><span class="p">)</span><span class="o">.</span><span class="n">with</span><span class="p">(</span><span class="n">sword2</span><span class="p">)</span><span class="o">.</span><span class="n">return</span><span class="p">(</span><span class="mi">15</span><span class="p">)</span>
</span><span class='line'>
</span><span class='line'>    <span class="n">sword1</span><span class="o">.</span><span class="n">attack</span><span class="p">(</span><span class="vi">@warrior</span><span class="p">)</span><span class="o">.</span><span class="n">should</span><span class="o">.</span><span class="n">equal</span> <span class="mi">5</span>
</span><span class='line'>    <span class="n">sword2</span><span class="o">.</span><span class="n">attack</span><span class="p">(</span><span class="vi">@warrior</span><span class="p">)</span><span class="o">.</span><span class="n">should</span><span class="o">.</span><span class="n">equal</span> <span class="mi">15</span>
</span><span class='line'>
</span><span class='line'>    <span class="vi">@warrior</span><span class="o">.</span><span class="n">did_receive?</span><span class="p">(</span><span class="ss">:survive_attack_with</span><span class="p">)</span><span class="o">.</span><span class="n">with</span><span class="p">(</span><span class="n">sword2</span><span class="p">)</span><span class="o">.</span><span class="n">should</span><span class="o">.</span><span class="n">be</span><span class="o">.</span><span class="n">successful</span>
</span><span class='line'>  <span class="k">end</span>
</span><span class='line'>
</span><span class='line'><span class="k">end</span>
</span></code></pre></td></tr></table></div></figure>


<p>So now we’ve got 2 tests for our Sword class. The only thing that is left to do is to run the specs. You can do that by executing the ibacon command and passing it the file you want to test.</p>

<pre><code>+ C:\dev\caricature
(master) » ibacon spec/sword_spec.rb
ClrModels::Sword
- should call survive_attack on the mock
- should return different results when expectation is defined with arguments

2 specifications (5 requirements), 0 failures, 0 errors
</code></pre>
</div>
  
  


    </article>
    <!-- divider for blog post -->
    <div class="divider"></div>
  
  
    <article class="blogpost row">
      
  <div class="post-heading"> 
    



    <p class="date">19</p>  
    <div class="month-year"><p><span>May</span><br />2009</p></div>



    
      <div class="post-title">
        <h5>
          <a href="/2009/05/19/caricature-ready-for-beta/" title="">Caricature Ready for Beta</a>
        </h5>
      </div> 
    
    <div class="clear"></div>
  </div>
  <!-- end of post heading -->
  
  <!-- start of post meta -->
  <div class="post-meta">
    <p>
       
  

<span class="byline author vcard">Posted by <span class="fn">Ivan Porto Carrero</span></span>

       
     </p>  
  </div>
  <!-- end of post meta -->
  


  <div class="entry-content"><p>The last couple of days I’ve been getting <a href="http://github.com/casualjim/caricature">Caricature</a> to a more releasable state. The code got a thorough cleanup and refactor. Caricature now knows how to be a full mocking framework for Ruby classes and CLR classes that only interact with ruby objects. When I apply the 80/20 rule to caricature it’s definitely beta worthy.</p>

<p>I’m not a huge fan of the 80/20 rule unless all the features I want are in the 80 part. In that case for me it’s a 100 rule ;).</p>

<p>As for the latest changes:</p>

<p>Adding <code>require 'caricature'</code> only gives you ruby mocking. If you want to use it to mock CLR classes or interact with the CLR you’ll need to add an extra require statement:<code>require 'caricature/clr'</code>. I’ve done it this way so that I can still add Java and MacRuby support later on.</p>

<p>By default caricature will always give you an instance of an isolation, but there are times that you’ll want to substitute the result of a class method invocation. So the API got expanded with 2 methods, <code>when_class_receives</code> and <code>did_class_receive?</code> These methods enable you to setup substitutions for class method calls.</p>

<p>I’m still waiting for IronRuby 0.5 to be released to give you a blow-by-blow tutorial on how to setup your environment.</p>

<p>Basically you download the ironruby release from <a href="http://ironruby.codeplex.com/Release/ProjectReleases.aspx">Codeplex</a></p>

<p>Then you make sure the path to ir.exe is in your PATH variable</p>

<p>After that you should be able to do igem list and get an empty result back.</p>

<p>now you need to install bacon you can do that by executing</p>

<p>  igem install bacon</p>

<p>next you need the caricature gem</p>

<p>  igem install caricature</p>

<p>You will also need rake to be installed to build the cs files included in the sources.</p>

<p>  igem install rake</p>

<p>ok now you should be good to to</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
<span class='line-number'>24</span>
<span class='line-number'>25</span>
</pre></td><td class='code'><pre><code class='ruby'><span class='line'><span class="nb">require</span> <span class="s1">&#39;rubygems&#39;</span>
</span><span class='line'><span class="nb">require</span> <span class="s1">&#39;bacon&#39;</span>
</span><span class='line'><span class="nb">require</span> <span class="s1">&#39;caricature&#39;</span>
</span><span class='line'><span class="nb">require</span> <span class="s1">&#39;caricature/clr&#39;</span>
</span><span class='line'>
</span><span class='line'><span class="n">describe</span> <span class="s2">&quot;when isolating Ruby classes with class members&quot;</span> <span class="k">do</span>
</span><span class='line'>
</span><span class='line'>  <span class="n">before</span> <span class="k">do</span>
</span><span class='line'>    <span class="vi">@dagger</span> <span class="o">=</span> <span class="no">Dagger</span><span class="o">.</span><span class="n">new</span>
</span><span class='line'>    <span class="vi">@soldier</span> <span class="o">=</span> <span class="no">Caricature</span><span class="o">::</span><span class="no">Isolation</span><span class="o">.</span><span class="n">for</span><span class="p">(</span><span class="no">SoldierWithClassMembers</span><span class="p">)</span>
</span><span class='line'>  <span class="k">end</span>
</span><span class='line'>
</span><span class='line'>  <span class="n">it</span> <span class="s2">&quot;should work without expectations&quot;</span> <span class="k">do</span>
</span><span class='line'>    <span class="n">result</span> <span class="o">=</span> <span class="vi">@dagger</span><span class="o">.</span><span class="n">attack</span> <span class="vi">@soldier</span>
</span><span class='line'>    <span class="n">result</span><span class="o">.</span><span class="n">should</span><span class="o">.</span><span class="n">equal</span> <span class="kp">nil</span>
</span><span class='line'>    <span class="vi">@soldier</span><span class="o">.</span><span class="n">did_receive?</span><span class="p">(</span><span class="ss">:survive_attack_with</span><span class="p">)</span><span class="o">.</span><span class="n">with</span><span class="p">(</span><span class="vi">@dagger</span><span class="p">)</span><span class="o">.</span><span class="n">should</span><span class="o">.</span><span class="n">be</span><span class="o">.</span><span class="n">successful</span>
</span><span class='line'>  <span class="k">end</span>
</span><span class='line'>
</span><span class='line'>  <span class="n">it</span> <span class="s2">&quot;should work for expectations with an argument constraint&quot;</span> <span class="k">do</span>
</span><span class='line'>    <span class="vi">@soldier</span><span class="o">.</span><span class="n">when_receiving</span><span class="p">(</span><span class="ss">:survive_attack_with</span><span class="p">)</span><span class="o">.</span><span class="n">with</span><span class="p">(</span><span class="vi">@dagger</span><span class="p">)</span><span class="o">.</span><span class="n">return</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span>
</span><span class='line'>    <span class="vi">@dagger</span><span class="o">.</span><span class="n">attack</span><span class="p">(</span><span class="vi">@soldier</span><span class="p">)</span><span class="o">.</span><span class="n">should</span><span class="o">.</span><span class="n">equal</span> <span class="mi">5</span>
</span><span class='line'>    <span class="vi">@soldier</span><span class="o">.</span><span class="n">did_receive?</span><span class="p">(</span><span class="ss">:survive_attack_with</span><span class="p">)</span><span class="o">.</span><span class="n">with</span><span class="p">(</span><span class="ss">:any</span><span class="p">)</span><span class="o">.</span><span class="n">should</span><span class="o">.</span><span class="n">be</span><span class="o">.</span><span class="n">successful</span>
</span><span class='line'>  <span class="k">end</span>
</span><span class='line'>
</span><span class='line'><span class="k">end</span>
</span></code></pre></td></tr></table></div></figure>


<p>you can get the gem from <a href="http://rubyforge.org/projects/caricature/">rubyforge</a></p>

<p>Or from my github account: <a href="http://github.com/casualjim/caricature">http://github.com/casualjim/caricature</a></p>
</div>
  
  


    </article>
    <!-- divider for blog post -->
    <div class="divider"></div>
  
  <div class="pagination">
    
      <a class="prev" href="/page/2/">&larr; Older</a>
    
    <a href="/blog/archives">Blog Archives</a>
    
  </div>
</div>
</div>


      </div>
    </div>
    <footer role="contentinfo"><!-- start of footer container -->
  <div class="container">
    <!-- start of row - 4 widget columns -->
      <div class="row clearfix">
      <div class="twelve columns">
        <div class="logo">
          <img src="/images/logo.png" alt="" />
          <h2>Rants &amp; ramblings</h2>
        </div>
      </div>

      <div class="four columns">        
        <h6>Social networks</h6>
        <ul class="social_network">
          <li class="rollover"><a href="http://facebook.com/ivanportocarrero" class="yellowtip" title="Facebook"><span class="fb-rollover"></span><img src="/images/social/fb.png" alt="" /></a></li>
          <li class="rollover"><a href="http://twitter.com/casualjim" class="yellowtip" title="Follow me"><span class="twitter-rollover"></span><img src="/images/social/twitter.png" alt="" /></a></li>
          <li class="rollover"><a href="https://plus.google.com/u/1/106536131996809745163/posts" class="yellowtip" title="Google plus"><span class="google-rollover"></span><img src="/images/social/google-plus.png" alt="" /></a></li>
        </ul>       
      </div>
    </div>
    <!-- end of row -->
  
    <!-- start of row - 4 widget columns -->
      <div class="row clearfix">
      <div class="eight columns">
        <h6>About me</h6>
        <p>
        Welcome to my blog. This is a collection of random thoughts and rants.
        </p>
        <p>
        Allow me to introduce myself. My name is Ivan Porto Carrero and I'm an enthusiastic developer on  Scala, .NET and Ruby.<br />Through this blog I hope I can share some of that passion and maybe help somebody out when they are looking on how to do something.
        </p>
      </div>
      <div class="four columns">
        <h6>Latest posts</h6>
        <ul class="square">
        
          <li>
            <a href="/2011/08/01/backchat-developers/">work for backchat</a>
          </li>
        
          <li>
            <a href="/2010/09/30/radical-language-and-platform-shift/">Radical language and platform shift</a>
          </li>
        
          <li>
            <a href="/2010/03/12/video-of-fosdem-ironruby-presentation/">Video of FOSDEM IronRuby presentation</a>
          </li>
        
          <li>
            <a href="/2009/12/01/adding-a-console-to-your-ironruby-application/">Adding a console to your IronRuby application</a>
          </li>
        
          <li>
            <a href="/2009/11/08/a-good-url-regular-expression-repost/">A good url regular expression? (repost)</a>
          </li>
        
        </ul> 
      </div>
      <div class="four columns">
        <h6>Browse pages</h6>
        <ul class="square">
          <li><a href="/">Home</a></li>
          <li><a href="/archives">Archives</a></li>
          <li><a href="/projects">My projects</a></li>
        </ul> 
      </div>
    </div>
    <!-- end of row -->
    

    <!-- start of footer divider -->
    <div class="sixteen columns">
      <div class="footer-divider row"></div>
    </div>  
    <!-- end of footer divider -->
    
    <!-- start of bottoms -->
    <div class="clearfix footnote">
      <div class="eight columns">
        <p class="copyright">Copyright &copy; 2012 - Ivan Porto Carrero - All Right Reserved</p>
      </div>
      <div class="eight columns">
        <p class="align-right"><span class="credit">Powered by <a href="http://octopress.org">Octopress</a>, designed by <a href="http://iweb-studio.com" target="_blank">iwebstudio</a></p>
      </div>
    </div>
    <!-- end of bottoms -->

  </div>
  <!-- end of footer container -->

</footer>
  </div>
  

<script type="text/javascript">
      var disqus_shortname = 'casualjim';
      
        
        var disqus_script = 'count.js';
      
    (function () {
      var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
      dsq.src = 'http://' + disqus_shortname + '.disqus.com/' + disqus_script;
      (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
    }());
</script>



<div id="fb-root"></div>
<script>(function(d, s, id) {
  var js, fjs = d.getElementsByTagName(s)[0];
  if (d.getElementById(id)) {return;}
  js = d.createElement(s); js.id = id;
  js.src = "//connect.facebook.net/en_US/all.js#appId=212934732101925&xfbml=1";
  fjs.parentNode.insertBefore(js, fjs);
}(document, 'script', 'facebook-jssdk'));</script>



  <script type="text/javascript">
    (function() {
      var script = document.createElement('script'); script.type = 'text/javascript'; script.async = true;
      script.src = 'https://apis.google.com/js/plusone.js';
      var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(script, s);
    })();
  </script>



  <script type="text/javascript">
    (function(){
      var twitterWidgets = document.createElement('script');
      twitterWidgets.type = 'text/javascript';
      twitterWidgets.async = true;
      twitterWidgets.src = 'http://platform.twitter.com/widgets.js';
      document.getElementsByTagName('head')[0].appendChild(twitterWidgets);
    })();
  </script>



<p id="back-top">
  <a href="#top"><span></span>To top</a>
</p>

</body>
</html>
