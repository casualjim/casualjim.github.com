
<!DOCTYPE html>
<!--[if IEMobile 7 ]><html class="no-js iem7"><![endif]-->
<!--[if lt IE 9]><html class="no-js lte-ie8"><![endif]-->
<!--[if (gt IE 8)|(gt IEMobile 7)|!(IEMobile)|!(IE)]><!--><html class="no-js" lang="en"><!--<![endif]-->
<head>
  <meta charset="utf-8">
  <title>ASP.NET MVC XsltViewEngine, patch submitted to the contrib project - Ivan Porto Carrero</title>
  <meta name="author" content="Ivan Porto Carrero">

  
  <meta name="description" content="I just submitted a patch to the mvc contrib project that contains the xslt view engine I wrote for Xero without any of the dependencies from our own &hellip;">
  

  <!-- http://t.co/dKP3o1e -->
  <meta name="HandheldFriendly" content="True">
  <meta name="MobileOptimized" content="320">
  <meta name="viewport" content="width=device-width, initial-scale=1">

  
  <link rel="canonical" href="http://flanders.co.nz/2007/12/14/xsltviewengine-patch-submitted">
  <link href="/favicon.png" rel="icon">
  <link href="/stylesheets/screen.css" media="screen, projection" rel="stylesheet" type="text/css">
  <script src="/javascripts/modernizr-2.0.js"></script>
  <script src="/javascripts/ender.js"></script>
  <script src="/javascripts/octopress.js" type="text/javascript"></script>
  <link href="/atom.xml" rel="alternate" title="Ivan Porto Carrero" type="application/atom+xml">
  <!--Fonts from Google"s Web font directory at http://google.com/webfonts -->
<link href="http://fonts.googleapis.com/css?family=PT+Serif:regular,italic,bold,bolditalic" rel="stylesheet" type="text/css">
<link href="http://fonts.googleapis.com/css?family=PT+Sans:regular,italic,bold,bolditalic" rel="stylesheet" type="text/css">

  
  <script type="text/javascript">
    var _gaq = _gaq || [];
    _gaq.push(['_setAccount', 'UA-240612-3']);
    _gaq.push(['_trackPageview']);

    (function() {
      var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
      ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
      var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
    })();
  </script>


</head>

<body   >
  <header role="banner"><hgroup>
  <h1><a href="/">Ivan Porto Carrero</a></h1>
  
    <h2>IO(thoughts) foreach (_.propagandize)</h2>
  
</hgroup>

</header>
  <nav role="navigation"><ul class="subscription" data-subscription="rss">
  <li><a href="/atom.xml" rel="subscribe-rss" title="subscribe via RSS">RSS</a></li>
  
</ul>
  
<form action="http://google.com/search" method="get">
  <fieldset role="search">
    <input type="hidden" name="q" value="site:flanders.co.nz" />
    <input class="search" type="text" name="q" results="0" placeholder="Search"/>
  </fieldset>
</form>
  
<ul class="main-navigation">
  <li><a href="/">Blog</a></li>
  <li><a href="/blog/archives">Archives</a></li>
</ul>

</nav>
  <div id="main">
    <div id="content">
      <div>
<article class="hentry" role="article">
  
  <header>
    
      <h1 class="entry-title">ASP.NET MVC XsltViewEngine, Patch Submitted to the Contrib Project</h1>
    
    
      <p class="meta">
        








  


<time datetime="2007-12-14T17:29:30+01:00" pubdate data-updated="true">Dec 14<span>th</span>, 2007</time>
        
      </p>
    
  </header>


<div class="entry-content"><p>I just submitted a patch to the <a href="http://mvccontrib.org">mvc contrib project</a> that contains the xslt view engine I wrote for <a href="http://xero.com">Xero</a> without any of the dependencies from our own libraries or commercial components.</p>

<p>The bulk of the work is done in a class called XmlResponseBuilder which builds the xml document that is going to be transformed by the xsl stylesheet. Almost all the rest of the code is there just to build up this document.</p>

<p>The implementation of IView and IViewFactory were the easy bits :)</p>

<p>To use the View engine you need to take the following steps:</p>

<ol>
<li>Get the MVC Contrib project from google code</li>
</ol>


<p>repository url: <a href="http://mvccontrib.googlecode.com/svn/trunk/">http://mvccontrib.googlecode.com/svn/trunk/</a></p>

<ol>
<li>If the patch hasn&#8217;t been applied yet you can download it from: <a href="http://www.codeplex.com/Project/Download/FileDownload.aspx?ProjectName=MVCContrib&amp;DownloadId=23748">http://www.codeplex.com/Project/Download/FileDownload.aspx?ProjectName=MVCContrib&DownloadId;=23748</a></li>
</ol>


<p>After downloading the patch you can apply it to the downloaded mvc contrib project.</p>

<ol>
<li>I use a base controller to ensure that the correct data is passed to the view factory. This is the base controller class:</li>
</ol>


<p>public abstract class XeroControllerBase : Controller</p>

<p>    {</p>

<p>        private readonly XsltViewData vData = new XsltViewData();</p>

<p> </p>

<p>        protected IHttpSessionState Session</p>

<p>        {</p>

<p>            get { return ControllerContext.HttpContext.Session; }</p>

<p>        }</p>

<p> </p>

<p>        public XeroControllerBase()</p>

<p>        {</p>

<p>            ViewFactory = new XsltViewFactory();  </p>

<p>        }</p>

<p> </p>

<p>        #region Add datasource methods</p>

<p> </p>

<p>        protected void AddDataSource(IXmlConvertible dataSource)</p>

<p>        {</p>

<p>            vData.DataSources.Add(new XslDataSource(dataSource));</p>

<p>        }</p>

<p> </p>

<p>        protected void AddDataSource(IXmlConvertible dataSource, string rootName)</p>

<p>        {</p>

<p>            vData.DataSources.Add(new XslDataSource(rootName, dataSource));</p>

<p>        }</p>

<p> </p>

<p>        #endregion</p>

<p> </p>

<p>        #region Add variable methods</p>

<p> </p>

<p>        protected void AddPageVar(string key, string value)</p>

<p>        {</p>

<p>            vData.PageVars.Add(key, value);</p>

<p>        }</p>

<p> </p>

<p>        #endregion</p>

<p> </p>

<p>        #region Add message methods</p>

<p> </p>

<p> </p>

<p>        protected void AddErrorMessage(string message)</p>

<p>        {</p>

<p>            vData.Messages.Add(new ErrorMessage(message));</p>

<p>        }</p>

<p> </p>

<p>        protected void AddErrormessage(string message, string controlID)</p>

<p>        {</p>

<p>            vData.Messages.Add(new ErrorMessage(message, controlID));</p>

<p>        }</p>

<p> </p>

<p>        protected void AddInfoMessage(string message)</p>

<p>        {</p>

<p>            vData.Messages.Add(new InfoMessage(message));</p>

<p>        }</p>

<p> </p>

<p>        protected void AddInfoMessage(string message, string controlID)</p>

<p>        {</p>

<p>            vData.Messages.Add(new InfoMessage(message, controlID));</p>

<p>        }</p>

<p> </p>

<p>        protected void AddAlertMessage(string message)</p>

<p>        {</p>

<p>            vData.Messages.Add(new AlertMessage(message));</p>

<p>        }</p>

<p> </p>

<p>        protected void AddAlertMessage(string message, string controlID)</p>

<p>        {</p>

<p>            vData.Messages.Add(new AlertMessage(message, controlID));</p>

<p>        }</p>

<p> </p>

<p>        protected void AddInfoHtmlMessage(string message)</p>

<p>        {</p>

<p>            vData.Messages.Add(new InfoHtmlMessage(message));</p>

<p>        }</p>

<p> </p>

<p>        protected void AddInfoHtmlMessage(string message, string controlID)</p>

<p>        {</p>

<p>            vData.Messages.Add(new InfoHtmlMessage(message, controlID));</p>

<p>        }</p>

<p> </p>

<p>        protected void AddErrorHtmlMessage(string message)</p>

<p>        {</p>

<p>            vData.Messages.Add(new ErrorHtmlMessage(message));</p>

<p>        }</p>

<p> </p>

<p>        protected void AddErrorHtmlmessage(string message, string controlID)</p>

<p>        {</p>

<p>            vData.Messages.Add(new ErrorHtmlMessage(message, controlID));</p>

<p>        }</p>

<p> </p>

<p>        protected void AddAlertHtmlMessage(string message)</p>

<p>        {</p>

<p>            vData.Messages.Add(new AlertHtmlMessage(message));</p>

<p>        }</p>

<p> </p>

<p>        protected void AddAlertHtmlMessage(string message, string controlID)</p>

<p>        {</p>

<p>            vData.Messages.Add(new AlertHtmlMessage(message, controlID));</p>

<p>        }</p>

<p> </p>

<p>        #endregion</p>

<p> </p>

<p>        #region RenderView method hides</p>

<p> </p>

<p>        protected new virtual void RenderView(string viewName)</p>

<p>        {</p>

<p>            RenderView(viewName, string.Empty, vData);</p>

<p>        }</p>

<p> </p>

<p>        protected new void RenderView(string viewName, string masterName)</p>

<p>        {</p>

<p>            RenderView(viewName, string.Empty, vData);</p>

<p>        }</p>

<p> </p>

<p>        protected new void RenderView(string viewName, object viewData)</p>

<p>        {</p>

<p>            RenderView(viewName, string.Empty, vData);</p>

<p>        }</p>

<p> </p>

<p>        #endregion </p>

<p>    }</p>

<p> </p>

<p>del.icio.us Tags: <a href="http://del.icio.us/popular/aspnetmvc">aspnetmvc</a></p>

<p> </p>

<p><a href="http://www.dotnetkicks.com/kick/?url=http%3a%2f%2fflanders.co.nz%2fblog%2farchive%2f2007%2f12%2f15%2fxsltviewengine-patch-submitted.aspx"><img src="http://www.dotnetkicks.com/Services/Images/KickItImageGenerator.ashx?url=http%3a%2f%2fflanders.co.nz%2fblog%2farchive%2f2007%2f12%2f15%2fxsltviewengine-patch-submitted.aspx" alt="kick it on DotNetKicks.com" /></a></p>
</div>


  <footer>
    <p class="meta">
      
  

<span class="byline author vcard">Posted by <span class="fn">Ivan Porto Carrero</span></span>

      








  


<time datetime="2007-12-14T17:29:30+01:00" pubdate data-updated="true">Dec 14<span>th</span>, 2007</time>
      

<span class="categories">
  
    <a class='category' href='/categories/-net-3-5/'>.NET 3.5</a>, <a class='category' href='/categories/c-/'>C#</a>, <a class='category' href='/categories/general/'>General</a>
  
</span>


    </p>
    
      <div class="sharing">
  
  <a href="http://twitter.com/share" class="twitter-share-button" data-url="http://flanders.co.nz/2007/12/14/xsltviewengine-patch-submitted/" data-via="casualjim" data-counturl="http://flanders.co.nz/2007/12/14/xsltviewengine-patch-submitted/" >Tweet</a>
  
  
  <div class="g-plusone" data-size="medium"></div>
  
  
    <div class="fb-like" data-send="true" data-width="450" data-show-faces="false"></div>
  
</div>

    
    <p class="meta">
      
        <a class="basic-alignment left" href="/2007/12/12/aspnet-mvc-taken-for-a-test-drive/" title="Previous Post: ASP.NET mvc taken for a test drive">&laquo; ASP.NET mvc taken for a test drive</a>
      
      
        <a class="basic-alignment right" href="/2007/12/16/implementing-filters-in-aspnet-mvc/" title="Next Post: Implementing filters in asp.net mvc">Implementing filters in asp.net mvc &raquo;</a>
      
    </p>
  </footer>
</article>

</div>

<aside class="sidebar">
  
    <section>
  <h1>Recent Posts</h1>
  <ul id="recent_posts">
    
      <li class="post">
        <a href="/2011/09/03/scalatra-is-a-dsl-in-a-string/">Scalatra is a DSL in a string</a>
      </li>
    
      <li class="post">
        <a href="/2011/08/01/backchat-developers/">work for backchat</a>
      </li>
    
      <li class="post">
        <a href="/2010/09/30/radical-language-and-platform-shift/">Radical language and platform shift</a>
      </li>
    
      <li class="post">
        <a href="/2010/03/12/video-of-fosdem-ironruby-presentation/">Video of FOSDEM IronRuby presentation</a>
      </li>
    
      <li class="post">
        <a href="/2009/12/01/adding-a-console-to-your-ironruby-application/">Adding a console to your IronRuby application</a>
      </li>
    
  </ul>
</section>

<section>
  <h1>GitHub Repos</h1>
  <ul id="gh_repos">
    <li class="loading">Status updating...</li>
  </ul>
  
  <a href="https://github.com/casualjim">@casualjim</a> on GitHub
  
  <script type="text/javascript">
    $.domReady(function(){
        if (!window.jXHR){
            var jxhr = document.createElement('script');
            jxhr.type = 'text/javascript';
            jxhr.src = '/javascripts/libs/jXHR.js';
            var s = document.getElementsByTagName('script')[0];
            s.parentNode.insertBefore(jxhr, s);
        }

        github.showRepos({
            user: 'casualjim',
            count: 0,
            skip_forks: true,
            target: '#gh_repos'
        });
    });
  </script>
  <script src="/javascripts/github.js" type="text/javascript"> </script>
</section>


<section>
  <h1>Latest Tweets</h1>
  <ul id="tweets">
    <li class="loading">Status updating...</li>
  </ul>
  <script type="text/javascript">
    $.domReady(function(){
      getTwitterFeed("casualjim", 4, false);
    });
  </script>
  <script src="/javascripts/twitter.js" type="text/javascript"> </script>
  
    <a href="http://twitter.com/casualjim" class="twitter-follow-button" data-show-count="false">Follow @casualjim</a>
  
</section>


<section>
  <h1>On Delicious</h1>
  <div id="delicious"></div>
  <script type="text/javascript" src="http://feeds.delicious.com/v2/json/casualjim?count=3&amp;sort=date&amp;callback=renderDeliciousLinks"></script>
  <p><a href="http://delicious.com/casualjim">My Delicious Bookmarks &raquo;</a></p>
</section>


<section class="googleplus">
  <h1>
    <a href="https://plus.google.com/106536131996809745163?rel=author">
      <img src="http://www.google.com/images/icons/ui/gprofile_button-32.png" width="32" height="32">
      Google+
    </a>
  </h1>
</section>



  
</aside>


    </div>
  </div>
  <footer role="contentinfo"><p>
  Copyright &copy; 2012 - Ivan Porto Carrero -
  <span class="credit">Powered by <a href="http://octopress.org">Octopress</a></span>
</p>

</footer>
  

<script type="text/javascript">
      var disqus_shortname = 'casualjim';
      
        
        var disqus_script = 'count.js';
      
    (function () {
      var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
      dsq.src = 'http://' + disqus_shortname + '.disqus.com/' + disqus_script;
      (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
    }());
</script>



<div id="fb-root"></div>
<script>(function(d, s, id) {
  var js, fjs = d.getElementsByTagName(s)[0];
  if (d.getElementById(id)) {return;}
  js = d.createElement(s); js.id = id;
  js.src = "//connect.facebook.net/en_US/all.js#appId=212934732101925&xfbml=1";
  fjs.parentNode.insertBefore(js, fjs);
}(document, 'script', 'facebook-jssdk'));</script>



  <script type="text/javascript">
    (function() {
      var script = document.createElement('script'); script.type = 'text/javascript'; script.async = true;
      script.src = 'https://apis.google.com/js/plusone.js';
      var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(script, s);
    })();
  </script>



  <script type="text/javascript">
    (function(){
      var twitterWidgets = document.createElement('script');
      twitterWidgets.type = 'text/javascript';
      twitterWidgets.async = true;
      twitterWidgets.src = 'http://platform.twitter.com/widgets.js';
      document.getElementsByTagName('head')[0].appendChild(twitterWidgets);
    })();
  </script>





</body>
</html>
