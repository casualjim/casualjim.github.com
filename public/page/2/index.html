
<!DOCTYPE html>
<!--[if lt IE 7 ]><html class="ie ie6" lang="en"> <![endif]-->
<!--[if IE 7 ]><html class="ie ie7" lang="en"> <![endif]-->
<!--[if IE 8 ]><html class="ie ie8" lang="en"> <![endif]-->
<!--[if (gte IE 9)|!(IE)]><!--><html lang="en"> <!--<![endif]-->
<head>

  <meta charset="utf-8">
  <title>Ivan Porto Carrero</title>
  <meta name="author" content="Ivan Porto Carrero">

  
  <meta name="description" content="Yesterday I explained about caricature but I didn’t have it fully tested yet. Today I’ve written a bunch of integration specs for all the platform &hellip;">
  

  <!--[if lt IE 9]>
    <script src="http://html5shim.googlecode.com/svn/trunk/html5.js"></script>
  <![endif]-->

  <!-- http://t.co/dKP3o1e -->
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
  
  <link rel="canonical" href="http://flanders.co.nz/page/2">
  <link href="/favicon.png" rel="icon">
  <link href="/css/base.css" rel="stylesheet" type="text/css">
  <link href="/css/skeleton.css" rel="stylesheet" type="text/css">
  <link href="/css/syntax.css" rel="stylesheet" type="text/css">
  <link href="/css/style.css" rel="stylesheet" type="text/css">
  <link href="/css/skins/blue.css" rel="stylesheet" type="text/css">

  <link rel="shortcut icon" href="/images/favicon.ico">
  <link rel="apple-touch-icon" href="/images/apple-touch-icon.png">
  <link rel="apple-touch-icon" sizes="72x72" href="/images/apple-touch-icon-72x72.png">
  <link rel="apple-touch-icon" sizes="114x114" href="/images/apple-touch-icon-114x114.png">

  <script src="/js/jquery-1.7.1.min.js" type="text/javascript"></script>  
  <script src="/js/modernizr.js" type="text/javascript"></script>
  <script src="/js/jquery.easing.1.3.js" type="text/javascript"></script>
  <script type="text/javascript" src="/js/jquery.illuminate.0.7.min.js"></script>
  <!-- tweet -->
  <script type="text/javascript" src="/js/tweet/twitter.js"></script>
  <script type="text/javascript" src="/js/tweet/setting.js"></script>
  
  <script type="text/javascript" src="/js/custom.js"></script>
  <link href="/atom.xml" rel="alternate" title="Ivan Porto Carrero" type="application/atom+xml">
  <!--Fonts from Google"s Web font directory at http://google.com/webfonts -->
<link href="http://fonts.googleapis.com/css?family=PT+Serif:regular,italic,bold,bolditalic" rel="stylesheet" type="text/css">
<link href="http://fonts.googleapis.com/css?family=PT+Sans:regular,italic,bold,bolditalic" rel="stylesheet" type="text/css">

  
  <script type="text/javascript">
    var _gaq = _gaq || [];
    _gaq.push(['_setAccount', 'UA-240612-3']);
    _gaq.push(['_trackPageview']);

    (function() {
      var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
      ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
      var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
    })();
  </script>


</head>

<body >
  <div id="wrapper">
    <header role="banner"> <div class="container">
    <div class="row clearfix">
      <hdgroup>
        <div class="four columns">
          <div class="logo">
            <img src="/images/logo.png" alt="" />
            <h2>Rants &amp; ramblings</h2>
          </div>  
        </div>
      </hdgroup>
      <nav role="navigation"><!-- <ul class="subscription" data-subscription="rss">
  <li><a href="/atom.xml" rel="subscribe-rss" title="subscribe via RSS">RSS</a></li>
  
</ul>
  
<form action="http://google.com/search" method="get">
  <fieldset role="search">
    <input type="hidden" name="q" value="site:flanders.co.nz" />
    <input class="search" type="text" name="q" results="0" placeholder="Search"/>
  </fieldset>
</form>
   -->
<ul>
  <li>
    <a href="/">Home
      <span>Homepage</span>
    </a>    
  </li>
  <li>
    <a href="/archives">Archives
      <span>Articles</span>
    </a>    
  </li>
  <li>
    <a href="/projects">Projects
      <span>Open-Source</span>
    </a>    
  </li>
  <li>
    <a href="/about">About me
      <span>Introduction</span>
    </a>    
  </li>
</ul>
</nav>

    </div>
  </div>  
<!-- <hgroup>
  <h1><a href="/">Ivan Porto Carrero</a></h1>
  
    <h2>IO(thoughts) foreach (_.propagandize)</h2>
  
</hgroup>
 -->
</header>
    <div class="container bodycontent">
      <div class="row clearfix">
        <div class="sixteen columns headline">
          <h2>Ivan Porto Carrero</h2>
          <p class="italic">IO(thoughts) foreach (_.propagandize)</p>
        </div>
      </div>  

      <div class="sixteen columns">
        <div class="divider row"></div>
      </div>  
      
      <!-- start of row -->
      <div class="row clearfix">
        <div class="sixteen columns">
          <!-- twitter feed -->
          <div class="twitter_feed">
            <ul class="tweet_list"></ul>
          </div>
        </div>
      </div>  
      <div class="sixteen columns">
        <div class="divider row"></div>
      </div>  
      
      <div id="maincontent" class="clearfix">
        <div class="five columns">  
  <aside class="left-sidebar">
    
        
<div class="widget row">
  <h5>Search form</h5>  
  <div id="search-form">
    <form action="http://google.com/search" method="get">
      <fieldset role="search">
        <input type="hidden" name="q" value="site:flanders.co.nz" />
        <input id="search-box" type="text" name="q" results="0" placeholder="Search"/>
        <input type="submit" value="Search" id="search-button" />
        <div class="clear"></div>
      </fieldset>
    </form>
  </div>
</div>
   <section>
  <div class="widget row">
    <h5>Recent Posts</h5>  
    <ul id="recent_posts">
      
        <li class="post">
          <a href="/2011/08/01/backchat-developers/">work for backchat</a>
        </li>
      
        <li class="post">
          <a href="/2010/09/30/radical-language-and-platform-shift/">Radical language and platform shift</a>
        </li>
      
        <li class="post">
          <a href="/2010/03/12/video-of-fosdem-ironruby-presentation/">Video of FOSDEM IronRuby presentation</a>
        </li>
      
        <li class="post">
          <a href="/2009/12/01/adding-a-console-to-your-ironruby-application/">Adding a console to your IronRuby application</a>
        </li>
      
        <li class="post">
          <a href="/2009/11/08/a-good-url-regular-expression-repost/">A good url regular expression? (repost)</a>
        </li>
      
    </ul>
  </div>
</section>

<section>
  <div class="widget row">
    <h5>GitHub Repos</h5>
    <ul id="gh_repos">
      <li class="loading">Status updating&#8230;</li>
    </ul>
    
    <a href="https://github.com/casualjim">@casualjim</a> on GitHub
    
  </div>
  <script type="text/javascript">
    $(document).ready(function(){
        github.showRepos({ user: "casualjim", target: $("#gh_repos"), forks: false, count: 5});
    });
  </script>
</section>


<section>
  <div class="widget row">
    <h5>Latest Tweets</h5>
    <ul id="tweets">
      <li class="loading">Status updating&#8230;</li>
    </ul>
    <script type="text/javascript">
      $(document).ready(function(){
        // getTwitterFeed("casualjim", 4, false);
      });
    </script>
    
      <a href="http://twitter.com/casualjim" class="twitter-follow-button" data-show-count="false">Follow @casualjim</a>
    
  </div>
</section>


<section>
  <div class="widget row">
    <h5>On Delicious</h5>
    <div id="delicious"></div>
    <script type="text/javascript" src="http://feeds.delicious.com/v2/json/casualjim?count=3&amp;sort=date&amp;callback=renderDeliciousLinks"></script>
    <p><a href="http://delicious.com/casualjim">My Delicious Bookmarks &raquo;</a></p>
  </div>
</section>


<section class="googleplus">
  <div class="widget row">
    <h5>
      <a href="https://plus.google.com/106536131996809745163?rel=author">
        <img src="http://www.google.com/images/icons/ui/gprofile_button-32.png" width="32" height="32">
        Google+
      </a>
    </h5>
  </div>
</section>



    
  </aside>
</div>
<div class="eleven columns">
<div class="blog-index">
  
  
  
    <article class="blogpost row">
      
  <div class="post-heading"> 
    



    <p class="date">15</p>  
    <div class="month-year"><p><span>May</span><br />2009</p></div>



    
      <div class="post-title">
        <h5>
          <a href="/2009/05/15/an-update-on-caricature/" title="">An Update on Caricature</a>
        </h5>
      </div> 
    
    <div class="clear"></div>
  </div>
  <!-- end of post heading -->
  
  <!-- start of post meta -->
  <div class="post-meta">
    <p>
       
  

<span class="byline author vcard">Posted by <span class="fn">Ivan Porto Carrero</span></span>

       
     </p>  
  </div>
  <!-- end of post meta -->
  


  <div class="entry-content"><p>Yesterday I explained about caricature but I didn’t have it fully tested yet. Today I’ve written a bunch of integration specs for all the platform combinations Caricature currently supports so you should be able to use Caricature also for plain ruby object mocking in addition to CLR interop mocking.</p>

<p>After having a very brief twitter discussion with Scott I decided it would be a good idea to change the name of the methods <em>when_told_to</em> and <em>was_told_to?</em> . In ruby objects receive messages so the wording now becomes <em>when_receiving</em> and <em>did_receive? </em>. I have a problem with the should naming because there is nothing conditional about it. Either you want the method to return something or you want it to return a default value for CLR value types or nil. And if you’re asserting if a method it called that is deterministic; it is either called or not there is no gray area there.</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
</pre></td><td class='code'><pre><code class='ruby'><span class='line'><span class="n">ninja</span> <span class="o">=</span> <span class="no">ClrModels</span><span class="o">::</span><span class="no">Ninja</span><span class="o">.</span><span class="n">new</span>
</span><span class='line'>
</span><span class='line'><span class="vi">@weapon</span><span class="o">.</span><span class="n">when_receiving</span><span class="p">(</span><span class="ss">:attack</span><span class="p">)</span><span class="o">.</span><span class="n">with</span><span class="p">(</span><span class="n">ninja</span><span class="p">)</span><span class="o">.</span><span class="n">return</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span>
</span><span class='line'>
</span><span class='line'><span class="vi">@ninja</span><span class="o">.</span><span class="n">attack</span><span class="p">(</span><span class="n">ninja</span><span class="p">,</span> <span class="vi">@weapon</span><span class="p">)</span><span class="o">.</span><span class="n">should</span><span class="o">.</span><span class="n">equal</span> <span class="mi">5</span>
</span><span class='line'>
</span><span class='line'><span class="vi">@weapon</span><span class="o">.</span><span class="n">did_receive?</span><span class="p">(</span><span class="ss">:attack</span><span class="p">)</span><span class="o">.</span><span class="n">with</span><span class="p">(</span><span class="ss">:any</span><span class="p">)</span><span class="o">.</span><span class="n">should</span><span class="o">.</span><span class="n">be</span><span class="o">.</span><span class="n">successful</span>
</span></code></pre></td></tr></table></div></figure>


<p>Before I call it 1.0 I want to at least give ruby objects also the ability to isolate static and sealed methods as well as mocking ruby class methods. So that for CLR to Ruby interaction you a get the full range of possibilities.</p>

<p>I have also <a href="http://casualjim.github.com/caricature/Caricature.html">set up a site on github</a> that contains the API documentation for Caricature. When IronRuby 0.5 releases I’ll publish a blog post that will talk you through testing your CLR assembly with IronRuby, bacon and Caricature.</p>

<p>For now you can take a look <a href="http://github.com/casualjim/caricature/blob/7ab1d513be74b26c95a1ca34cc1d01f6c850cc43/spec/integration_spec.rb">here</a> for example on how to use Caricature for isolating features.</p>
</div>
  
  


    </article>
    <!-- divider for blog post -->
    <div class="divider"></div>
  
  
    <article class="blogpost row">
      
  <div class="post-heading"> 
    



    <p class="date">14</p>  
    <div class="month-year"><p><span>May</span><br />2009</p></div>



    
      <div class="post-title">
        <h5>
          <a href="/2009/05/14/ironruby-just-got-a-mocking-framework-kind-of/" title="">IronRuby Just Got a Mocking Framework – Kind Of</a>
        </h5>
      </div> 
    
    <div class="clear"></div>
  </div>
  <!-- end of post heading -->
  
  <!-- start of post meta -->
  <div class="post-meta">
    <p>
       
  

<span class="byline author vcard">Posted by <span class="fn">Ivan Porto Carrero</span></span>

       
     </p>  
  </div>
  <!-- end of post meta -->
  


  <div class="entry-content"><p>As I mentioned in a previous <a href="http://flanders.co.nz/2009/05/03/mocking-for-ironruby/">post</a>. I started working on a small mocking framework. It has now progressed far enough to handle the most common mocking tasks.</p>

<p>Below I pasted the output of the integration tests for CLR interop.</p>

<pre><code>when isolating CLR interfaces        
- should work without expectations         
- should work with an expectation with any arguments         
- should work with an expectation getting different method call result         
- should work for an assertion on a specific argument 

when isolating CLR classes        
- should work without expectations         
- should work with an expectation for any arguments         
- should work with an assertion for specific arguments         
- should fail for an assertion with wrong arguments 

when isolating CLR instances        
- should work without expectations         
- should work with an expectation for any arguments         
- should fail for an assertion for specific arguments         
- should allow to delegate the method call to the real instance (partial mock)
</code></pre>

<p>you will need bacon installed to run the specs:</p>

<p>  igem install bacon</p>

<p>you can then install the caricature gem in ironruby by issueing</p>

<p>  igem install caricature</p>

<p>To use it there are some examples in the file spec/integration_spec.rb</p>

<figure class='code'><figcaption><span>spec/integration_spec.rb </span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
</pre></td><td class='code'><pre><code class='ruby'><span class='line'><span class="nb">require</span> <span class="s1">&#39;rubygems&#39;</span>
</span><span class='line'><span class="nb">require</span> <span class="s1">&#39;bacon&#39;</span>
</span><span class='line'><span class="nb">require</span> <span class="s1">&#39;caricature&#39;</span>
</span><span class='line'>
</span><span class='line'><span class="n">ninja</span><span class="o">.</span><span class="n">when_told_to</span><span class="p">(</span><span class="ss">:survive_attack_with</span><span class="p">)</span><span class="o">.</span><span class="n">return</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span>
</span><span class='line'>
</span><span class='line'><span class="n">weapon</span><span class="o">.</span><span class="n">attack</span><span class="p">(</span><span class="n">ninja</span><span class="p">)</span><span class="o">.</span><span class="n">should</span><span class="o">.</span><span class="n">equal</span> <span class="mi">5</span>
</span><span class='line'>
</span><span class='line'><span class="n">ninja</span><span class="o">.</span><span class="n">was_told_to?</span><span class="p">(</span><span class="ss">:survive_attack_with</span><span class="p">)</span><span class="o">.</span><span class="n">with</span><span class="p">(</span><span class="ss">:any</span><span class="p">)</span><span class="o">.</span><span class="n">should</span><span class="o">.</span><span class="n">be</span><span class="o">.</span><span class="n">successful</span>
</span></code></pre></td></tr></table></div></figure>


<p></p>

<p>There is a gotcha though, when you use it in a CLR class you&#8217;re bound to CLR rules and it only overrides the methods that are marked as virtual. We also can&#8217;t isolate static or sealed types at the moment.</p>

<p>I took the approach of doing away with the terminology of mocking and subbing and instead chose the much clearer Isolation. By default any method returns null or the default value of a value type. You can tell an isolation to return a specific value or raise an error etc. Later on you can then assert if the method was actually called.</p>

<p>This fits in better with the way you probably structure your tests.</p>

<p>I hope you like it.</p>

<p>You can find the source in my github account.</p>

<p><a href="http://github.com/casualjim/caricature">http://github.com/casualjim/caricature</a></p>
</div>
  
  


    </article>
    <!-- divider for blog post -->
    <div class="divider"></div>
  
  
    <article class="blogpost row">
      
  <div class="post-heading"> 
    



    <p class="date">11</p>  
    <div class="month-year"><p><span>May</span><br />2009</p></div>



    
      <div class="post-title">
        <h5>
          <a href="/2009/05/11/joined-the-lounge-network/" title="">Joined the Lounge Network</a>
        </h5>
      </div> 
    
    <div class="clear"></div>
  </div>
  <!-- end of post heading -->
  
  <!-- start of post meta -->
  <div class="post-meta">
    <p>
       
  

<span class="byline author vcard">Posted by <span class="fn">Ivan Porto Carrero</span></span>

       
     </p>  
  </div>
  <!-- end of post meta -->
  


  <div class="entry-content"><p>Today I received my invitation to the <a href="http://thelounge.net">Lounge</a> network. I just finished changing my homepage to include their ads in my side bar.    <br/>
My reasons for joining the ad network are that on one hand I’ve been an ad-sense member for a really long time and although I’ve had ads on multiple sites it never actually made me any money. Eventually I gave up on putting those ads on my blog. So I’m not really doing it to make any money of this blog, but if it takes a small bite out of my hosting bill I’ll be a happy man :).</p>

<p>The ads that are run by the lounge are .net centric and are a much better fit to the audience of this blog. It even may be helpful to somebody at times.</p>

<p>Let’s see how this works out.</p>
</div>
  
  


    </article>
    <!-- divider for blog post -->
    <div class="divider"></div>
  
  
    <article class="blogpost row">
      
  <div class="post-heading"> 
    



    <p class="date">03</p>  
    <div class="month-year"><p><span>May</span><br />2009</p></div>



    
      <div class="post-title">
        <h5>
          <a href="/2009/05/03/mocking-for-ironruby/" title="">Mocking for IronRuby</a>
        </h5>
      </div> 
    
    <div class="clear"></div>
  </div>
  <!-- end of post heading -->
  
  <!-- start of post meta -->
  <div class="post-meta">
    <p>
       
  

<span class="byline author vcard">Posted by <span class="fn">Ivan Porto Carrero</span></span>

       
     </p>  
  </div>
  <!-- end of post meta -->
  


  <div class="entry-content"><p>As you may or may not know I’m in the process of building IronRubyMvc. At one point I did write a bunch of tests in for the code I had at that point. However that test code was written in C# with xunit and moq. I wasn’t too happy about that so I deferred writing tests to a later date when I could use a Ruby library to write them.</p>

<p>That time has come, I can use bacon and it’s acceptable performance wise now, not stellar but workable. So when I started to port some of my previously written tests to bacon I ran into a road block. Mocking isn’t as straightforward as my optimistic self was expecting. This lead me to think about what exactly does a mocking framework do?</p>

<p>I’m pretty much a just stuff no fluff kind of guy when it comes to coding. So I tend to choose for solutions that have just the right amount of features and virtually no whistles and bells. I generally blame it on being slightly stupid so I can’t grok intensely complex solutions. Once you cross a treshold there is no way in hell I will ever look at it again.</p>

<p>Anyway the no fluff approach to mocking would be to look at the core responsibilities of those frameworks, which are 2 as far as I can tell.</p>

<ol>
<li>Generate a proxy for an object so you can intercept method calls</li>
<li>Allow for verificatons of those intercepted method calls to do things like how many times was this method called, was it called at all etc.</li>
</ol>


<p>So I’m starting to implement a way to generate proxies today.. This should be a piece of cake with Ruby :) Then I’ll look at implementing some constraints and verifications.</p>

<p>Thinking about how to approach the API for defining the mocks has also been an interesting experience. From the get-go a Record/Replay/Verify model is out. But then it comes to the following part, when do you define the verifications.</p>

<p>Do you do that in the assertion fase, thus stubbing everything beforehand and just allowing the user to define return values when establishing the test context. Or do you define the verification (at least twice, ignore arguments etc) when you establish the test context. My vote goes to the first option.</p>

<p>So a new project is born it’s called caricature and lives on github. Which will try to implement the ideas set forward in this blog post for <a href="http://ironruby.net">IronRuby</a>.</p>

<p><a href="http://github.com/casualjim/caricature">http://github.com/casualjim/caricature</a></p>

<p>Technorati Tags: <a href="http://technorati.com/tags/IronRuby">IronRuby</a>,<a href="http://technorati.com/tags/Mocking">Mocking</a></p>
</div>
  
  


    </article>
    <!-- divider for blog post -->
    <div class="divider"></div>
  
  
    <article class="blogpost row">
      
  <div class="post-heading"> 
    



    <p class="date">02</p>  
    <div class="month-year"><p><span>May</span><br />2009</p></div>



    
      <div class="post-title">
        <h5>
          <a href="/2009/05/02/using-ironruby-with-rubymine/" title="">Using IronRuby With RubyMine</a>
        </h5>
      </div> 
    
    <div class="clear"></div>
  </div>
  <!-- end of post heading -->
  
  <!-- start of post meta -->
  <div class="post-meta">
    <p>
       
  

<span class="byline author vcard">Posted by <span class="fn">Ivan Porto Carrero</span></span>

       
     </p>  
  </div>
  <!-- end of post meta -->
  


  <div class="entry-content"><p><a href="http://www.jetbrains.com/ruby/">RubyMine</a> was released earlier this week. I’ve used rubymine in the past and was very impressed with the IDE, so much that I’m silently hoping the guys from <a href="http://www.jetbrains.com/">Jetbrains</a> would do a C# IDE too. I’d probably buy that one as well, but for now I’ll settle for <a href="http://www.jetbrains.com/resharper">Resharper</a> with Visual studio.</p>

<p>By default Rubymine won’t accept <a href="http://ironruby.net">IronRuby</a> as a ruby SDK, but I asked for help in the twitterverse and got it (<a href="http://twitter.com/iRomeo/statuses/1677867948">http://twitter.com/iRomeo/statuses/1677867948</a>).</p>

<p><a href="http://flanders.co.nz/wp-content/uploads/2009/05/settings-rubymine.jpg"><img src="http://flanders.co.nz/wp-content/uploads/2009/05/settings-rubymine-thumb.jpg" alt="settings_rubymine" /></a></p>

<p>Just symlinking didn’t really work because the ruby.exe listens to &#8211;version for getting its version number.  IronRuby on the other hand listens to –v to get its version number.  The solution to that is to create a batch file that will translate the &#8211;version  modifier to –v.</p>

<p>So instead of symlinking the ir.exe to a name that starts with ruby I created a batch file called ruby_iron.cmd with the following content.</p>

<pre><code>@echo off
set IR_CMD="%~dp0ir.exe"
if "%1"=="--version" ( GOTO RUBY_VERSION )
GOTO RUBY
:RUBY_VERSION
%IR_CMD% -v
goto QUIT
:RUBY
%IR_CMD%
:QUIT
</code></pre>

<p>With that ruby_iron.cmd file in place you can just add IronRuby as an SDK in RubyMine.</p>

<p>Enjoy :)</p>
</div>
  
  


    </article>
    <!-- divider for blog post -->
    <div class="divider"></div>
  
  
    <article class="blogpost row">
      
  <div class="post-heading"> 
    



    <p class="date">08</p>  
    <div class="month-year"><p><span>Apr</span><br />2009</p></div>



    
      <div class="post-title">
        <h5>
          <a href="/2009/04/08/binder-for-ironruby-mvc/" title="">Binder for Ironruby Mvc</a>
        </h5>
      </div> 
    
    <div class="clear"></div>
  </div>
  <!-- end of post heading -->
  
  <!-- start of post meta -->
  <div class="post-meta">
    <p>
       
  

<span class="byline author vcard">Posted by <span class="fn">Ivan Porto Carrero</span></span>

       
     </p>  
  </div>
  <!-- end of post meta -->
  


  <div class="entry-content"><p>I’ve progressed far enough with <a href="http://ironruby.net">IronRuby</a> MVC to start thinking about a sample and I’ve decided to write 2 separate samples both on the same technologies. As an OR/M I will be using <a href="http://www.mindscape.co.nz/products/LightSpeed/default.aspx">LightSpeed</a> from Mindscape, just because it’s an awesome piece of technology.</p>

<p>At this moment I’m looking at creating a binder for objects that takes a hash as input. The default model binder of ASP.NET MVC doesn’t quite fit all that well with the ironruby implementation so I’m creating a ruby binder implementation. This stuff is just something that makes ruby shine.</p>

<p>While doing so I came up with this little tidbit of code:</p>

<pre><code>class System::Object

  class &lt;&lt; self

    def create_from_hash(options)
      result = self.new
      result.populate_from_hash options
      result
    end

  end

  def populate_from_hash(options)
    options.each do |k, v|
      mn = "#{k}=".to_sym
      self.send(mn, v) if self.respond_to?(mn)
    end
  end
end
</code></pre>

<p>This code allows you to populate any .NET object from a hash.</p>

<p>So doing Person.create_from_hash(:username => “joe”) would create a user instance with the property username set to joe.</p>

<p>You do need to provide a hash where the values have the correct type.</p>

<p>Technorati Tags: <a href="http://technorati.com/tags/IronRuby+MVC">IronRuby MVC</a>,<a href="http://technorati.com/tags/IronRuby">IronRuby</a></p>
</div>
  
  


    </article>
    <!-- divider for blog post -->
    <div class="divider"></div>
  
  
    <article class="blogpost row">
      
  <div class="post-heading"> 
    



    <p class="date">21</p>  
    <div class="month-year"><p><span>Mar</span><br />2009</p></div>



    
      <div class="post-title">
        <h5>
          <a href="/2009/03/21/gitgithub-survival-guide/" title="">Git/Github Survival Guide</a>
        </h5>
      </div> 
    
    <div class="clear"></div>
  </div>
  <!-- end of post heading -->
  
  <!-- start of post meta -->
  <div class="post-meta">
    <p>
       
  

<span class="byline author vcard">Posted by <span class="fn">Ivan Porto Carrero</span></span>

       
     </p>  
  </div>
  <!-- end of post meta -->
  


  <div class="entry-content"><p>Lately I’ve been helping a few people to get started on <a href="http://github.com">Github</a>. I use git at the command line and my survival guide is also based on that way of interacting with <a href="http://git-scm.com/">Git</a>. So I thought I’d write the procedure up so that I can just point people to this page.</p>

<p>The first tip I can give you and most of what I’ll be talking about is in the <a href="http://github.com/guides/home">guides</a> from github. When you’re used to Subversion or Team Foundation Server for example you’ll need to make a mental leap. That leap would be to realise that your local copy <em>is</em> the master copy for you. The remote server like github.com is one is a little bit like an afterthought. I think it goes a little bit like this: “O cool I’ve built this really cool thing here and I’ve got it in this git repository on my machine. It would be cool if other people also had access. Wait a minute, I’ll just add a remote and push my stuff onto that server.” Problem solved.</p>

<p>Most of this guide applies to both windows and *nix systems except for the next part because that will describe the install parameters for getting msysgit to behave nicely on your system.</p>

<p>==== Windows only ====</p>

<p>If you’re on windows I suggest you use <a href="http://code.google.com/p/msysgit">msysgit</a> as your git client. You can probably use everything I’m about to explain from explorer too if you want to use <a href="http://code.google.com/p/tortoisegit/">tortoisegit</a> or just prefer gui’s. I, personally, like having options so I’ll probably use a mix of those in the future. Ok onto the install procedure.</p>

<p>Somewhere half-way through the install of msysgit it will ask you how far you want to integrate it. The correct choice is the middle one: Run Git from the Windows Command Prompt. For generating ssh keys etc you probably want to use OpenSSH.</p>

<p>==== Windows only end ====</p>

<p>When the install of msysgit is completed it is time to start configuring your git install for usage with github. The first step you need to take is to tell git your username and email address. You will also need your API token that you can find on your <a href="http://github.com/account">account page</a>.</p>

<pre><code>[~]$ git config --global user.name &lt;span class="str"&gt;"Ivan Porto Carrero"&lt;/span&gt;
[~]$ git config --global user.email ivan@nowhere.com
[~]$ git config --global github.user casualjim
[~]$ git config --global github.token [[API TOKEN]]
</code></pre>

<p>This information can be found in the github guides: <a href="http://github.com/guides/tell-git-your-user-name-and-email-address">http://github.com/guides/tell-git-your-user-name-and-email-address</a>. The configuration above is global but you can still override that on a per project basis.</p>

<p>Now that git knows how to deal with github it is time to formally introduce your machine to the github server. To do so you might have to create an ssh key private/public keypair. A tip I can give you before you start the creation is that you probably don’t want to type a password everytime you push to github. So when you create your ssh key don’t use a passphrase (leave it blank when asked for one).</p>

<p>The procedure on how to create the ssh keys can againn be found in the github guides: <a href="http://github.com/guides/providing-your-ssh-key">http://github.com/guides/providing-your-ssh-key</a>. On windows I would suggest that you use the openssh one. I use RSA keys but you can choose whichever flavor you want of course :) After generating the ssh keys you need to provide them to github in your <a href="http://github.com/account">account page</a>.</p>

<p>This should get you up and running with github. I’m assuming most people coming to github are familiar with subversion so I’ll try to map some common operations to the command sequence you need in git.</p>

<p>First things first I have a couple of aliases defined for some common operations.</p>

<p>You can just copy paste the aiases section below in the .gitconfig file that you can find in the root of your personal folder. C:\users\ivan.gitconfig on vista for me and ~/.gitconfig in bash.</p>

<pre><code>[alias]
    ci = commit
    st = status
    co = checkout
</code></pre>

<p>If all you need is read-only access to a repository you can just clone a repository by its public clone url ie. git clone git://github.com/casualjim/ironrubymvc.git</p>

<p>The first operation you’ll need is how to get source code, make changes and send in a patch. In git lingo this is called forking.</p>

<p>On github you fork the project you want to make changes too. Then you clone that project on your local machine and make your changes. You then push your changes back to your repository and send a pull request to the original project. That is all you need to do to send in a patch, issue a pull request.</p>

<p>I forked ironrubymvc from Jimmy Schementi and send him pull requests regularly when I’ve completed a chunk of work on it. so here’s the sequence of commands I use to do this.</p>

<p><em><strong>git clone </strong></em><a href="mailto:git@github.com:casualjim/ironrubymvc.git"><em><strong>git@github.com:casualjim/ironrubymvc.git</strong></em></a></p>

<p>… make some changes …</p>

<p>To start updating the repository with my changes I’ll generally first ask for a status to see if I need to add some files to ignore and if there are new files that need te be included</p>

<p><em><strong>git st </strong></em></p>

<p>If there are files that need to be ignored I’ll add them to the .gitignore file in my project root. If there are still some new files that need to be added:</p>

<p><strong><em>git add .</em></strong></p>

<p>Then I’m ready to commit the changes to my local repository:</p>

<p><em><strong>git ci –a –m “Made ironrubymvc do the dishes and ironing”</strong></em></p>

<p>Now it’s time to push my changes to the github server.</p>

<p><em><strong>git push</strong></em></p>

<p>And now I need to go to the github website and send a pull request to Jimmy. He can then decide if he wants to apply the patch or make some changes.</p>

<p>The next step is to keep your fork in sync with the forked repository, so that you can continue to pick up their changes and ensure that your changes still work.</p>

<p><em><strong>git remote add upstream git://github.com/jschementi/ironrubymvc.git</strong></em></p>

<p>to automatically fetch and then merge the changes from the upstream repository you can pull from it. You have to tell pull the remote source it has to pull from and the target branch.</p>

<p><strong><em>git pull upstream master</em></strong></p>

<p>A more detailed explanation of this process can be found in the github guides. <a href="http://github.com/guides/fork-a-project-and-submit-your-modifications">http://github.com/guides/fork-a-project-and-submit-your-modifications</a></p>

<p>The next thing we’re going to map is svn:externals. In git this is called submodules. They have a great explanation off that in the github guides <a href="http://github.com/guides/developing-with-submodules">http://github.com/guides/developing-with-submodules</a></p>

<p>Suppose you made some changes and they aren’t really what you want and you want to restore the repository to the last commit.</p>

<p><strong><em>git reset &#8211;hard</em></strong></p>

<p>The last topic is branching and merging changes etc. As an example I will take the <a href="http://ironruby.net">IronRuby</a> project for which Michael Letterle and myself maintain the linux branch. This branch ensures that IronRuby gets the fixes it needs to compile on mono. A typical workflow for me when I sync it with the source repository @ git://github.com/ironruby/ironruby.git from the ironruby project root on my local machine.</p>

<p>Previously I did:</p>

<p><em><strong>git clone git@github.com:mletterle/ironruby.git</strong></em></p>

<p><em><strong>git remote add ironruby git://github.com/ironruby/ironruby.git</strong></em></p>

<p>And to create and track the remote linux branch I issued the following commands:</p>

<p><strong><em>git co –-track –b linux origin/linux</em></strong></p>

<p><strong><em>git pull</em></strong></p>

<p>This has now got my local copy set up with a linux branch and has pulled in the contents of the remote branch to my local repository.</p>

<p>When there are changes in the source repository I issue the following commands:</p>

<p><strong><em>git co master</em></strong> // Check out the master branch</p>

<p><strong><em>git pull ironruby master</em></strong> // Pull in changes from remote</p>

<p><strong><em>git co linux</em></strong> // Check out the linux branch</p>

<p><strong><em>git merge master</em></strong> // Merge in the changes from the master branch</p>

<p><strong><em>mate .</em></strong> // Open textmate to resolve conflicts</p>

<p><strong><em>git add .</em></strong> // Add the files with the resolved conflicts back to the repository</p>

<p><strong><em>git ci –a –m “Synced with upstream”</em></strong> // submit changes</p>

<p><strong><em>git push</em></strong> // update the github server</p>

<p>The information above can be found in the github guides as well but in several places:</p>

<p><a href="http://github.com/guides/git-cheat-sheet">http://github.com/guides/git-cheat-sheet</a></p>

<p><a href="http://github.com/guides/showing-and-tracking-remote-branches">http://github.com/guides/showing-and-tracking-remote-branches</a></p>

<p><a href="http://github.com/guides/push-a-branch-to-github">http://github.com/guides/push-a-branch-to-github</a></p>

<p><a href="http://github.com/guides/keeping-a-git-fork-in-sync-with-the-forked-repo">http://github.com/guides/keeping-a-git-fork-in-sync-with-the-forked-repo</a></p>

<p><a href="http://beans.seartipy.com/2008/12/09/setting-up-ruby-on-rails-projects-with-git-and-github/">http://beans.seartipy.com/2008/12/09/setting-up-ruby-on-rails-projects-with-git-and-github/</a></p>

<p>Those are the commands I use about 95% of the time when I’m working with git. I thought they might be useful to other people hence the share.</p>

<p>If you combine the above with my previous post on how to git-enable your command-line <a href="http://flanders.co.nz/2009/03/19/pimp-your-command-line-for-git/">http://flanders.co.nz/2009/03/19/pimp-your-command-line-for-git/</a> . I guess you’ve got a pretty sweet setup.</p>

<p><strong>There is one gotcha that I’d like to repeat one more time. When you’re branching you have to close the solution in visual studio or all kinds of nastiness will ensue. Visual studio will lock some files and if git wants to remove them it can’t. This results in a branch that is probably messed up.</strong></p>

<p><a href="http://www.dotnetkicks.com/kick/?url=http%3a%2f%2fflanders.co.nz%2f2009%2f03%2f21%2fgitgithub-survival-guide%2f"><img src="http://www.dotnetkicks.com/Services/Images/KickItImageGenerator.ashx?url=http%3a%2f%2fflanders.co.nz%2f2009%2f03%2f21%2fgitgithub-survival-guide%2f" alt="kick it on DotNetKicks.com" /></a></p>

<p>Technorati Tags: <a href="http://technorati.com/tags/git">git</a>,<a href="http://technorati.com/tags/github">github</a>,<a href="http://technorati.com/tags/cheat+sheet">cheat sheet</a></p>
</div>
  
  


    </article>
    <!-- divider for blog post -->
    <div class="divider"></div>
  
  
    <article class="blogpost row">
      
  <div class="post-heading"> 
    



    <p class="date">19</p>  
    <div class="month-year"><p><span>Mar</span><br />2009</p></div>



    
      <div class="post-title">
        <h5>
          <a href="/2009/03/19/pimp-your-command-line-for-git/" title="">Pimp Your Command-line for Git</a>
        </h5>
      </div> 
    
    <div class="clear"></div>
  </div>
  <!-- end of post heading -->
  
  <!-- start of post meta -->
  <div class="post-meta">
    <p>
       
  

<span class="byline author vcard">Posted by <span class="fn">Ivan Porto Carrero</span></span>

       
     </p>  
  </div>
  <!-- end of post meta -->
  


  <div class="entry-content"><p>I do development on both the Mac and windows. I prefer to use git as my source control these days and have done so for the past year or so. Git is great, I love it. I love the ease of branching a lot too. I’ll often just branch of locally just to play around with an idea without affecting the master branch.</p>

<p>But having many branches can be confusing at times, especially in my case as I can only remember what I was doing for 5 seconds. So sometimes I mess up a perfectly good branch because of the confusion.</p>

<p>On windows I use Powershell as my command-line. I don’t know much of powershell scripting. To be honest I mainly started using it because then I wouldn’t constantly get an error when I typed ls instead of dir :) However since then I did explore that environment a little and it <em>does</em> give me easy access to the CLR and a way to create very very powerful batch files, although I do most of my scripting in Ruby these days. It also allows you to customize your prompt. You need to allow scripts unrestricted access for this to work. You can do that by entering Set-ExecutionPolicy Unrestricted at a powershell prompt. Then you close powershell and create a file in %MYDOCUMENTS%\WindowsPowershell called profile.ps1</p>

<pre><code>&lt;span class="kwrd"&gt;function&lt;/span&gt; prompt





{





    $host.ui.rawui.WindowTitle = $(get-location)





    Write-Host (&lt;span class="str"&gt;"+ "&lt;/span&gt; + $(get-location)) -foregroundcolor Yellow











        $branches = &lt;span class="str"&gt;""&lt;/span&gt;





        git branch | &lt;span class="kwrd"&gt;foreach&lt;/span&gt; {





            &lt;span class="kwrd"&gt;if&lt;/span&gt;($_ &lt;span class="preproc"&gt;-match&lt;/span&gt; &lt;span class="str"&gt;"^\*\s(.*)"&lt;/span&gt;){





                $branches += $matches[1]





            }





        }





    &lt;span class="kwrd"&gt;if&lt;/span&gt;($branches){





        Write-Host (&lt;span class="str"&gt;"("&lt;/span&gt; + $branches + &lt;span class="str"&gt;") "&lt;/span&gt;) -nonewline -fore Cyan





    }

















    Write-Host (&lt;span class="str"&gt;"»"&lt;/span&gt;) -nonewline -foregroundcolor Green





    &lt;span class="kwrd"&gt;return&lt;/span&gt; &lt;span class="str"&gt;" "&lt;/span&gt;





}
</code></pre>

<p>The result of this prompt looks like this:</p>

<p><a href="http://flanders.co.nz/wp-content/uploads/2009/03/picture2.png"><img src="http://flanders.co.nz/wp-content/uploads/2009/03/picture2-thumb.png" alt="Picture 2" /></a></p>

<p>In bash I use a .bashrc script that shows me the branch in my prompt. You need ttycolors enabled to enjoy the full prompt but this is the section that takes care of my prompt.</p>

<pre><code>&lt;span class="kwrd"&gt;if&lt;/span&gt; [ -n &lt;span class="str"&gt;"$force_color_prompt"&lt;/span&gt; ]; then





    &lt;span class="kwrd"&gt;if&lt;/span&gt; [ -x /usr/bin/tput ] &amp;&amp; tput setaf 1 &gt;&amp;/dev/null; then





    &lt;span class="rem"&gt;# We have color support; assume it's compliant with Ecma-48&lt;/span&gt;





    &lt;span class="rem"&gt;# (ISO/IEC-6429). (Lack of such support is extremely rare, and such&lt;/span&gt;





    &lt;span class="rem"&gt;# a case would tend to support setf rather than setaf.)&lt;/span&gt;





    color_prompt=yes





    &lt;span class="kwrd"&gt;else&lt;/span&gt;





    color_prompt=





    fi





fi











parse_git_branch() {





  git branch 2&gt; /dev/null | sed -e &lt;span class="str"&gt;'/^[^*]/d'&lt;/span&gt; -e &lt;span class="str"&gt;'s/* \(.*\)/(\1)/'&lt;/span&gt;





}

















&lt;span class="rem"&gt;# export PS1='\e[0;32m+ \u @ \w\e[m\e[0;33m »\e[m '&lt;/span&gt;





&lt;span class="kwrd"&gt;if&lt;/span&gt; [ &lt;span class="str"&gt;"$color_prompt"&lt;/span&gt; = yes ]; then





    PS1=&lt;span class="str"&gt;"\[\033[01;36m\]+\u@\h\[\033[00m\]:\[\033[01;32m\]\w\[\033[00m\]\[\033[01;33m\]\n\$(parse_git_branch)»\[\033[00m\] "&lt;/span&gt;





&lt;span class="kwrd"&gt;else&lt;/span&gt;





  PS1=&lt;span class="str"&gt;"\u@\h:\w\$(parse_git_branch)\$ "&lt;/span&gt;





fi
</code></pre>

<p>The result of the bash script looks like this:</p>

<p><a href="http://flanders.co.nz/wp-content/uploads/2009/03/picture1.png"><img src="http://flanders.co.nz/wp-content/uploads/2009/03/picture1-thumb.png" alt="Picture 1" /></a></p>

<p><a href="http://www.dotnetkicks.com/kick/?url=http%3a%2f%2fflanders.co.nz%2f2009%2f03%2f19%2fpimp-your-command-line-for-git%2f"><img src="http://www.dotnetkicks.com/Services/Images/KickItImageGenerator.ashx?url=http%3a%2f%2fflanders.co.nz%2f2009%2f03%2f19%2fpimp-your-command-line-for-git%2f" alt="kick it on DotNetKicks.com" /></a></p>

<p>Technorati Tags: <a href="http://technorati.com/tags/Git">Git</a>,<a href="http://technorati.com/tags/Powershell">Powershell</a>,<a href="http://technorati.com/tags/Bash">Bash</a></p>
</div>
  
  


    </article>
    <!-- divider for blog post -->
    <div class="divider"></div>
  
  
    <article class="blogpost row">
      
  <div class="post-heading"> 
    



    <p class="date">15</p>  
    <div class="month-year"><p><span>Mar</span><br />2009</p></div>



    
      <div class="post-title">
        <h5>
          <a href="/2009/03/15/ninject-knows-a-new-trick/" title="">Ninject Knows a New Trick</a>
        </h5>
      </div> 
    
    <div class="clear"></div>
  </div>
  <!-- end of post heading -->
  
  <!-- start of post meta -->
  <div class="post-meta">
    <p>
       
  

<span class="byline author vcard">Posted by <span class="fn">Ivan Porto Carrero</span></span>

       
     </p>  
  </div>
  <!-- end of post meta -->
  


  <div class="entry-content"><p>Earlier this week Nate <a href="http://kohari.org/2009/03/13/ninject-github-crazy-delicious/">already said</a> that I was doing some work on <a href="http://ninject.org">Ninject</a>, now I have it working :). Everything I’m about to talk about is currently in the master tree of the <a href="http://github.com/enkari/ninject">ninject github</a> repository. Getting <a href="http://ironruby.net">IronRuby</a> to play nice with <a href="http://ninject.org">Ninject</a> was surprisingly easy :).</p>

<p>There was only one place that required some kind of weird workaround and from that workaround I’m entirely sure that it will go away by the time .NET 4.0 will be here. The DLR duplicates a number of delegates from .NET 4.0 but .NET 3.5 also defines them (i.e. System.Func&lt;T, TT>) and then you get great exception messages like: System.Func is not of type System.Func. The solution is to not reference System.Core in your project. Except that Ninject expects the System.Core variant at some point and that was solved by aliasing the System.Core assembly and talking to the types in that assembly by their alias.</p>

<p>Anyway the juicy stuff :) How can you take advantage of Ninjects newly found friendship with <a href="http://ironruby.net">IronRuby</a>.</p>

<p><a href="http://ninject.org">Ninject</a> now has 2 flavors of Kernels. We have a StandardKernel that knows how to deal with the module configuration system that uses a fluent interface defined in C#. And now we also have a DlrKernel that extends the StandardKernel with a RubyModuleLoader plugin. If you tell the DlrKernel to look inside a path for configuration files it will scan those folders for <em>.dll or </em>.rb files. Those files should contain the configuration for the ninject bindings.</p>

<p>So to create a Kernel that is ruby enabled you would use the following code:</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
</pre></td><td class='code'><pre><code class='csharp'><span class='line'><span class="n">IKernel</span> <span class="n">kernel</span> <span class="p">=</span> <span class="n">DlrKernel</span><span class="p">();</span>
</span><span class='line'><span class="n">kernel</span><span class="p">.</span><span class="n">AutoLoadModulesRecursively</span><span class="p">();</span>
</span><span class='line'>
</span><span class='line'><span class="kt">var</span> <span class="n">samurai</span> <span class="p">=</span> <span class="n">kernel</span><span class="p">.</span><span class="n">Get</span><span class="p">&lt;</span><span class="n">IWarrior</span><span class="p">&gt;();</span>
</span><span class='line'><span class="n">System</span><span class="p">.</span><span class="n">Console</span><span class="p">.</span><span class="n">WriteLine</span><span class="p">(</span><span class="n">samurai</span><span class="p">.</span><span class="n">Weapon</span><span class="p">.</span><span class="n">Name</span><span class="p">);</span>
</span></code></pre></td></tr></table></div></figure>


<p>The above snippet could then for example load a configuration file that has been defined like this:</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
</pre></td><td class='code'><pre><code class='ruby'><span class='line'><span class="nb">require</span> <span class="no">File</span><span class="o">.</span><span class="n">dirname</span><span class="p">(</span><span class="bp">__FILE__</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39;/../Ninject.Tests.dll&#39;</span>
</span><span class='line'><span class="kp">include</span> <span class="no">Ninject</span><span class="o">::</span><span class="no">Tests</span><span class="o">::</span><span class="no">Fakes</span>
</span><span class='line'>
</span><span class='line'><span class="n">to_configure_ninject</span> <span class="k">do</span> <span class="o">|</span><span class="n">ninject</span><span class="o">|</span>
</span><span class='line'>  <span class="n">ninject</span><span class="o">.</span><span class="n">bind</span> <span class="no">IWeapon</span><span class="p">,</span> <span class="ss">:to</span> <span class="o">=&gt;</span> <span class="no">Sword</span>
</span><span class='line'>  <span class="n">ninject</span><span class="o">.</span><span class="n">bind</span> <span class="no">IWarrior</span><span class="p">,</span> <span class="ss">:to</span> <span class="o">=&gt;</span> <span class="no">Samurai</span>
</span><span class='line'><span class="k">end</span>
</span></code></pre></td></tr></table></div></figure>


<p>The configuration above shows how most of a typical configuration would be defined by you the full configuration API at your disposal. All the options for the configuration can be specified in 2 ways. The first way is in a hash like syntax and the second way uses a more fluent syntax.</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
</pre></td><td class='code'><pre><code class='ruby'><span class='line'><span class="n">to_configure_ninject</span> <span class="k">do</span> <span class="o">|</span><span class="n">ninject</span><span class="o">|</span>
</span><span class='line'>
</span><span class='line'>  <span class="n">ninject</span><span class="o">.</span><span class="n">bind</span> <span class="no">IServiceA</span><span class="p">,</span> <span class="ss">:to</span> <span class="o">=&gt;</span> <span class="no">ServiceA</span><span class="p">,</span> <span class="ss">:as</span> <span class="o">=&gt;</span> <span class="ss">:singleton</span><span class="p">,</span>
</span><span class='line'>                          <span class="ss">:meta</span> <span class="o">=&gt;</span> <span class="p">{</span> <span class="ss">:type</span> <span class="o">=&gt;</span> <span class="s2">&quot;superservice&quot;</span> <span class="p">},</span>
</span><span class='line'>                          <span class="ss">:name</span> <span class="o">=&gt;</span> <span class="s2">&quot;aaaaa&quot;</span><span class="p">,</span>
</span><span class='line'>                          <span class="ss">:with</span> <span class="o">=&gt;</span> <span class="p">{</span>
</span><span class='line'>                            <span class="ss">:parameter</span> <span class="o">=&gt;</span> <span class="p">{</span> <span class="ss">:my_param</span> <span class="o">=&gt;</span> <span class="nb">lambda</span> <span class="p">{</span> <span class="o">|</span><span class="n">context</span><span class="o">|</span> <span class="s2">&quot;param_value&quot;</span> <span class="p">}</span> <span class="p">},</span>
</span><span class='line'>                            <span class="ss">:constructor_arguments</span> <span class="o">=&gt;</span> <span class="p">{</span><span class="ss">:const_arg</span> <span class="o">=&gt;</span> <span class="mi">56</span> <span class="p">},</span>
</span><span class='line'>                            <span class="ss">:property_values</span> <span class="o">=&gt;</span> <span class="p">{</span><span class="ss">:property_name</span> <span class="o">=&gt;</span> <span class="mi">94</span> <span class="p">},</span>
</span><span class='line'>                          <span class="p">},</span>
</span><span class='line'>                          <span class="ss">:on_activation</span> <span class="o">=&gt;</span> <span class="nb">lambda</span> <span class="p">{</span> <span class="o">|</span><span class="n">obj</span><span class="o">|</span> <span class="n">obj</span><span class="o">.</span><span class="n">do_some_work</span> <span class="p">},</span>
</span><span class='line'>                          <span class="ss">:on_deativated</span> <span class="o">=&gt;</span> <span class="nb">lambda</span> <span class="p">{</span> <span class="o">|</span><span class="n">obj</span><span class="o">|</span> <span class="n">obj</span><span class="o">.</span><span class="n">do_some_cleanup</span> <span class="p">},</span>
</span><span class='line'>                          <span class="ss">:when</span> <span class="o">=&gt;</span> <span class="nb">lambda</span> <span class="p">{</span> <span class="o">|</span><span class="n">context</span><span class="o">|</span> <span class="s2">&quot;a value&quot;</span> <span class="p">}</span> <span class="c1"># or</span>
</span><span class='line'>                          <span class="c1"># :when =&gt; { :injected_into =&gt; ServiceB } or</span>
</span><span class='line'>                          <span class="c1"># :when =&gt; { :target_has =&gt; AnAttribute } or</span>
</span><span class='line'>                          <span class="c1"># :when =&gt; { :member_has =&gt; AnAttribute } or</span>
</span><span class='line'>                          <span class="c1"># :when =&gt; { :class_has =&gt; AnAttribute }</span>
</span><span class='line'>  <span class="k">end</span>
</span></code></pre></td></tr></table></div></figure>


<p>Or</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
<span class='line-number'>24</span>
<span class='line-number'>25</span>
<span class='line-number'>26</span>
<span class='line-number'>27</span>
<span class='line-number'>28</span>
<span class='line-number'>29</span>
</pre></td><td class='code'><pre><code class='ruby'><span class='line'><span class="n">to_configure_ninject</span> <span class="k">do</span> <span class="o">|</span><span class="n">ninject</span><span class="o">|</span>
</span><span class='line'>
</span><span class='line'>  <span class="n">ninject</span><span class="o">.</span><span class="n">bind</span> <span class="no">IServiceA</span><span class="p">,</span> <span class="ss">:to</span> <span class="o">=&gt;</span> <span class="no">ServiceA</span><span class="p">,</span> <span class="ss">:as</span> <span class="o">=&gt;</span> <span class="ss">:singleton</span> <span class="k">do</span>
</span><span class='line'>    <span class="n">meta</span> <span class="ss">:type</span> <span class="o">=&gt;</span> <span class="s2">&quot;superservice&quot;</span>
</span><span class='line'>    <span class="nb">name</span> <span class="s2">&quot;aaaaa&quot;</span>
</span><span class='line'>
</span><span class='line'>    <span class="n">with</span> <span class="ss">:parameter</span> <span class="o">=&gt;</span> <span class="p">{</span> <span class="ss">:my_param</span> <span class="o">=&gt;</span> <span class="nb">lambda</span> <span class="p">{</span> <span class="o">|</span><span class="n">context</span><span class="o">|</span> <span class="s2">&quot;param_value&quot;</span> <span class="p">}</span> <span class="p">}</span>
</span><span class='line'>    <span class="n">with</span> <span class="ss">:constructor_arguments</span> <span class="o">=&gt;</span> <span class="p">{</span> <span class="ss">:const_arg</span> <span class="o">=&gt;</span> <span class="mi">56</span> <span class="p">}</span>
</span><span class='line'>    <span class="n">with</span> <span class="ss">:property_values</span> <span class="o">=&gt;</span> <span class="p">{</span> <span class="n">property_name</span> <span class="o">=&gt;</span> <span class="mi">94</span> <span class="p">}</span>
</span><span class='line'>
</span><span class='line'>    <span class="n">on_activation</span> <span class="k">do</span> <span class="o">|</span><span class="n">obj</span><span class="o">|</span>
</span><span class='line'>      <span class="n">obj</span><span class="o">.</span><span class="n">do_some_work</span>
</span><span class='line'>    <span class="k">end</span>
</span><span class='line'>
</span><span class='line'>    <span class="n">on_deativation</span> <span class="p">{</span> <span class="o">|</span><span class="n">obj</span><span class="o">|</span> <span class="n">obj</span><span class="o">.</span><span class="n">do_some_cleanup</span> <span class="p">}</span>
</span><span class='line'>
</span><span class='line'>    <span class="n">condition</span> <span class="k">do</span> <span class="o">|</span><span class="n">context</span><span class="o">|</span>
</span><span class='line'>      <span class="kp">true</span>
</span><span class='line'>    <span class="k">end</span>
</span><span class='line'>
</span><span class='line'>    <span class="c1"># or</span>
</span><span class='line'>
</span><span class='line'>    <span class="n">condition</span> <span class="ss">:injected_into</span> <span class="o">=&gt;</span> <span class="no">SomeClass</span>
</span><span class='line'>
</span><span class='line'>    <span class="c1"># or ...</span>
</span><span class='line'>
</span><span class='line'>  <span class="k">end</span>
</span><span class='line'>
</span><span class='line'><span class="k">end</span>
</span></code></pre></td></tr></table></div></figure>


<p>Some of the nicer consequences of using Ruby as a configuration language is the syntax for open generics. The example below shows how to configure types with open generics.</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
</pre></td><td class='code'><pre><code class='ruby'><span class='line'><span class="nb">require</span> <span class="no">File</span><span class="o">.</span><span class="n">dirname</span><span class="p">(</span><span class="bp">__FILE__</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39;/../Ninject.Tests.dll&#39;</span>
</span><span class='line'><span class="kp">include</span> <span class="no">Ninject</span><span class="o">::</span><span class="no">Tests</span><span class="o">::</span><span class="no">Fakes</span>
</span><span class='line'><span class="kp">include</span> <span class="no">Ninject</span><span class="o">::</span><span class="no">Tests</span><span class="o">::</span><span class="no">Integration</span><span class="o">::</span><span class="no">StandardKernelTests</span>
</span><span class='line'>
</span><span class='line'><span class="c1"># IGeneric is a generic interface and GenericService is a generic type</span>
</span><span class='line'><span class="c1"># we don&#39;t have to specify any special notation for open generics</span>
</span><span class='line'>
</span><span class='line'><span class="n">to_configure_ninject</span> <span class="k">do</span> <span class="o">|</span><span class="n">ninject</span><span class="o">|</span>
</span><span class='line'>  <span class="n">ninject</span><span class="o">.</span><span class="n">bind</span> <span class="no">IGeneric</span><span class="p">,</span> <span class="ss">:to</span> <span class="o">=&gt;</span> <span class="no">GenericService</span><span class="p">,</span> <span class="ss">:as</span> <span class="o">=&gt;</span> <span class="ss">:transient</span>
</span><span class='line'>  <span class="n">ninject</span><span class="o">.</span><span class="n">bind</span> <span class="no">IGeneric</span><span class="p">,</span> <span class="ss">:to</span> <span class="o">=&gt;</span> <span class="no">GenericService2</span>
</span><span class='line'><span class="k">end</span>
</span></code></pre></td></tr></table></div></figure>


<p>To specify a condition the syntax would look like this</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
</pre></td><td class='code'><pre><code class='ruby'><span class='line'><span class="nb">require</span> <span class="no">File</span><span class="o">.</span><span class="n">dirname</span><span class="p">(</span><span class="bp">__FILE__</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39;/../Ninject.Tests.dll&#39;</span>
</span><span class='line'><span class="kp">include</span> <span class="no">Ninject</span><span class="o">::</span><span class="no">Tests</span><span class="o">::</span><span class="no">Fakes</span>
</span><span class='line'>
</span><span class='line'><span class="n">to_configure_ninject</span> <span class="k">do</span> <span class="o">|</span><span class="n">ninject</span><span class="o">|</span>
</span><span class='line'>  <span class="n">ninject</span><span class="o">.</span><span class="n">bind</span> <span class="no">IWeapon</span><span class="p">,</span> <span class="ss">:to</span> <span class="o">=&gt;</span> <span class="no">Shuriken</span> <span class="k">do</span>
</span><span class='line'>    <span class="n">condition</span> <span class="k">do</span> <span class="o">|</span><span class="n">request</span><span class="o">|</span>
</span><span class='line'>        <span class="n">request</span><span class="o">.</span><span class="n">target</span><span class="o">.</span><span class="n">nil?</span>
</span><span class='line'>             <span class="p">?</span> <span class="kp">false</span>
</span><span class='line'>             <span class="p">:</span> <span class="n">request</span><span class="o">.</span><span class="n">target</span><span class="o">.</span><span class="n">member</span><span class="o">.</span><span class="n">reflected_type</span> <span class="o">==</span> <span class="no">Samurai</span><span class="o">.</span><span class="n">to_clr_type</span>
</span><span class='line'>      <span class="k">end</span>
</span><span class='line'>  <span class="k">end</span>
</span><span class='line'>  <span class="n">ninject</span><span class="o">.</span><span class="n">bind</span> <span class="no">IWeapon</span><span class="p">,</span> <span class="ss">:to</span> <span class="o">=&gt;</span> <span class="no">Sword</span>
</span><span class='line'>  <span class="n">ninject</span><span class="o">.</span><span class="n">bind</span> <span class="no">IWarrior</span><span class="p">,</span> <span class="ss">:to</span> <span class="o">=&gt;</span> <span class="no">Samurai</span>
</span><span class='line'><span class="k">end</span>
</span></code></pre></td></tr></table></div></figure>


<p>Well that’s all. I hope you like it. I will be looking into more ways to integrate DLR stuff into <a href="http://ninject.org">Ninject</a> the most obvious is allowing you to inject dynamic types into static classes.</p>
</div>
  
  


    </article>
    <!-- divider for blog post -->
    <div class="divider"></div>
  
  
    <article class="blogpost row">
      
  <div class="post-heading"> 
    



    <p class="date">09</p>  
    <div class="month-year"><p><span>Mar</span><br />2009</p></div>



    
      <div class="post-title">
        <h5>
          <a href="/2009/03/09/ironruby-mvc-progress/" title="">IronRuby MVC Progress</a>
        </h5>
      </div> 
    
    <div class="clear"></div>
  </div>
  <!-- end of post heading -->
  
  <!-- start of post meta -->
  <div class="post-meta">
    <p>
       
  

<span class="byline author vcard">Posted by <span class="fn">Ivan Porto Carrero</span></span>

       
     </p>  
  </div>
  <!-- end of post meta -->
  


  <div class="entry-content"><p>If you follow my tweets or the <a href="http://ironruby.net">IronRuby</a> mailinglist then you would know that I’ve been working on taking <a href="http://ironruby.net">IronRuby</a> ASP.NET MVC from the prototype stages to a more complete application. For me this has been a great experience getting familiar with the insides of ASP.NET MVC as well as playing around with integrating <a href="http://ironruby.net">IronRuby</a> in an existing C# application.</p>

<p>The guys over at MSFT (<a href="http://www.iunknown.com">John Lam</a>, <a href="http://blog.jimmy.schementi.com">Jimmy Schementi</a> and <a href="http://haacked.com">Phil Haack</a>) had previously created a prototype and I built upon their work. You can read more about the previous versions of the prototype.     <br/>
<a href="http://www.iunknown.com/2008/06/ironruby-and-aspnet-mvc.html">http://www.iunknown.com/2008/06/ironruby-and-aspnet-mvc.html</a>     <br/>
<a href="http://blog.jimmy.schementi.com/2008/07/aspnet-and-dynamic-languages.html">http://blog.jimmy.schementi.com/2008/07/aspnet-and-dynamic-languages.html</a>     <br/>
<a href="http://haacked.com/archive/2008/06/12/ironruby-and-asp.net-bffs-forever.aspx">http://haacked.com/archive/2008/06/12/ironruby-and-asp.net-bffs-forever.aspx</a>     <br/>
<a href="http://haacked.com/archive/2008/07/20/ironruby-aspnetmvc-prototype.aspx">http://haacked.com/archive/2008/07/20/ironruby-aspnetmvc-prototype.aspx      <br/>
</a><a href="http://haacked.com/archive/2009/02/17/aspnetmvc-ironruby-with-filters.aspx">http://haacked.com/archive/2009/02/17/aspnetmvc-ironruby-with-filters.aspx</a></p>

<p>In a previous post I explained what I had done I explained how I found an entry point and how to get started building your own mvc framework on top of asp.net MVC.</p>

<p><a href="http://flanders.co.nz/2009/01/25/created-a-basic-integration-for-ironruby-and-aspnet-mvc/">http://flanders.co.nz/2009/01/25/created-a-basic-integration-for-ironruby-and-aspnet-mvc/</a></p>

<p>How far am I now since my last post? Well we’ve got action filters, result filters, exception filters and authorization filters. We have an IronRubyMvcApplication as a base HttpApplication. Which should get you pretty far when building apps with <a href="http://github.com/casualjim/ironrubymvc">IronRuby MVC</a>.</p>

<p>I’m currently looking at implementing selectors and aliased actions. When I’m done with that I guess I’ve got a fairly working implementation of asp.net MVC and I’ll start developing a sample with it.</p>

<p>I’ve actually started building the sample to find out if I’ve missed something. The sample will be using <a href="http://www.mindscape.co.nz/products/LightSpeed/default.aspx">LightSpeed</a>, <a href="http://github.com/jschementi/ironrubymvc">IronRubyMVC</a> as well as youtube and flickr.</p>

<p>I would love to hear from people that submit bugs or even patches. I’d also like to get some discussion going on what is going to happen to it in the future :)</p>

<p><a href="http://www.dotnetkicks.com/kick/?url=http%3a%2f%2fflanders.co.nz%2f2009%2f03%2f09%2fironruby-mvc-progress%2f"><img src="http://www.dotnetkicks.com/Services/Images/KickItImageGenerator.ashx?url=http%3a%2f%2fflanders.co.nz%2f2009%2f03%2f09%2fironruby-mvc-progress%2f" alt="kick it on DotNetKicks.com" /></a></p>
</div>
  
  


    </article>
    <!-- divider for blog post -->
    <div class="divider"></div>
  
  <div class="pagination">
    
      <a class="prev" href="/page/3/">&larr; Older</a>
    
    <a href="/blog/archives">Blog Archives</a>
    
    <a class="next" href="/">Newer &rarr;</a>
    
  </div>
</div>
</div>


      </div>
    </div>
    <footer role="contentinfo"><!-- start of footer container -->
  <div class="container">
    <!-- start of row - 4 widget columns -->
      <div class="row clearfix">
      <div class="twelve columns">
        <div class="logo">
          <img src="/images/logo.png" alt="" />
          <h2>Rants &amp; ramblings</h2>
        </div>
      </div>

      <div class="four columns">        
        <h6>Social networks</h6>
        <ul class="social_network">
          <li class="rollover"><a href="http://facebook.com/ivanportocarrero" class="yellowtip" title="Facebook"><span class="fb-rollover"></span><img src="/images/social/fb.png" alt="" /></a></li>
          <li class="rollover"><a href="http://twitter.com/casualjim" class="yellowtip" title="Follow me"><span class="twitter-rollover"></span><img src="/images/social/twitter.png" alt="" /></a></li>
          <li class="rollover"><a href="https://plus.google.com/u/1/106536131996809745163/posts" class="yellowtip" title="Google plus"><span class="google-rollover"></span><img src="/images/social/google-plus.png" alt="" /></a></li>
        </ul>       
      </div>
    </div>
    <!-- end of row -->
  
    <!-- start of row - 4 widget columns -->
      <div class="row clearfix">
      <div class="eight columns">
        <h6>About me</h6>
        <p>
        Welcome to my blog. This is a collection of random thoughts and rants.
        </p>
        <p>
        Allow me to introduce myself. My name is Ivan Porto Carrero and I'm an enthusiastic developer on  Scala, .NET and Ruby.<br />Through this blog I hope I can share some of that passion and maybe help somebody out when they are looking on how to do something.
        </p>
      </div>
      <div class="four columns">
        <h6>Latest posts</h6>
        <ul class="square">
        
          <li>
            <a href="/2011/08/01/backchat-developers/">work for backchat</a>
          </li>
        
          <li>
            <a href="/2010/09/30/radical-language-and-platform-shift/">Radical language and platform shift</a>
          </li>
        
          <li>
            <a href="/2010/03/12/video-of-fosdem-ironruby-presentation/">Video of FOSDEM IronRuby presentation</a>
          </li>
        
          <li>
            <a href="/2009/12/01/adding-a-console-to-your-ironruby-application/">Adding a console to your IronRuby application</a>
          </li>
        
          <li>
            <a href="/2009/11/08/a-good-url-regular-expression-repost/">A good url regular expression? (repost)</a>
          </li>
        
        </ul> 
      </div>
      <div class="four columns">
        <h6>Browse pages</h6>
        <ul class="square">
          <li><a href="/">Home</a></li>
          <li><a href="/archives">Archives</a></li>
          <li><a href="/projects">My projects</a></li>
        </ul> 
      </div>
    </div>
    <!-- end of row -->
    

    <!-- start of footer divider -->
    <div class="sixteen columns">
      <div class="footer-divider row"></div>
    </div>  
    <!-- end of footer divider -->
    
    <!-- start of bottoms -->
    <div class="clearfix footnote">
      <div class="eight columns">
        <p class="copyright">Copyright &copy; 2012 - Ivan Porto Carrero - All Right Reserved</p>
      </div>
      <div class="eight columns">
        <p class="align-right"><span class="credit">Powered by <a href="http://octopress.org">Octopress</a>, designed by <a href="http://iweb-studio.com" target="_blank">iwebstudio</a></p>
      </div>
    </div>
    <!-- end of bottoms -->

  </div>
  <!-- end of footer container -->

</footer>
  </div>
  

<script type="text/javascript">
      var disqus_shortname = 'casualjim';
      
        
        var disqus_script = 'count.js';
      
    (function () {
      var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
      dsq.src = 'http://' + disqus_shortname + '.disqus.com/' + disqus_script;
      (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
    }());
</script>



<div id="fb-root"></div>
<script>(function(d, s, id) {
  var js, fjs = d.getElementsByTagName(s)[0];
  if (d.getElementById(id)) {return;}
  js = d.createElement(s); js.id = id;
  js.src = "//connect.facebook.net/en_US/all.js#appId=212934732101925&xfbml=1";
  fjs.parentNode.insertBefore(js, fjs);
}(document, 'script', 'facebook-jssdk'));</script>



  <script type="text/javascript">
    (function() {
      var script = document.createElement('script'); script.type = 'text/javascript'; script.async = true;
      script.src = 'https://apis.google.com/js/plusone.js';
      var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(script, s);
    })();
  </script>



  <script type="text/javascript">
    (function(){
      var twitterWidgets = document.createElement('script');
      twitterWidgets.type = 'text/javascript';
      twitterWidgets.async = true;
      twitterWidgets.src = 'http://platform.twitter.com/widgets.js';
      document.getElementsByTagName('head')[0].appendChild(twitterWidgets);
    })();
  </script>



<p id="back-top">
  <a href="#top"><span></span>To top</a>
</p>

</body>
</html>
