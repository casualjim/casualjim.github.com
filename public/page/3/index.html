
<!DOCTYPE html>
<!--[if lt IE 7 ]><html class="ie ie6" lang="en"> <![endif]-->
<!--[if IE 7 ]><html class="ie ie7" lang="en"> <![endif]-->
<!--[if IE 8 ]><html class="ie ie8" lang="en"> <![endif]-->
<!--[if (gte IE 9)|!(IE)]><!--><html lang="en"> <!--<![endif]-->
<head>

  <meta charset="utf-8">
  <title>Ivan Porto Carrero</title>
  <meta name="author" content="Ivan Porto Carrero">

  
  <meta name="description" content="On march 11 and 12 this year there will be TechDays Belgium I&#8217;m personally looking forward to the event because I will get to meet Laurent &hellip;">
  

  <!--[if lt IE 9]>
    <script src="http://html5shim.googlecode.com/svn/trunk/html5.js"></script>
  <![endif]-->

  <!-- http://t.co/dKP3o1e -->
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
  
  <link rel="canonical" href="http://flanders.co.nz/page/3">
  <link href="/favicon.png" rel="icon">
  <link href="/css/base.css" rel="stylesheet" type="text/css">
  <link href="/css/skeleton.css" rel="stylesheet" type="text/css">
  <link href="/css/syntax.css" rel="stylesheet" type="text/css">
  <link href="/css/style.css" rel="stylesheet" type="text/css">
  <link href="/css/skins/blue.css" rel="stylesheet" type="text/css">

  <link rel="shortcut icon" href="/images/favicon.ico">
  <link rel="apple-touch-icon" href="/images/apple-touch-icon.png">
  <link rel="apple-touch-icon" sizes="72x72" href="/images/apple-touch-icon-72x72.png">
  <link rel="apple-touch-icon" sizes="114x114" href="/images/apple-touch-icon-114x114.png">

  <script src="/js/jquery-1.7.1.min.js" type="text/javascript"></script>  
  <script src="/js/modernizr.js" type="text/javascript"></script>
  <script src="/js/jquery.easing.1.3.js" type="text/javascript"></script>
  <script type="text/javascript" src="/js/jquery.illuminate.0.7.min.js"></script>
  <!-- tweet
  <script type="text/javascript" src="/js/tweet/twitter.js"></script>
  <script type="text/javascript" src="/js/tweet/setting.js"></script> -->
  
  <script type="text/javascript" src="/js/custom.js"></script>
  <link href="/atom.xml" rel="alternate" title="Ivan Porto Carrero" type="application/atom+xml">
  <!--Fonts from Google"s Web font directory at http://google.com/webfonts -->
<link href="http://fonts.googleapis.com/css?family=PT+Serif:regular,italic,bold,bolditalic" rel="stylesheet" type="text/css">
<link href="http://fonts.googleapis.com/css?family=PT+Sans:regular,italic,bold,bolditalic" rel="stylesheet" type="text/css">

  
  <script type="text/javascript">
    var _gaq = _gaq || [];
    _gaq.push(['_setAccount', 'UA-240612-3']);
    _gaq.push(['_trackPageview']);

    (function() {
      var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
      ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
      var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
    })();
  </script>


</head>

<body >
  <div id="wrapper">
    <header role="banner"> <div class="container">
    <div class="row clearfix">
      <hdgroup>
        <div class="four columns">
          <div class="logo">
            <img src="/images/logo.png" alt="" />
            <h2>Rants &amp; ramblings</h2>
          </div>  
        </div>
      </hdgroup>
      <nav role="navigation"><!-- <ul class="subscription" data-subscription="rss">
  <li><a href="/atom.xml" rel="subscribe-rss" title="subscribe via RSS">RSS</a></li>
  
</ul>
  
<form action="http://google.com/search" method="get">
  <fieldset role="search">
    <input type="hidden" name="q" value="site:flanders.co.nz" />
    <input class="search" type="text" name="q" results="0" placeholder="Search"/>
  </fieldset>
</form>
   -->
<ul>
  <li>
    <a href="/">Home
      <span>Homepage</span>
    </a>    
  </li>
  <li>
    <a href="/archives">Archives
      <span>Articles</span>
    </a>    
  </li>
  <li>
    <a href="/projects">Projects
      <span>Open-Source</span>
    </a>    
  </li>
  <li>
    <a href="/about">About me
      <span>Introduction</span>
    </a>    
  </li>
</ul>
</nav>

    </div>
  </div>  
<!-- <hgroup>
  <h1><a href="/">Ivan Porto Carrero</a></h1>
  
    <h2>IO(thoughts) foreach (_.propagandize)</h2>
  
</hgroup>
 -->
</header>
    <div class="container bodycontent">
      <div class="row clearfix">
        <div class="sixteen columns headline">
          <h2>Ivan Porto Carrero</h2>
          <p class="italic">IO(thoughts) foreach (_.propagandize)</p>
        </div>
      </div>  

      <div class="sixteen columns">
        <div class="divider row"></div>
      </div>  
      
      <!-- start of row -->
      <div class="row clearfix">
        <div class="sixteen columns">
          <!-- twitter feed -->
          <div class="twitter_feed">
            <ul class="tweet_list"></ul>
          </div>
        </div>
      </div>  
      <div class="sixteen columns">
        <div class="divider row"></div>
      </div>  
      
      <div id="maincontent" class="clearfix">
        <div class="five columns">  
  <aside class="left-sidebar">
    
        
<div class="widget row">
  <h5>Search form</h5>  
  <div id="search-form">
    <form action="http://google.com/search" method="get">
      <fieldset role="search">
        <input type="hidden" name="q" value="site:flanders.co.nz" />
        <input id="search-box" type="text" name="q" results="0" placeholder="Search"/>
        <input type="submit" value="Search" id="search-button" />
        <div class="clear"></div>
      </fieldset>
    </form>
  </div>
</div>
   <section>
  <div class="widget row">
    <h5>Recent Posts</h5>  
    <ul id="recent_posts">
      
        <li class="post">
          <a href="/2011/08/01/backchat-developers/">work for backchat</a>
        </li>
      
        <li class="post">
          <a href="/2010/09/30/radical-language-and-platform-shift/">Radical language and platform shift</a>
        </li>
      
        <li class="post">
          <a href="/2010/03/12/video-of-fosdem-ironruby-presentation/">Video of FOSDEM IronRuby presentation</a>
        </li>
      
        <li class="post">
          <a href="/2009/12/01/adding-a-console-to-your-ironruby-application/">Adding a console to your IronRuby application</a>
        </li>
      
        <li class="post">
          <a href="/2009/11/08/a-good-url-regular-expression-repost/">A good url regular expression? (repost)</a>
        </li>
      
    </ul>
  </div>
</section>

<section>
  <div class="widget row">
    <h5>GitHub Repos</h5>
    <ul id="gh_repos">
      <li class="loading">Status updating&#8230;</li>
    </ul>
    
    <a href="https://github.com/casualjim">@casualjim</a> on GitHub
    
  </div>
  <script type="text/javascript">
    $(document).ready(function(){
        if (!window.jXHR){
            var jxhr = document.createElement('script');
            jxhr.type = 'text/javascript';
            jxhr.src = 'javascripts/libs/jXHR.js';
            var s = document.getElementsByTagName('script')[0];
            s.parentNode.insertBefore(jxhr, s);
        }

        github.showRepos({
            user: 'casualjim',
            count: 0,
            skip_forks: true,
            target: '#gh_repos'
        });
    });
  </script>
  <script src="/javascripts/github.js" type="text/javascript"></script>
</section>


<section>
  <div class="widget row">
    <h5>Latest Tweets</h5>
    <ul id="tweets">
      <li class="loading">Status updating&#8230;</li>
    </ul>
    <script type="text/javascript">
      $(document).ready(function(){
        // getTwitterFeed("casualjim", 4, false);
      });
    </script>
    
      <a href="http://twitter.com/casualjim" class="twitter-follow-button" data-show-count="false">Follow @casualjim</a>
    
  </div>
</section>


<section>
  <div class="widget row">
    <h5>On Delicious</h5>
    <div id="delicious"></div>
    <script type="text/javascript" src="http://feeds.delicious.com/v2/json/casualjim?count=3&amp;sort=date&amp;callback=renderDeliciousLinks"></script>
    <p><a href="http://delicious.com/casualjim">My Delicious Bookmarks &raquo;</a></p>
  </div>
</section>


<section class="googleplus">
  <div class="widget row">
    <h5>
      <a href="https://plus.google.com/106536131996809745163?rel=author">
        <img src="http://www.google.com/images/icons/ui/gprofile_button-32.png" width="32" height="32">
        Google+
      </a>
    </h5>
  </div>
</section>



    
  </aside>
</div>
<div class="eleven columns">
<div class="blog-index">
  
  
  
    <article class="blogpost row">
      
  <div class="post-heading"> 
    



    <p class="date">03</p>  
    <div class="month-year"><p><span>Mar</span><br />2009</p></div>



    
      <div class="post-title">
        <h5>
          <a href="/2009/03/03/attending-techdays-belgium-2009/" title="">Attending TechDays Belgium 2009</a>
        </h5>
      </div> 
    
    <div class="clear"></div>
  </div>
  <!-- end of post heading -->
  
  <!-- start of post meta -->
  <div class="post-meta">
    <p>
       
  

<span class="byline author vcard">Posted by <span class="fn">Ivan Porto Carrero</span></span>

       
     </p>  
  </div>
  <!-- end of post meta -->
  


  <div class="entry-content"><p>On march 11 and 12 this year there will be <a href="http://www.microsoft.com/belux/techdays/about.aspx">TechDays Belgium</a></p>

<p>I&#8217;m personally looking forward to the event because I will get to meet Laurent Bugnion in person.  I&#8217;ve been following him on twitter for over a year now and it would be cool to finally put a face (apart from the avatar) to the author :)</p>

<p><a href="http://www.microsoft.com/belux/techdays/about.aspx"><img src="http://www.microsoft.com/belux/techdays/img/toolkit/480x325ani.gif" alt="" /></a></p>

<p>There are some really interesting sessions there. At least they are for me, mostly towards silverlight and WPF development.  I&#8217;m mostly doing WPF dev work at the moment. Silverlight is just something that interests me naturally. I started development by writing code in flash and animating 3D generated models. I turned away from flash because of the dev tools support and fully went into .NET after that.  I was stoked to learn about silverlight and I even like the tools it has to design interfaces with, but of course I&#8217;m not a designer so I minimize the time spent in there and hope for somebody to come along and make it look good.   I love javascript but css not that much and my velocity is higher in Silverlight to develop the complexer kind of UI so I&#8217;m also very interested in the Silverlight stuff.</p>

<p>Maybe it&#8217;s harder for me to get excited about the new language features of C# 4.0 as for me there aren&#8217;t that many new features to me although for the c# language the features are huge. Variance is something I&#8217;ve been waiting for since the introduction of generics, for dynamic typing I can get my fix with IronRuby of course. I rarely do COM interop but it will be nice if it gets better support for that. Named parameters however are new and pretty interesting to me. While it will be a hard sell for me to introduce IronRuby into client work. I can still do lots of tricks with the dynamic typing support in C#4 which is pretty cool too.
I&#8217;ve got my ticket have you got yours?</p>

<p>If you&#8217;re going too let me know so we can catch up for a beer.</p>

<p>See you there :)</p>
</div>
  
  


    </article>
    <!-- divider for blog post -->
    <div class="divider"></div>
  
  
    <article class="blogpost row">
      
  <div class="post-heading"> 
    



    <p class="date">05</p>  
    <div class="month-year"><p><span>Feb</span><br />2009</p></div>



    
      <div class="post-title">
        <h5>
          <a href="/2009/02/05/ruby/" title="">Ruby</a>
        </h5>
      </div> 
    
    <div class="clear"></div>
  </div>
  <!-- end of post heading -->
  
  <!-- start of post meta -->
  <div class="post-meta">
    <p>
       
  

<span class="byline author vcard">Posted by <span class="fn">Ivan Porto Carrero</span></span>

       
     </p>  
  </div>
  <!-- end of post meta -->
  


  <div class="entry-content"><p>2 weeks ago I had the chance to <a href="http://flanders.co.nz/2009/01/25/participating-in-the-italian-altnet-user-group/">talk to the Italian Alt.NET community about IronRuby</a>. I&#8217;m pretty excited about the Ruby language and I try to convey that enthusiasm onto my victims. From the talks I had afterwards it looks like I was able to infect at least one or two enough to make them go home and download IronRuby to have a play. It is the very first time that I get to see one of my presentations myself because this one got taped and put online.</p>

<p>If there is one thing that watching this video has taught me then it will probably be that I need more practice and to prepare a lot better. Since I&#8217;m a kid I have the habit of walking into things hugely underprepared. I take the big bullet points of what I&#8217;m supposed to say and make a story around it when I start talking.  It was my belief that those things feel more natural. After having watched this presentation I may have to come back on my point of view and probably prepare better. I don&#8217;t believe that learning everything you&#8217;re going to say by heart is a good solution either because if you then forget one thing you&#8217;re completely lost in your storyline and you may freeze.</p>

<p>I guess it would probably be a good idea for me to get a video camera and tape a few practice runs of presentations so that I can improve and look way more professional next time I get on a stage.  That being said I really enjoy doing those things. The good thing about doing those sessions is that I get to talk to many interesting people about subjects close and dear to me.</p>

<p>Anyway you&#8217;re probably not waiting for me to completely dissect my performance so instead I&#8217;ll leave you with the <a href="http://vimeo.com/3059773">link to the video</a></p>
</div>
  
  


    </article>
    <!-- divider for blog post -->
    <div class="divider"></div>
  
  
    <article class="blogpost row">
      
  <div class="post-heading"> 
    



    <p class="date">25</p>  
    <div class="month-year"><p><span>Jan</span><br />2009</p></div>



    
      <div class="post-title">
        <h5>
          <a href="/2009/01/25/created-a-basic-integration-for-ironruby-and-aspnet-mvc/" title="">Created a Basic Integration for IronRuby and Asp.NET MVC</a>
        </h5>
      </div> 
    
    <div class="clear"></div>
  </div>
  <!-- end of post heading -->
  
  <!-- start of post meta -->
  <div class="post-meta">
    <p>
       
  

<span class="byline author vcard">Posted by <span class="fn">Ivan Porto Carrero</span></span>

       
     </p>  
  </div>
  <!-- end of post meta -->
  


  <div class="entry-content"><p>As I can see the end of the chapter on Rails and I&#8217;m looking ahead to see what will be next. I decided to start working on the chapter that talks about using IronRuby with Asp.NET MVC next.  <a href="http://blog.jimmy.schementi.com/">Jimmy Schementi</a> and <a href="http://haacked.com/">Phil Haack</a> created a proof of concept implementation a couple of months ago that actually did work.
The past weekend I&#8217;ve been looking to build on the excellent work they did and to build a more complete integration. In this post I&#8217;ll try to explain what I did to make it work.  The integration work is far from complete, so if you&#8217;ve got some free time on your hands and you happen to be looking for an Open Source project to help with then this could be a candidate for you :).</p>

<h3>Finding a place to start</h3>

<p>Let me start off by saying that I&#8217;m pretty happy with the internals of the asp.net mvc framework. The code was easy to read given that you start in the correct file and work your way through much in the same way a request would be executed. In my case I started at the MVC handler and immediately you see one of the classes that we&#8217;ll definitely need to customize. The <em>RubyControllerFactory</em> is the class in question and it needs to be customized because we&#8217;re going to use a <em>RubyController</em>.
ASP.NET MVC internally uses reflection to do its magic. In the futures project they have a couple of other implementations like async with reflection and so on. I decided to use the classes prefixed as Reflected as my guide for creating my own integration they were probably the simplest implementation of the class.
I kept the view engine Jimmy and Phil created and focussed on the controllers. Working with the DLR API&#8217;s requires a bunch of classes and</p>

<h3>Sweet now what does this mean in terms of IronRuby integration?</h3>

<p>To limit some of the work I needed to be doing I decided that Ruby controller actions don&#8217;t take any parameters we can bind to instead you will have to rely on the data that&#8217;s available in the params hash to get to the input delivered by the request. Actually I made a decision to keep that from the POC implementation before.<br/>
In ASP.NET MVC there is a <em>ReflectedControllerDescriptor</em> and a <em>ReflectedActionDescriptor</em>. They are used to cache the information we need so it only has to perform the costly operations once, which is a good strategy IMHO.
For IronRuby that means we&#8217;ll need to create a <em>RubyControllerDescriptor</em> and <em>RubyActionDescriptor</em>. The last class we&#8217;ll going to need to customize in this exercise is the <em>ControllerActionInvoker</em> which as the name hints at: invokes actions on your controller :)
For people that have been doing rails applications, you&#8217;re not limited to Rails now. You could use Ruby but leverage the ASP.NET MVC infrastructure for implementing a mvc web app. When somebody would create the adapters for activerecord to leverage ADO.NET to talk to data sources you should be able to just use active record that comes with the rails framework in your app as models. The view engine in ironrubymvc is also erb based so I&#8217;d imagine you would be able to just copy your view code in and making sure that you have replacement helpers if you&#8217;ve used helpers.
Working on this code also opens up the question if it isn&#8217;t possible to actually run rails via a similar mechanism&#8230; mmm must investigate</p>

<h3>Where can I find it?</h3>

<p>I forked the git repository from <a href="http://github.com/jschementi/ironrubymvc">Jimmy Schementi</a>. And I do send him pull requests when I&#8217;ve pushed some changes. So you could potentially pick that repository to work out of. The disadvantage is that you won&#8217;t pick up changes I make immediately. The good thing is that Jimmy&#8217;s repo is probably a good place to follow because he can also take work that Phil did and add it to the repo. I will then have to sync my version with his.
Or you could use <a href="http://github.com/casualjim/ironrubymvc">my repo</a> and pick up the changes I make immediately but you&#8217;ll have to wait to merge it with the changes that have been applied into Jimmy&#8217;s repo until I get around to merging that into mine.
I&#8217;d say that over time it would probably be a better idea to get the repo from Jimmy while mine will be very active but just for a short period of time, when I&#8217;m happy with it I&#8217;ll move on.</p>

<h3>What&#8217;s left to do?</h3>

<ul>
<li><p>Implement action filters (before/after)</p></li>
<li><p>Implement authorization filters</p></li>
<li><p>Implement an HttpApplicationBase class that will create the script runtime</p></li>
<li><p>Implement a HttpModule that will take care of creating a RubyEngine object</p></li>
<li><p>&#8230;</p></li>
</ul>


<p>For today I&#8217;d say <strong><em>go_to(&#8220;http://github.com/casualjim/ironrubymvc&#8221;).play.create.have_fun</em></strong></p>

<p>When my work stabilizes a little bit more I&#8217;ll write a blog post explaining how I went about using the DLR hosting API&#8217;s to host IronRuby in an ASP.NET application and how the implemenation of IronRubyMvc was put together.</p>

<p><a href="http://www.dotnetkicks.com/kick/?url=http%3a%2f%2fflanders.co.nz%2f2009%2f01%2f25%2fcreated-a-basic-integration-for-ironruby-and-aspnet-mvc%2f"><img src="http://www.dotnetkicks.com/Services/Images/KickItImageGenerator.ashx?url=http%3a%2f%2fflanders.co.nz%2f2009%2f01%2f25%2fcreated-a-basic-integration-for-ironruby-and-aspnet-mvc%2f" alt="kick it on DotNetKicks.com" /></a></p>
</div>
  
  


    </article>
    <!-- divider for blog post -->
    <div class="divider"></div>
  
  
    <article class="blogpost row">
      
  <div class="post-heading"> 
    



    <p class="date">25</p>  
    <div class="month-year"><p><span>Jan</span><br />2009</p></div>



    
      <div class="post-title">
        <h5>
          <a href="/2009/01/25/participating-in-the-italian-altnet-user-group/" title="">Participating in the Italian Alt.NET User Group</a>
        </h5>
      </div> 
    
    <div class="clear"></div>
  </div>
  <!-- end of post heading -->
  
  <!-- start of post meta -->
  <div class="post-meta">
    <p>
       
  

<span class="byline author vcard">Posted by <span class="fn">Ivan Porto Carrero</span></span>

       
     </p>  
  </div>
  <!-- end of post meta -->
  


  <div class="entry-content"><p>I just finished my talk at the Italian <a href="http://ugialt.net">Alt.NET conference</a>.
There were the following topics of discussion:</p>

<ul>
<li><p>Domain Driven Design</p></li>
<li><p>User stories &amp; planning game</p></li>
<li><p>Advanced Unit Testing in the real world</p></li>
<li><p>Acceptance testing (Fitness)</p></li>
</ul>


<p>And of course my topic was <a href="http://ironruby.net">IronRuby</a></p>

<p>Because of the level of my italian or better yet the lack thereof I couldn&#8217;t participate in many of the discussions. IMHO that was a pitty because I actually do like having discussions about programming and designing applications.</p>

<p>My talk went alright judging by the reactions of the people that listened to my talk. <a href="http://codeclimber.net.nz">Simone</a> filmed the whole day and told me he would put up the videos on vimeo for all to see.
What I thought was particularly good for IronRuby is that there definitely interest in for using IronRuby. The most obvious places for people to start using ruby are RSpec (when it works OTB) and rake as a replacement for nant or msbuild scripts.  Of course if you ask me then there are plenty of other reasons to use IronRuby like Silverlight and WPF.</p>

<p>For the people that are interested in my presentation you can download it from <a href="http://ugialtnet3.googlecode.com/svn/trunk/ironruby/Ruby_loves_dotNet.pptx">google code</a>. Most of the code that I&#8217;ve showed is included in the presentation as notes.
All in all I had a great time and I hope the italian community will invite me again some time :). Italy has the benefit that they have great food and wine and that makes it very easy to convince me to take the plane :)</p>

<p>I couldn&#8217;t show everything because I got carried away at one point and lost track of time. So I had to drop my demo&#8217;s about using bacon (as a replacement for RSpec) to start writing specs for your .NET code today. I also wanted to show some of the stuff <a href="http://blog.jimmy.schementi.com/">Jimmy Schementi</a> did with <a href="http://silverlight.net">Silverlight</a> and <a href="http://ironruby.net">IronRuby</a>. Like <a href="http://github.com/jschementi/agdlr">agdlr</a> and the integration for <a href="http://rubyonrails.org">Ruby on Rails</a> he created with the <a href="http://github.com/jschementi/silverline">silverline plugin</a>.  But unfortunately I ran out of time before I could show off some of those things.</p>

<p>I had the opportunity to talk to the Italian member of the Mono team, <a href="http://primates.ximian.com/~massi/blog/">Massimiliano Mantione</a>. And this is what I love about conferences, they are full of interesting people with all kind of ideas. When I go to an event like TechEd or something I generally don&#8217;t actually attend many sessions because most of that content is available online anyway. Instead I will roam the hallways etc in search of good conversations and intersting people.  Meeting the member of the mono team made me slightly envious because he&#8217;s doing what I would love to be doing too :) He&#8217;s working from home and getting paid to work on FOSS. He mentioned some intersting stuff the mono guys are doing and explained from a high level how they got the C# eval to work.</p>

<p>Some other notable facts about how they did the conference, which I liked a lot. The conference is free to attend, but they did have the possibility to accept donations. It were those donations that paid for my flight over here :). The way they organized the conference was in an Open Spaces format which is very open for discussion and they were completely transparent as to how the money had been spent. They still had some money left and donated that to an open source project. The open source project was chosen through voting.</p>

<p>The open source projects on the list of possibilities were:</p>

<ul>
<li><p><a href="http://castleproject.org">Castle/Monorail</a></p></li>
<li><p><a href="http://ayende.com/projects/rhino-mocks.aspx">Rhino.Mocks</a></p></li>
<li><p><a href="http://ninject.org">Ninject</a></p></li>
<li><p><a href="http://dev.dejardin.org/">Spark View Engine</a></p></li>
<li><p><a href="http://www.gallio.org/">MbUnit/Gallio</a></p></li>
</ul>


<p>In the end it was Rhino.Mocks that won the vote and they have received the donation.</p>

<p>I would like to thank the organizers of the conference for having me and the people that followed my talk for not falling asleep.</p>
</div>
  
  


    </article>
    <!-- divider for blog post -->
    <div class="divider"></div>
  
  
    <article class="blogpost row">
      
  <div class="post-heading"> 
    



    <p class="date">06</p>  
    <div class="month-year"><p><span>Jan</span><br />2009</p></div>



    
      <div class="post-title">
        <h5>
          <a href="/2009/01/06/a-new-year-some-changes/" title="">A New Year&#8230; Some Changes</a>
        </h5>
      </div> 
    
    <div class="clear"></div>
  </div>
  <!-- end of post heading -->
  
  <!-- start of post meta -->
  <div class="post-meta">
    <p>
       
  

<span class="byline author vcard">Posted by <span class="fn">Ivan Porto Carrero</span></span>

       
     </p>  
  </div>
  <!-- end of post meta -->
  


  <div class="entry-content"><p>With 2009 starting, started actually, it might be time to look ahead at what&#8217;s to come this year.</p>

<p>I hope your holidays were better than mine with my grandfather dying on Christmas eve, I wasn&#8217;t in much of a celebratory mood this year.</p>

<p>After having tried being a consultant for a while I have a serious hang-over from enterprise style of development. At least the dev style that only listens to what microsoft has to say and swears by their judgment under the motto: &#8220;You don&#8217;t get fired for buying Microsoft&#8221;. As if it wasn&#8217;t bad enough all the CRUD went through stored procs over linq-2-sql. When somebody there told me to copy/paste instead of taking a little bit more care I made up my mind and left the place. This leaves me at the start of this year without a project/job, and as it looks now it might not be the best position to be in with the crisis and all.</p>

<p>Another area that I desperately need to make some progress in is the <a href="http://manning.com/carrero">IronRuby in Action</a> book. So far I have 4 chapters completed and the one on Rails is about half-way there. Because I&#8217;m not making as much progress as I initially thought. This partly because I decided to turn my life<a href="http://flanders.co.nz/2008/07/13/moving-back-to-belgium/"> upside down</a> this year.
Now that I&#8217;ve finally found a good place to live and my personal life isn&#8217;t as messy as it used to be I&#8217;ve returned to writing.</p>

<p>More news on the IronRuby in Action front is that I&#8217;ve got a co-author now. His name is <a href="http://blog.prokrams.com/">Michael Letterle</a> and he has contributed to the IronRuby project.  Michael is very passionate about Ruby development and is currently working on the Silverlight chapter of the IronRuby in Action book.</p>

<p>As part of the Chapter on Rails I&#8217;ve built a twitter clone. In the wpf chapter I created a twitter client and to be ensure things continue to work both offline as online it seemed like a good idea to me to create the server side too.  The last couple of days I&#8217;ve been implementing this limited version and you can find it at <a href="http://codeplex.com/mocktwitter">http://codeplex.com/mocktwitter</a>. Finishing this application is on my to-do list for this year for now it does a little bit more than it needs to for the samples from the WPF chapter to work.</p>

<p>More on the IronRuby subject. I&#8217;ve also created a DBI layer for ADO.NET that you can use in conjection with IronRuby to talk to ADO.NET data sources. I don&#8217;t know yet if I will base my activerecord adapters on this DBI layer or just with the providers immediately. I put a <a href="http://rubydoes.net/2009/01/06/ironruby-dbi-connecting-to-adonet-datasources/">post up</a> on how to get started and where to get the sources etc on <a href="http://rubydoes.net">rubydoes.net</a></p>

<p>I intend to spend some time on <a href="http://github.com/jschementi/agdlr">agdlr</a> as well as on <a href="http://github.com/casualjim/ironnails">ironnails</a> as well because ironnails has been a lot of fun to develop.</p>
</div>
  
  


    </article>
    <!-- divider for blog post -->
    <div class="divider"></div>
  
  
    <article class="blogpost row">
      
  <div class="post-heading"> 
    



    <p class="date">30</p>  
    <div class="month-year"><p><span>Dec</span><br />2008</p></div>



    
      <div class="post-title">
        <h5>
          <a href="/2008/12/30/building-ironruby-with-mono-on-osx/" title="">Building IronRuby With Mono on OSX</a>
        </h5>
      </div> 
    
    <div class="clear"></div>
  </div>
  <!-- end of post heading -->
  
  <!-- start of post meta -->
  <div class="post-meta">
    <p>
       
  

<span class="byline author vcard">Posted by <span class="fn">Ivan Porto Carrero</span></span>

       
     </p>  
  </div>
  <!-- end of post meta -->
  


  <div class="entry-content"><p><strong><strong><strong> This is a duplicate post of <a href="http://rubydoes.net/2008/12/30/building-ironruby-with-mono/">http://rubydoes.net/2008/12/30/building-ironruby-with-mono/</a> </strong></strong></strong></p>

<p>IronRuby comes in 2 flavours of SCM and apparently also with 2 flavours of project layout.</p>

<p>I spend most of my time on the mac and I wanted to be able to test ironruby stuff on it too. I tried to build IronRuby on my mac which doesn’t work straight away you have to patch it a little to make it work.</p>

<p>If you’re using the svn version then you can use the <a href="http://sparcs.kaist.ac.kr/~tinuviel/download/IronRuby/">patch</a> created by Seo Sanghyeon.</p>

<p><a href="http://blog.prokrams.com/">Michael Letterle</a> has forked the ironruby git repository and created a branch called <strong>linux</strong>. You can find it on <a href="http://github.com/TheProkrammer/ironruby">github</a>.</p>

<p>For me the linux branch didn’t want to work and so I forked the ironruby repository too, created a branch called <strong>mono</strong>. My version is also up on <a href="http://github.com/casualjim/ironruby">github</a>.</p>

<p>If you’re going to use the git layout of IronRuby, which is practically the same as what the IronRuby team uses at Microsoft. You’ll have to set an environment variable <em>MERLIN_ROOT</em> . I use a .bashrc file and added the following line to it:</p>

<p><code>export MERLIN_ROOT=’/Users/ivan/src/ironruby/merlin/main’</code></p>

<p>Now how do you get to those git branches?</p>

<p>Start a terminal session.</p>

<p>I have a directory src in which i download and compile sources. So I navigated into that directory src.</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
</pre></td><td class='code'><pre><code class='sh'><span class='line'><span class="nb">cd </span>src
</span><span class='line'>git clone git://github.com/casualjim/ironruby.git
</span><span class='line'><span class="nb">cd </span>ironruby
</span><span class='line'>git checkout -b mono
</span><span class='line'>git pull origin mono
</span></code></pre></td></tr></table></div></figure>


<p>Compiling IronRuby</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
</pre></td><td class='code'><pre><code class='sh'><span class='line'><span class="nb">cd </span>merlin/main/Languages/Ruby
</span><span class='line'>rake compile <span class="nv">mono</span><span class="o">=</span>1
</span></code></pre></td></tr></table></div></figure>


<p>Update:</p>

<p>You will also need a version of ruby installed, rake and the pathname2 gem</p>

<p>It won&#8217;t work with the latest release of mono. I&#8217;m using the trunk version of mono to build ironruby.
I&#8217;ve got instructions that could show you how to compile mono <a href="http://flanders.co.nz/2008/02/05/compiling-mono-and-ironruby-on-osx-leopard/">here</a>.</p>
</div>
  
  


    </article>
    <!-- divider for blog post -->
    <div class="divider"></div>
  
  
    <article class="blogpost row">
      
  <div class="post-heading"> 
    



    <p class="date">23</p>  
    <div class="month-year"><p><span>Oct</span><br />2008</p></div>



    
      <div class="post-title">
        <h5>
          <a href="/2008/10/23/beating-a-dead-horse-stored-procedures/" title="">Beating a Dead Horse: Stored Procedures</a>
        </h5>
      </div> 
    
    <div class="clear"></div>
  </div>
  <!-- end of post heading -->
  
  <!-- start of post meta -->
  <div class="post-meta">
    <p>
       
  

<span class="byline author vcard">Posted by <span class="fn">Ivan Porto Carrero</span></span>

       
     </p>  
  </div>
  <!-- end of post meta -->
  


  <div class="entry-content"><p>I seem to be having the same conversations with the dev teams whenever I switch clients. The topic of this post is one that many people have written about before. I&#8217;m just going to put my opinion on my blog so I can refer people to it in the future instead of having to repeat myself every time.
What prompted this post is that since I&#8217;ve moved to Belgium I&#8217;ve had to take a step back from living on the bleeding edge and using open source projects. Most of the work is concentrated in Brussels and is at big corporates or banks not exactly what you&#8217;d see as the progressive thinkers (with reason).
I guess it would be safe to say that I&#8217;ve been immersed in &#8220;enterprise&#8221; development. In short I still haven&#8217;t seen anything that is more complicated than a web app like <a href="http://www.xero.com">Xero</a>. But perhaps more about that in another post. This one is about stored procedures and their valid uses.</p>

<p>My current client is pretty interested in the newer technologies (anything that is out of beta) and how to put them into production.  As such they use LINQ as their data layer. They follow the classic MS guidance of data logic, business logic and - the trigger for this post - stored procedures to encapsulate all the data access.
People that have worked with me in the past will be able to vouch for the fact that I feel strongly against stored procedures. But before we get to why I don&#8217;t want to use them, let&#8217;s look at some of the reasons people have given me in the past why they were using them.</p>

<ul>
<li>Performance. Because stored procedures are (pre)compiled</li>
<li>Security. They can lock down tables from being accessed by users directly but they can get to the database through the stored procedures layer</li>
<li>Maintenance. You can change a stored procedure more easily than deploying a new build of your application because no compilation is needed.</li>
<li>Less data to send over the wire because stored procedures can execute more sql statements at once.</li>
</ul>


<p>All of that stuff sounds pretty great right? As I&#8217;ve said before my current client has developed their data layer in their framework using Linq2Sql. I think Linq2Sql is not too bad, at least it gets the corporates into an ORM mindset because it comes from MS which makes it a vastly easier technology to sell than NHibernate for example.
But when you&#8217;re going to use Linq in conjunction with stored procedures for basic CRUD operations I think you&#8217;re kind of missing the whole point of Linq2Sql or ORM&#8217;s altogether for that matter. So there you have it, this is why I cannot resist posting about this subject although many people have said pretty much the same as I&#8217;m going to say in this post.</p>

<h3>Credit where credit is due</h3>

<p>The list of people below have helped me in forming my opinion on this subject. I&#8217;ve had the pleasure of having lengthy discussion on this topic with the first 3 people on the list. I consider the people on this list to be authorities in .NET development and 4 of them have written their own ORM in the past. Alex James and Andrew Peters now both work on the Entity Framework team.
* <a href="http://blogs.msdn.com/alexj">Alex James</a>
* <a href="http://andrewpeters.net">Andrew Peters</a>
* <a href="http://turtle.net.nz">Jeremy Boyd</a>
* <a href="http://weblogs.asp.net/fbouma">Frans Bouma</a>
* <a href="http://ayende.com/Blog">Ayende (Oren Eini)</a>
* <a href="http://codebetter.com/jmiller">Jeremy D. Miller</a>
* <a href="http://codinghorror.com">Jeff Atwood</a></p>

<p>Let&#8217;s look at the reasons mentioned above and work our way through them seeing how they pan out in the end and you can draw your own conclusions on the matter.</p>

<h3>Performance</h3>

<h4>Stored procedures are precompiled</h4>

<p>The fact that stored procedures are precompiled and dynamic queries aren&#8217;t is a complete myth. Ever since Sql Server 7.0 the query plans are cached for both of them. If you change a parameter in a stored procedure it has to be recompiled too.You can check the Sql documentation to verify that.
IMHO this also falls in the category premature optimizations. It could be that you have a query that is so complex or that is a real bottleneck for your application then it might be worth it to invest the time and write a stored procedure for it that queries the database differently and as such get rid of the bottle neck but take on a higher maintenance cost.</p>

<h4>Batching of queries and returning multiple result sets</h4>

<p>Another argument people often bring to the table is that in a stored procedure I can issue many sql statements on the same database connection. I hate to break the news to you but you get the same benefits when you&#8217;re using dynamic sql (preferably the parameterized kind). You could issue one command that returns multiple result sets just like the body of your stored procedure. Or you could issue more than one command on the same connection and still get a very similar result.</p>

<h3>Security</h3>

<h4>Sql Injection attacks</h4>

<p>Another argument I keep hearing is the fact that when you build dynamic sql statements you open yourself up for sql injection attacks which isn&#8217;t that case for stored procedures.
There is some truth in that but it definitely isn&#8217;t the whole truth. What they mean by that is that if you&#8217;re going to build your dynamic query by concatenating strings then you could indeed open yourself up to a sql injection attack but I&#8217;ve seen this happen in stored procedures too it&#8217;s just a little bit harder to do it there.
However if you build your sql statement by using a parameterized query you get the same security benefits as a stored procedure would give you.</p>

<h4>Different permissions on tables and stored procedures</h4>

<p>This isn&#8217;t such a big problem. I&#8217;ve mostly seen people use one dedicated user to access the database. Lots of times there is a SOA like architecture that allows the client application to not even know what type of database it&#8217;s connecting too.  I haven&#8217;t seen many places yet where they actually implement security that is that strict.
So the reasoning goes if you secure your application properly then this shouldn&#8217;t be a big problem.
Ayende has a more elaborate post on the subject: <a href="http://ayende.com/Blog/archive/2006/04/05/StoredProceduresForSecurity.aspx">Stored Procedures for Security</a></p>

<h3>Maintenance</h3>

<p>This is probably a very ambiguous problem. From a development point of view this might probably be the worst argument in favor for stored procedures. However if you look at it from the POV of the enterprise it might actually hold some value.
At my current client all the applications have to be distributed by a separate team, and that makes the deployment a costly scenario.
That is because once your application goes into production and something small needs to change the deployment team has to go around and deploy that application again on every workstation in the company. I know about click-once but nobody has any rights to install anything on their pc which makes that pretty hard to do.
Now from my POV this is the most invalid argument of all of them because of the maintenance overhead it adds.
When you give stored procs to a developer they see shiny quick shortcuts to quickly get some data out and perhaps already transform some of that data in their query. That is all good the first time you have to deploy the application. But the next person needs to add a column to a table and suddenly he will have to go through all the stored procedures (at least 3 of them for the C,R and D of CRUD) to add the column. Then he has to go in the data layer of your n-tiered application and modify the entity and perhaps the methods that map to the stored procedures.  Then comes time to deploy and you forgot to modify your update script with that one column you added to a stored proc. Of course this stored proc is the one that saves one of the core entities of your application and suddenly the new release is throwing errors all over the place.
I skipped the part of transforming some data. As <a href="http://flanders.co.nz">my previous post</a> suggests: that stuff is business logic and doesn&#8217;t belong in a stored procedure.</p>

<h3>Some more reading on the subject</h3>

<ul>
<li>Jeff Atwood claiming that T-SQL is the assembly language of contemporary development.</li>
</ul>


<p><a href="http://www.codinghorror.com/blog/archives/000117.html">Who Needs Stored Procedures, Anyways?</a>
* Frans Bouma explaining his point of view:</p>

<p><a href="http://weblogs.asp.net/fbouma/archive/2003/11/18/38178.aspx">Stored procedures are bad, m&#8217;kay?</a>
* Jeremy Miller swearing this is really going to be his last post on stored procedures:</p>

<p><a href="http://codebetter.com/blogs/jeremy.miller/archive/2006/05/25/145450.aspx">Why I do not use Stored Procedures</a></p>
</div>
  
  


    </article>
    <!-- divider for blog post -->
    <div class="divider"></div>
  
  
    <article class="blogpost row">
      
  <div class="post-heading"> 
    



    <p class="date">22</p>  
    <div class="month-year"><p><span>Oct</span><br />2008</p></div>



    
      <div class="post-title">
        <h5>
          <a href="/2008/10/22/if-you-ever-wanted-to-play-fur-elise-in-the-console/" title="">If You Ever Wanted to Play Fur Elise in the Console</a>
        </h5>
      </div> 
    
    <div class="clear"></div>
  </div>
  <!-- end of post heading -->
  
  <!-- start of post meta -->
  <div class="post-meta">
    <p>
       
  

<span class="byline author vcard">Posted by <span class="fn">Ivan Porto Carrero</span></span>

       
     </p>  
  </div>
  <!-- end of post meta -->
  


  <div class="entry-content"><p>At work today we were playing around with the console.. here&#8217;s one of our experiments whilst creating a stoplight workflow (WF).</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
<span class='line-number'>24</span>
<span class='line-number'>25</span>
<span class='line-number'>26</span>
<span class='line-number'>27</span>
<span class='line-number'>28</span>
<span class='line-number'>29</span>
<span class='line-number'>30</span>
<span class='line-number'>31</span>
<span class='line-number'>32</span>
<span class='line-number'>33</span>
<span class='line-number'>34</span>
<span class='line-number'>35</span>
<span class='line-number'>36</span>
<span class='line-number'>37</span>
<span class='line-number'>38</span>
</pre></td><td class='code'><pre><code class='csharp'><span class='line'><span class="k">private</span> <span class="k">static</span> <span class="k">void</span> <span class="nf">FurElise</span><span class="p">()</span>
</span><span class='line'><span class="p">{</span>
</span><span class='line'>        <span class="n">Console</span><span class="p">.</span><span class="n">Beep</span><span class="p">(</span><span class="m">420</span><span class="p">,</span> <span class="m">200</span><span class="p">);</span>
</span><span class='line'>        <span class="n">Console</span><span class="p">.</span><span class="n">Beep</span><span class="p">(</span><span class="m">400</span><span class="p">,</span> <span class="m">200</span><span class="p">);</span>
</span><span class='line'>        <span class="n">Console</span><span class="p">.</span><span class="n">Beep</span><span class="p">(</span><span class="m">420</span><span class="p">,</span> <span class="m">200</span><span class="p">);</span>
</span><span class='line'>        <span class="n">Console</span><span class="p">.</span><span class="n">Beep</span><span class="p">(</span><span class="m">400</span><span class="p">,</span> <span class="m">200</span><span class="p">);</span>
</span><span class='line'>        <span class="n">Console</span><span class="p">.</span><span class="n">Beep</span><span class="p">(</span><span class="m">420</span><span class="p">,</span> <span class="m">200</span><span class="p">);</span>
</span><span class='line'>        <span class="n">Console</span><span class="p">.</span><span class="n">Beep</span><span class="p">(</span><span class="m">315</span><span class="p">,</span> <span class="m">200</span><span class="p">);</span>
</span><span class='line'>        <span class="n">Console</span><span class="p">.</span><span class="n">Beep</span><span class="p">(</span><span class="m">370</span><span class="p">,</span> <span class="m">200</span><span class="p">);</span>
</span><span class='line'>        <span class="n">Console</span><span class="p">.</span><span class="n">Beep</span><span class="p">(</span><span class="m">335</span><span class="p">,</span> <span class="m">200</span><span class="p">);</span>
</span><span class='line'>        <span class="n">Console</span><span class="p">.</span><span class="n">Beep</span><span class="p">(</span><span class="m">282</span><span class="p">,</span> <span class="m">600</span><span class="p">);</span>
</span><span class='line'>        <span class="n">Console</span><span class="p">.</span><span class="n">Beep</span><span class="p">(</span><span class="m">180</span><span class="p">,</span> <span class="m">200</span><span class="p">);</span>
</span><span class='line'>        <span class="n">Console</span><span class="p">.</span><span class="n">Beep</span><span class="p">(</span><span class="m">215</span><span class="p">,</span> <span class="m">200</span><span class="p">);</span>
</span><span class='line'>        <span class="n">Console</span><span class="p">.</span><span class="n">Beep</span><span class="p">(</span><span class="m">282</span><span class="p">,</span> <span class="m">200</span><span class="p">);</span>
</span><span class='line'>        <span class="n">Console</span><span class="p">.</span><span class="n">Beep</span><span class="p">(</span><span class="m">315</span><span class="p">,</span> <span class="m">600</span><span class="p">);</span>
</span><span class='line'>        <span class="n">Console</span><span class="p">.</span><span class="n">Beep</span><span class="p">(</span><span class="m">213</span><span class="p">,</span> <span class="m">200</span><span class="p">);</span>
</span><span class='line'>        <span class="n">Console</span><span class="p">.</span><span class="n">Beep</span><span class="p">(</span><span class="m">262</span><span class="p">,</span> <span class="m">200</span><span class="p">);</span>
</span><span class='line'>        <span class="n">Console</span><span class="p">.</span><span class="n">Beep</span><span class="p">(</span><span class="m">315</span><span class="p">,</span> <span class="m">200</span><span class="p">);</span>
</span><span class='line'>        <span class="n">Console</span><span class="p">.</span><span class="n">Beep</span><span class="p">(</span><span class="m">335</span><span class="p">,</span> <span class="m">600</span><span class="p">);</span>
</span><span class='line'>        <span class="n">Console</span><span class="p">.</span><span class="n">Beep</span><span class="p">(</span><span class="m">213</span><span class="p">,</span> <span class="m">200</span><span class="p">);</span>
</span><span class='line'>        <span class="n">Console</span><span class="p">.</span><span class="n">Beep</span><span class="p">(</span><span class="m">420</span><span class="p">,</span> <span class="m">200</span><span class="p">);</span>
</span><span class='line'>        <span class="n">Console</span><span class="p">.</span><span class="n">Beep</span><span class="p">(</span><span class="m">400</span><span class="p">,</span> <span class="m">200</span><span class="p">);</span>
</span><span class='line'>        <span class="n">Console</span><span class="p">.</span><span class="n">Beep</span><span class="p">(</span><span class="m">420</span><span class="p">,</span> <span class="m">200</span><span class="p">);</span>
</span><span class='line'>        <span class="n">Console</span><span class="p">.</span><span class="n">Beep</span><span class="p">(</span><span class="m">400</span><span class="p">,</span> <span class="m">200</span><span class="p">);</span>
</span><span class='line'>        <span class="n">Console</span><span class="p">.</span><span class="n">Beep</span><span class="p">(</span><span class="m">420</span><span class="p">,</span> <span class="m">200</span><span class="p">);</span>
</span><span class='line'>        <span class="n">Console</span><span class="p">.</span><span class="n">Beep</span><span class="p">(</span><span class="m">315</span><span class="p">,</span> <span class="m">200</span><span class="p">);</span>
</span><span class='line'>        <span class="n">Console</span><span class="p">.</span><span class="n">Beep</span><span class="p">(</span><span class="m">370</span><span class="p">,</span> <span class="m">200</span><span class="p">);</span>
</span><span class='line'>        <span class="n">Console</span><span class="p">.</span><span class="n">Beep</span><span class="p">(</span><span class="m">335</span><span class="p">,</span> <span class="m">200</span><span class="p">);</span>
</span><span class='line'>        <span class="n">Console</span><span class="p">.</span><span class="n">Beep</span><span class="p">(</span><span class="m">282</span><span class="p">,</span> <span class="m">600</span><span class="p">);</span>
</span><span class='line'>        <span class="n">Console</span><span class="p">.</span><span class="n">Beep</span><span class="p">(</span><span class="m">180</span><span class="p">,</span> <span class="m">200</span><span class="p">);</span>
</span><span class='line'>        <span class="n">Console</span><span class="p">.</span><span class="n">Beep</span><span class="p">(</span><span class="m">215</span><span class="p">,</span> <span class="m">200</span><span class="p">);</span>
</span><span class='line'>        <span class="n">Console</span><span class="p">.</span><span class="n">Beep</span><span class="p">(</span><span class="m">282</span><span class="p">,</span> <span class="m">200</span><span class="p">);</span>
</span><span class='line'>        <span class="n">Console</span><span class="p">.</span><span class="n">Beep</span><span class="p">(</span><span class="m">315</span><span class="p">,</span> <span class="m">600</span><span class="p">);</span>
</span><span class='line'>        <span class="n">Console</span><span class="p">.</span><span class="n">Beep</span><span class="p">(</span><span class="m">213</span><span class="p">,</span> <span class="m">200</span><span class="p">);</span>
</span><span class='line'>        <span class="n">Console</span><span class="p">.</span><span class="n">Beep</span><span class="p">(</span><span class="m">330</span><span class="p">,</span> <span class="m">200</span><span class="p">);</span>
</span><span class='line'>        <span class="n">Console</span><span class="p">.</span><span class="n">Beep</span><span class="p">(</span><span class="m">315</span><span class="p">,</span> <span class="m">200</span><span class="p">);</span>
</span><span class='line'>        <span class="n">Console</span><span class="p">.</span><span class="n">Beep</span><span class="p">(</span><span class="m">282</span><span class="p">,</span> <span class="m">600</span><span class="p">);</span>
</span><span class='line'><span class="p">}</span>
</span></code></pre></td></tr></table></div></figure>



</div>
  
  


    </article>
    <!-- divider for blog post -->
    <div class="divider"></div>
  
  
    <article class="blogpost row">
      
  <div class="post-heading"> 
    



    <p class="date">01</p>  
    <div class="month-year"><p><span>Oct</span><br />2008</p></div>



    
      <div class="post-title">
        <h5>
          <a href="/2008/10/01/common-mistakes-in-software-development-part-2-mixing-up-the-tiers/" title="">Common Mistakes in Software Development (Part 2): Mixing Up the Layers</a>
        </h5>
      </div> 
    
    <div class="clear"></div>
  </div>
  <!-- end of post heading -->
  
  <!-- start of post meta -->
  <div class="post-meta">
    <p>
       
  

<span class="byline author vcard">Posted by <span class="fn">Ivan Porto Carrero</span></span>

       
     </p>  
  </div>
  <!-- end of post meta -->
  


  <div class="entry-content"><p>In my <a href="http://flanders.co.nz/2008/09/24/common-mistakes-in-software-development/">previous post</a> I explained some very quick wins to make your code a little bit cleaner. As I&#8217;ve been appointed an <a href="http://www.asp.net">asp.net</a> project at work at the moment I have the chance to get more ammunition for blogging :).
This time I&#8217;d like to talk about properly separating your tiers so that the next person doesn&#8217;t have to go through the complete application and make changes everywhere just to make a minor change to the application.</p>

<p>One  of the problems; one of the most time consuming that is; I&#8217;ve seen is that people are confused on what they have to put in the data logic layer and what is business logic. In my case this is fairly extreme because there isn&#8217;t an ORM tool but rather every entity gets populated by calling a stored procedure and then in the code the graph objects get set. Whether this is a good approach for fetching your data or not is not within the scope of this blog post, but I&#8217;m guessing there are more people who are facing this type of situation.</p>

<p>Anyway let&#8217;s start with the beginning and explain the typical <a href="http://en.wikipedia.org/wiki/N-tier">n-tier architecture</a> people seem to follow. This is not a particular pattern like <a href="http://en.wikipedia.org/wiki/Model-view-controller">MVC</a> or <a href="http://en.wikipedia.org/wiki/Model-view-presenter">MVP</a> that people are talking about so much lately. This goes back to the guidance that can be found on the <a href="http://msdn.microsoft.com">msdn website</a>.  This type of architecture is often used in combination with data sets but not in my example for this post. This architecture is generally divided in 3 parts that can, but don&#8217;t have to, run on different machines if needs be.  When talking about this type of architecture people mostly talk about an n-tier application.</p>

<h2>The first part is the data layer.</h2>

<p>The golden rule for this one: this is the gateway between the rest of your application and the database. <strong>NONE</strong> of the other layers should be talking directly to the database but instead should be doing their talking through this layer.  That means if you have stored procedures you provide wrappers for them in this layer. You populate your entities in this layer too.
Other functions you can perform in this layer is setting the graph members (populating relationships). IMHO if you&#8217;re talking to the database (open/close connection) you&#8217;re doing stuff that belongs in the data layer which includes populating relationships.</p>

<p>Encapsulating this logic in it&#8217;s own layer, which could potentially be walled off through only exposing it with remoting or WCF, allows you to reuse the code in different places of your applications or sharing this data access assembly with multiple applications.</p>

<h2>The second part is the business logic layer.</h2>

<p>This layer encapsulates all the operations you do on entities to express the business rules. That means you would probably do most of your work in this layer. Basically <strong>all</strong> of the programming you will be doing for the business rules should be done here. Business logic doesn&#8217;t live in stored procedures, it doesn&#8217;t live in the UI or the data layer. Nope this layer is where it lives and nowhere else.  This statement may raise some eyebrows but only and only when you find that a certain routine is a bottleneck and it is really data intensive you can put it in a stored procedure but more on that subject in another blog post.
If you find yourself transforming data so you can display it in your GUI then you&#8217;re probably expressing business rules that aren&#8217;t explicitly stated as a business rule.
When you find yourself to be concatenating strings or writing logic to translate your pages in your GUI layer then you&#8217;re probably expressing business logic (business logic doesn&#8217;t have to come from business ;) in case that wasn&#8217;t clear).
Another common find in business logic is validation for example because this generally expresses some kind of strict rule that comes from the business domain your application deals with. Validation is a tricky one but the rule is you should do <strong>all</strong> validation in your business logic. To provide a better user experience you can maybe reuse that validation on the client side. In the case of web development you probably will have to duplicate that validation in javascript if you really need it.</p>

<p>Separating these rules into their own layer allows you to reuse the methods and classes you create in the business logic layer, in different parts of your UI or even reuse it in different applications.
By separating this logic it should be easier for you to do some automated testing like unit testing and/or integration testing of that code.</p>

<h2>The third and last layer</h2>

<p>This is typically the UI layer but you could easily use web/WCF services as an interface to your logic. The UI doesn&#8217;t have to be a GUI it can also be a CLI (Command-Line Interface) or something. But that is how you interact with the user or external application. The idea is that in this layer you have virtually no logic except for what&#8217;s on the screen <strong>everything</strong> else should be handled by your business logic. To clarify this statement: you can show/hide UI elements or add/remove elements to the UI and respond to events triggered by user actions but the data of that response and the processing really belongs in the business logic layer.</p>

<p>The UI layer can talk to both the business logic and data logic layers. If for example you&#8217;re getting a category list with just an id and name from the database chances are you won&#8217;t need to transform that data so your UI can bind directly to the entities returned by your data layer. But more complex items like an invoice for example will probably need some processing and then it should probably pass through the business logic layer.</p>

<p>This is typically a somewhat harder part of your application to provide tests for although there are some libraries out there that make it easier but still there are easier parts to test in your application.</p>

<p>So that was a quick refresher on what the classic n-tier architecture is about an how it should be structured. I hope you will agree with me into stating that its not that hard and pretty straight-forward to implement, but what I find in the &#8220;enterprise&#8221; is far from the points mentioned above.
It is a bloody mix of everything everywhere, leaving me thinking -come on guys it&#8217;s not that hard-:
<em>talking to the database => datalayer</em>
<em>showing windows/adding UI elements,&#8230; => UI layer</em>
<em>everything else => business logic</em></p>

<p>Failing to abide by the previous simple rules will result in hell freezing over, entire plagues will be released upon the world; to cut a long story short: the world as you know it will seize to exist and turn into complete chaos.
Following the rules should result in less code duplication, an instantaneously easier to maintain codebase and probably more happy successors for when you move on to the next project.  It should also give you a higher degree of code reuse.
If there is one thing you should take away from this article then it should be:
<strong>Don&#8217;t mix your tiers</strong></p>

<p>Of course there are a couple of situations when you can diverge from the ideas presented in this post but you should always be able to justify why you break the rule. So you need a good reason to break the proposed architecture and that would probably also warrant a comment so the next guy also knows what&#8217;s going on.
The most important part is to separate all non-UI logic out from the UI layer and put it in one of the lower layers.</p>

<p>Thanks for reading
Ivan - writing for more maintainable software -</p>
</div>
  
  


    </article>
    <!-- divider for blog post -->
    <div class="divider"></div>
  
  
    <article class="blogpost row">
      
  <div class="post-heading"> 
    



    <p class="date">24</p>  
    <div class="month-year"><p><span>Sep</span><br />2008</p></div>



    
      <div class="post-title">
        <h5>
          <a href="/2008/09/24/common-mistakes-in-software-development/" title="">Common Mistakes in Software Development</a>
        </h5>
      </div> 
    
    <div class="clear"></div>
  </div>
  <!-- end of post heading -->
  
  <!-- start of post meta -->
  <div class="post-meta">
    <p>
       
  

<span class="byline author vcard">Posted by <span class="fn">Ivan Porto Carrero</span></span>

       
     </p>  
  </div>
  <!-- end of post meta -->
  


  <div class="entry-content"><p><strong><strong><em> Rant Alert </em></strong></strong></p>

<p><rant></p>

<p>At my current client I&#8217;ve got to do mainly maintenance on existing applications. This gives me the chance to look into codebases that have been created by other people and that don&#8217;t really reflect how I would write things. That is all good though it gives me a chance to learn new ways of doing things and when I think their way is better I&#8217;ll surely adopt.</p>

<p>Anyway when I&#8217;m browsing these codebases I do find a lot of things that could have been done better or more correctly and that&#8217;s what I&#8217;ll be writing about a little today.</p>

<p>The first one is returning bools:</p>

<p>I&#8217;ve found this in just about every project I&#8217;ve been in:</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
</pre></td><td class='code'><pre><code class='csharp'><span class='line'><span class="k">public</span> <span class="kt">bool</span> <span class="nf">IsNull</span><span class="p">(){</span>
</span><span class='line'>  <span class="k">if</span><span class="p">(</span><span class="n">obj</span> <span class="p">==</span> <span class="k">null</span><span class="p">)</span>
</span><span class='line'>    <span class="k">return</span> <span class="k">true</span><span class="p">;</span>
</span><span class='line'>  <span class="k">else</span>
</span><span class='line'>    <span class="k">return</span> <span class="k">false</span><span class="p">;</span>
</span><span class='line'><span class="p">}</span>
</span></code></pre></td></tr></table></div></figure>


<p>The snippet above is a very long winded way of writing. IMHO this hurts readability and you&#8217;re saying the same thing twice. obj == null already returns a bool it makes no sense writing it again.</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class='csharp'><span class='line'><span class="k">public</span> <span class="kt">bool</span> <span class="nf">IsNull</span><span class="p">()</span> <span class="p">{</span> <span class="k">return</span> <span class="n">obj</span> <span class="p">==</span> <span class="k">null</span><span class="p">;</span> <span class="p">}</span>
</span></code></pre></td></tr></table></div></figure>


<p>Another thing I keep seeing is very liberal use of try..catch blocks that catch all exceptions. Admittedly try..catch is cool but it should be used at times you are actually interested in the exception that is thrown. But it shouldn&#8217;t be used as a safeguard to swallow exceptions you don&#8217;t want to fix at this moment.  I keep seeing this code in projects:</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
</pre></td><td class='code'><pre><code class='csharp'><span class='line'><span class="k">try</span><span class="p">{</span>
</span><span class='line'>    <span class="n">myBLObject</span><span class="p">.</span><span class="n">FindSomething</span><span class="p">(</span><span class="n">someId</span><span class="p">).</span><span class="n">SomeMethod</span><span class="p">();</span>
</span><span class='line'><span class="p">}</span>
</span><span class='line'><span class="k">catch</span><span class="p">(</span><span class="n">Exception</span><span class="p">){</span>
</span><span class='line'>    <span class="c1">// Nothing to be done but error stops</span>
</span><span class='line'><span class="p">}</span>
</span></code></pre></td></tr></table></div></figure>


<p>Now that can be easily written so that it won&#8217;t throw an exeption and then the try catch isn&#8217;t necessary anymore at all. Try..catch blocks most certainly have their use but throwing and catching exceptions definitely hurts performance because the system has to generate a complete stack trace etc. for every exception that is being thrown.</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
</pre></td><td class='code'><pre><code class='csharp'><span class='line'><span class="kt">var</span> <span class="n">result</span> <span class="p">=</span> <span class="n">myBLObject</span><span class="p">.</span><span class="n">FindSomething</span><span class="p">(</span><span class="n">someId</span><span class="p">);</span>
</span><span class='line'><span class="k">if</span><span class="p">(</span><span class="n">result</span> <span class="p">!=</span> <span class="k">null</span><span class="p">)</span> <span class="n">result</span><span class="p">.</span><span class="n">SomeMethod</span><span class="p">();</span>
</span></code></pre></td></tr></table></div></figure>


<p>The code becomes a lot more readable, not to mention faster. I&#8217;ve seen this being used in OnRowDataBound events etc on grids with 500+ rows, removing the try catch blocks more than doubles the speed of that page.</p>

<p>The next one on the list is using if,else and switch statements. They are sometimes a cause of code bloat. To put it in the words of <a href="http://www.hanselman.com/blog/BackToBasicsLifeAfterIfForAndSwitchLikeADataStructuresReminder.aspx">Scott Hanselman</a>:</p>

<blockquote><p>I think that using only <em>if</em>, <em>for </em>and <em>switch </em>is the Computer Programmer equivalent of using &#8220;like&#8221; in every sentence.</p></blockquote>

<p>Scott does a great job explaining why they can be pretty evil so I&#8217;ll just leave you with a <a href="http://www.hanselman.com/blog/BackToBasicsLifeAfterIfForAndSwitchLikeADataStructuresReminder.aspx">link</a> to his post</p>

<p>I have another couple of posts in the making on this subject but I had to get this out of my system. These are also very quick wins the other things I&#8217;m going to talk about are application architecture and stored procs&#8230;.
</rant></p>
</div>
  
  


    </article>
    <!-- divider for blog post -->
    <div class="divider"></div>
  
  <div class="pagination">
    
      <a class="prev" href="/page/4/">&larr; Older</a>
    
    <a href="/blog/archives">Blog Archives</a>
    
    <a class="next" href="/page/2/">Newer &rarr;</a>
    
  </div>
</div>
</div>


      </div>
    </div>
    <footer role="contentinfo"><!-- start of footer container -->
  <div class="container">
    <!-- start of row - 4 widget columns -->
      <div class="row clearfix">
      <div class="twelve columns">
        <div class="logo">
          <img src="/images/logo.png" alt="" />
          <h2>Rants &amp; ramblings</h2>
        </div>
      </div>

      <div class="four columns">        
        <h6>Social networks</h6>
        <ul class="social_network">
          <li class="rollover"><a href="http://facebook.com/ivanportocarrero" class="yellowtip" title="Facebook"><span class="fb-rollover"></span><img src="/images/social/fb.png" alt="" /></a></li>
          <li class="rollover"><a href="http://twitter.com/casualjim" class="yellowtip" title="Follow me"><span class="twitter-rollover"></span><img src="/images/social/twitter.png" alt="" /></a></li>
          <li class="rollover"><a href="https://plus.google.com/u/1/106536131996809745163/posts" class="yellowtip" title="Google plus"><span class="google-rollover"></span><img src="/images/social/google-plus.png" alt="" /></a></li>
        </ul>       
      </div>
    </div>
    <!-- end of row -->
  
    <!-- start of row - 4 widget columns -->
      <div class="row clearfix">
      <div class="eight columns">
        <h6>About me</h6>
        <p>
        Welcome to my blog. This is a collection of random thoughts and rants.
        </p>
        <p>
        Allow me to introduce myself. My name is Ivan Porto Carrero and I'm an enthusiastic developer on  Scala, .NET and Ruby.<br />Through this blog I hope I can share some of that passion and maybe help somebody out when they are looking on how to do something.
        </p>
      </div>
      <div class="four columns">
        <h6>Latest posts</h6>
        <ul class="square">
        
          <li>
            <a href="/2011/08/01/backchat-developers/">work for backchat</a>
          </li>
        
          <li>
            <a href="/2010/09/30/radical-language-and-platform-shift/">Radical language and platform shift</a>
          </li>
        
          <li>
            <a href="/2010/03/12/video-of-fosdem-ironruby-presentation/">Video of FOSDEM IronRuby presentation</a>
          </li>
        
          <li>
            <a href="/2009/12/01/adding-a-console-to-your-ironruby-application/">Adding a console to your IronRuby application</a>
          </li>
        
          <li>
            <a href="/2009/11/08/a-good-url-regular-expression-repost/">A good url regular expression? (repost)</a>
          </li>
        
        </ul> 
      </div>
      <div class="four columns">
        <h6>Browse pages</h6>
        <ul class="square">
          <li><a href="/">Home</a></li>
          <li><a href="/archives">Archives</a></li>
          <li><a href="/projects">My projects</a></li>
        </ul> 
      </div>
    </div>
    <!-- end of row -->
    

    <!-- start of footer divider -->
    <div class="sixteen columns">
      <div class="footer-divider row"></div>
    </div>  
    <!-- end of footer divider -->
    
    <!-- start of bottoms -->
    <div class="clearfix footnote">
      <div class="eight columns">
        <p class="copyright">Copyright &copy; 2012 - Ivan Porto Carrero - All Right Reserved</p>
      </div>
      <div class="eight columns">
        <p class="align-right"><span class="credit">Powered by <a href="http://octopress.org">Octopress</a>, designed by <a href="http://iweb-studio.com" target="_blank">iwebstudio</a></p>
      </div>
    </div>
    <!-- end of bottoms -->

  </div>
  <!-- end of footer container -->

</footer>
  </div>
  

<script type="text/javascript">
      var disqus_shortname = 'casualjim';
      
        
        var disqus_script = 'count.js';
      
    (function () {
      var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
      dsq.src = 'http://' + disqus_shortname + '.disqus.com/' + disqus_script;
      (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
    }());
</script>



<div id="fb-root"></div>
<script>(function(d, s, id) {
  var js, fjs = d.getElementsByTagName(s)[0];
  if (d.getElementById(id)) {return;}
  js = d.createElement(s); js.id = id;
  js.src = "//connect.facebook.net/en_US/all.js#appId=212934732101925&xfbml=1";
  fjs.parentNode.insertBefore(js, fjs);
}(document, 'script', 'facebook-jssdk'));</script>



  <script type="text/javascript">
    (function() {
      var script = document.createElement('script'); script.type = 'text/javascript'; script.async = true;
      script.src = 'https://apis.google.com/js/plusone.js';
      var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(script, s);
    })();
  </script>



  <script type="text/javascript">
    (function(){
      var twitterWidgets = document.createElement('script');
      twitterWidgets.type = 'text/javascript';
      twitterWidgets.async = true;
      twitterWidgets.src = 'http://platform.twitter.com/widgets.js';
      document.getElementsByTagName('head')[0].appendChild(twitterWidgets);
    })();
  </script>



<p id="back-top">
  <a href="#top"><span></span>To top</a>
</p>

</body>
</html>
